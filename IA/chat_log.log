2025-08-08 18:13:02,077 [INFO] [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8080
 * Running on http://172.18.0.3:8080
2025-08-08 18:13:02,077 [INFO] [33mPress CTRL+C to quit[0m
2025-08-08 18:13:02,078 [INFO]  * Restarting with stat
2025-08-08 18:13:02,703 [WARNING]  * Debugger is active!
2025-08-08 18:13:02,704 [INFO]  * Debugger PIN: 935-085-737
2025-08-08 18:13:14,013 [INFO] 172.18.0.1 - - [08/Aug/2025 18:13:14] "POST /webhook HTTP/1.1" 200 -
2025-08-08 18:13:14,014 [INFO] Nenhum arquivo de sess√£o encontrado. Iniciando uma nova.
2025-08-08 18:13:14,039 [INFO] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 404 Not Found"
2025-08-08 18:13:14,045 [INFO] INTEN√á√ÉO PROCESSADA: {'tool_name': 'error', 'parameters': {'detail': 'model "llama3" not found, try pulling it first (status code: 404)'}}
2025-08-08 18:13:14,048 [WARNING] Fallback Final: Ferramenta desconhecida 'error'
2025-08-08 18:13:14,049 [INFO] Salvando sess√£o: {'customer_context': None, 'shopping_cart': [], 'last_search_type': None, 'last_search_params': {}, 'current_offset': 0, 'last_shown_products': [], 'last_bot_action': None, 'pending_action': 'show_top_selling', 'last_kb_search_term': None}
2025-08-08 18:13:14,059 [INFO] Enviando mensagem proativa para whatsapp:+5511951765957: 'ü§ñ Hum, n√£o entendi muito bem. Que tal come√ßarmos pelos produtos mais vendidos? Posso te mostrar?'
2025-08-08 18:13:14,085 [INFO] -- BEGIN Twilio API Request --
2025-08-08 18:13:14,086 [INFO] POST Request: https://api.twilio.com/2010-04-01/Accounts/ACd2a6cd60871d661c034ecb40ddbd51e7/Messages.json
2025-08-08 18:13:14,086 [INFO] Headers:
2025-08-08 18:13:14,086 [INFO] Content-Type : application/x-www-form-urlencoded
2025-08-08 18:13:14,087 [INFO] Accept : application/json
2025-08-08 18:13:14,087 [INFO] User-Agent : twilio-python/9.7.0 (Linux x86_64) Python/3.9.23
2025-08-08 18:13:14,087 [INFO] X-Twilio-Client : python-9.7.0
2025-08-08 18:13:14,087 [INFO] Accept-Charset : utf-8
2025-08-08 18:13:14,087 [INFO] -- END Twilio API Request --
2025-08-08 18:13:15,111 [INFO] Response Status Code: 201
2025-08-08 18:13:15,112 [INFO] Response Headers: {'Content-Type': 'application/json;charset=utf-8', 'Content-Length': '900', 'Connection': 'keep-alive', 'Date': 'Fri, 08 Aug 2025 18:13:14 GMT', 'Twilio-Concurrent-Requests': '1', 'Twilio-Request-Id': 'RQe8eb5beb286e778c39a6c13c588ec77e', 'Twilio-Request-Duration': '0.116', 'X-Home-Region': 'us1', 'X-API-Domain': 'api.twilio.com', 'Strict-Transport-Security': 'max-age=31536000', 'X-Cache': 'Miss from cloudfront', 'Via': '1.1 f5002d75963a7ac4e40089e827005b00.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'GRU3-P4', 'X-Amz-Cf-Id': 'qAZNhyJPHyF9Wi_1PGk4_5GP2rRi-uyxfdqQgXNy8vTz0lnc-wrxVw==', 'X-Powered-By': 'AT-5000', 'X-Shenanigans': 'none', 'Vary': 'Origin'}
2025-08-08 18:13:15,112 [INFO] THREAD: Processamento finalizado para 'Oi'
2025-08-08 18:15:31,134 [INFO] [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8080
 * Running on http://172.18.0.3:8080
2025-08-08 18:15:31,134 [INFO] [33mPress CTRL+C to quit[0m
2025-08-08 18:15:31,135 [INFO]  * Restarting with stat
2025-08-08 18:15:31,836 [WARNING]  * Debugger is active!
2025-08-08 18:15:31,836 [INFO]  * Debugger PIN: 878-148-492
2025-08-08 18:15:40,504 [INFO] 172.18.0.1 - - [08/Aug/2025 18:15:40] "POST /webhook HTTP/1.1" 200 -
2025-08-08 18:15:40,505 [INFO] Arquivo de sess√£o encontrado. Carregando.
2025-08-08 18:15:40,528 [INFO] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 404 Not Found"
2025-08-08 18:15:40,528 [INFO] INTEN√á√ÉO PROCESSADA: {'tool_name': 'error', 'parameters': {'detail': 'model "llama3" not found, try pulling it first (status code: 404)'}}
2025-08-08 18:15:40,528 [WARNING] Fallback Final: Ferramenta desconhecida 'error'
2025-08-08 18:15:40,529 [INFO] Salvando sess√£o: {'customer_context': None, 'shopping_cart': [], 'last_search_type': None, 'last_search_params': {}, 'current_offset': 0, 'last_shown_products': [], 'last_bot_action': None, 'pending_action': 'show_top_selling', 'last_kb_search_term': None}
2025-08-08 18:15:40,533 [INFO] Enviando mensagem proativa para whatsapp:+5511951765957: 'ü§ñ Hum, n√£o entendi muito bem. Que tal come√ßarmos pelos produtos mais vendidos? Posso te mostrar?'
2025-08-08 18:15:40,556 [INFO] -- BEGIN Twilio API Request --
2025-08-08 18:15:40,557 [INFO] POST Request: https://api.twilio.com/2010-04-01/Accounts/ACd2a6cd60871d661c034ecb40ddbd51e7/Messages.json
2025-08-08 18:15:40,557 [INFO] Headers:
2025-08-08 18:15:40,557 [INFO] Content-Type : application/x-www-form-urlencoded
2025-08-08 18:15:40,557 [INFO] Accept : application/json
2025-08-08 18:15:40,558 [INFO] User-Agent : twilio-python/9.7.0 (Linux x86_64) Python/3.9.23
2025-08-08 18:15:40,558 [INFO] X-Twilio-Client : python-9.7.0
2025-08-08 18:15:40,558 [INFO] Accept-Charset : utf-8
2025-08-08 18:15:40,558 [INFO] -- END Twilio API Request --
2025-08-08 18:15:41,403 [INFO] Response Status Code: 429
2025-08-08 18:15:41,403 [INFO] Response Headers: {'Content-Type': 'application/json', 'Content-Length': '173', 'Connection': 'keep-alive', 'Date': 'Fri, 08 Aug 2025 18:15:41 GMT', 'X-Twilio-Error-Code': '63038', 'Twilio-Concurrent-Requests': '1', 'Twilio-Request-Id': 'RQ813f3e0634d9d558df01d5c4f21258b1', 'Twilio-Request-Duration': '0.047', 'X-Home-Region': 'us1', 'X-API-Domain': 'api.twilio.com', 'Strict-Transport-Security': 'max-age=31536000', 'X-Cache': 'Error from cloudfront', 'Via': '1.1 6f2f291762a32a9876c9d69d778cb280.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'GRU3-P4', 'X-Amz-Cf-Id': 'KsStXuEXwAL2OliJr5mLfB79FkrkKUiPeVcsqXoV7qHVNSptXkrhgw==', 'X-Powered-By': 'AT-5000', 'X-Shenanigans': 'none', 'Vary': 'Origin'}
2025-08-08 18:15:41,404 [ERROR] Falha ao enviar mensagem via API da Twilio: HTTP 429 error: Unable to create record: Account ACd2a6cd60871d661c034ecb40ddbd51e7 exceeded the 9 daily messages limit
2025-08-08 18:15:41,404 [INFO] THREAD: Processamento finalizado para 'Oi'
2025-08-08 18:16:43,605 [INFO] 172.18.0.1 - - [08/Aug/2025 18:16:43] "POST /webhook HTTP/1.1" 200 -
2025-08-08 18:16:43,607 [INFO] Arquivo de sess√£o encontrado. Carregando.
2025-08-08 18:16:43,634 [INFO] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 404 Not Found"
2025-08-08 18:16:43,635 [INFO] INTEN√á√ÉO PROCESSADA: {'tool_name': 'error', 'parameters': {'detail': 'model "llama3" not found, try pulling it first (status code: 404)'}}
2025-08-08 18:16:43,635 [WARNING] Fallback Final: Ferramenta desconhecida 'error'
2025-08-08 18:16:43,635 [INFO] Salvando sess√£o: {'customer_context': None, 'shopping_cart': [], 'last_search_type': None, 'last_search_params': {}, 'current_offset': 0, 'last_shown_products': [], 'last_bot_action': None, 'pending_action': 'show_top_selling', 'last_kb_search_term': None}
2025-08-08 18:16:43,637 [INFO] Enviando mensagem proativa para whatsapp:+5511940726493: 'ü§ñ Hum, n√£o entendi muito bem. Que tal come√ßarmos pelos produtos mais vendidos? Posso te mostrar?'
2025-08-08 18:16:43,638 [INFO] -- BEGIN Twilio API Request --
2025-08-08 18:16:43,638 [INFO] POST Request: https://api.twilio.com/2010-04-01/Accounts/ACd2a6cd60871d661c034ecb40ddbd51e7/Messages.json
2025-08-08 18:16:43,638 [INFO] Headers:
2025-08-08 18:16:43,639 [INFO] Content-Type : application/x-www-form-urlencoded
2025-08-08 18:16:43,639 [INFO] Accept : application/json
2025-08-08 18:16:43,639 [INFO] User-Agent : twilio-python/9.7.0 (Linux x86_64) Python/3.9.23
2025-08-08 18:16:43,639 [INFO] X-Twilio-Client : python-9.7.0
2025-08-08 18:16:43,639 [INFO] Accept-Charset : utf-8
2025-08-08 18:16:43,639 [INFO] -- END Twilio API Request --
2025-08-08 18:16:44,108 [INFO] Response Status Code: 201
2025-08-08 18:16:44,108 [INFO] Response Headers: {'Content-Type': 'application/json;charset=utf-8', 'Content-Length': '900', 'Connection': 'keep-alive', 'Date': 'Fri, 08 Aug 2025 18:16:43 GMT', 'Twilio-Concurrent-Requests': '1', 'Twilio-Request-Id': 'RQb37cf1b5d558d2560f55b725208159d2', 'Twilio-Request-Duration': '0.115', 'X-Home-Region': 'us1', 'X-API-Domain': 'api.twilio.com', 'Strict-Transport-Security': 'max-age=31536000', 'X-Cache': 'Miss from cloudfront', 'Via': '1.1 6f2f291762a32a9876c9d69d778cb280.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'GRU3-P4', 'X-Amz-Cf-Id': 'FahdfC7wTmQ3qnbzGsWZG3aPMU5Tzp1njvlnR2wONOL_Bh0bLWs2Bw==', 'X-Powered-By': 'AT-5000', 'X-Shenanigans': 'none', 'Vary': 'Origin'}
2025-08-08 18:16:44,109 [INFO] THREAD: Processamento finalizado para 'Oi'
2025-08-08 18:21:30,993 [INFO]  * Detected change in '/app/ai_llm/llm_interface.py', reloading
2025-08-08 18:21:31,042 [INFO]  * Restarting with stat
2025-08-08 18:21:31,752 [WARNING]  * Debugger is active!
2025-08-08 18:21:31,753 [INFO]  * Debugger PIN: 878-148-492
2025-08-08 18:21:56,675 [INFO] [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8080
 * Running on http://172.18.0.3:8080
2025-08-08 18:21:56,675 [INFO] [33mPress CTRL+C to quit[0m
2025-08-08 18:21:56,676 [INFO]  * Restarting with stat
2025-08-08 18:21:57,331 [WARNING]  * Debugger is active!
2025-08-08 18:21:57,332 [INFO]  * Debugger PIN: 112-391-589
2025-08-08 18:22:02,275 [INFO] 172.18.0.1 - - [08/Aug/2025 18:22:02] "POST /webhook HTTP/1.1" 200 -
2025-08-08 18:22:02,277 [INFO] Arquivo de sess√£o encontrado. Carregando.
2025-08-08 18:22:02,282 [INFO] [llm_interface.py] Iniciando get_intent para mensagem: 'Oi...'
2025-08-08 18:22:02,282 [INFO] [llm_interface.py] Tentando carregar prompt de: ai_llm/gav_prompt.txt
2025-08-08 18:22:02,284 [INFO] [llm_interface.py] Prompt carregado com sucesso. Tamanho: 2523 caracteres
2025-08-08 18:22:02,284 [INFO] [llm_interface.py] System prompt preparado. Tamanho: 2455 caracteres
2025-08-08 18:22:02,284 [INFO] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-08 18:22:02,297 [INFO] [llm_interface.py] Verificando disponibilidade do modelo: llama3
2025-08-08 18:22:02,325 [INFO] HTTP Request: GET http://host.docker.internal:11434/api/tags "HTTP/1.1 200 OK"
2025-08-08 18:22:02,326 [WARNING] [llm_interface.py] N√£o foi poss√≠vel verificar modelos dispon√≠veis: 'name'
2025-08-08 18:22:02,326 [INFO] [llm_interface.py] Enviando requisi√ß√£o para o modelo llama3
2025-08-08 18:22:02,328 [INFO] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 404 Not Found"
2025-08-08 18:22:02,329 [ERROR] [llm_interface.py] Erro ao comunicar com o LLM: model "llama3" not found, try pulling it first (status code: 404)
2025-08-08 18:22:02,329 [INFO] INTEN√á√ÉO PROCESSADA: {'tool_name': 'error', 'parameters': {'detail': 'Failed to connect to Ollama. Please check that Ollama is downloaded, running and accessible. model "llama3" not found, try pulling it first (status code: 404)'}}
2025-08-08 18:22:02,329 [WARNING] Fallback Final: Ferramenta desconhecida 'error'
2025-08-08 18:22:02,330 [INFO] Salvando sess√£o: {'customer_context': None, 'shopping_cart': [], 'last_search_type': None, 'last_search_params': {}, 'current_offset': 0, 'last_shown_products': [], 'last_bot_action': None, 'pending_action': 'show_top_selling', 'last_kb_search_term': None}
2025-08-08 18:22:02,332 [INFO] Enviando mensagem proativa para whatsapp:+5511940726493: 'ü§ñ Hum, n√£o entendi muito bem. Que tal come√ßarmos pelos produtos mais vendidos? Posso te mostrar?'
2025-08-08 18:22:02,355 [INFO] -- BEGIN Twilio API Request --
2025-08-08 18:22:02,356 [INFO] POST Request: https://api.twilio.com/2010-04-01/Accounts/ACd2a6cd60871d661c034ecb40ddbd51e7/Messages.json
2025-08-08 18:22:02,356 [INFO] Headers:
2025-08-08 18:22:02,356 [INFO] Content-Type : application/x-www-form-urlencoded
2025-08-08 18:22:02,356 [INFO] Accept : application/json
2025-08-08 18:22:02,357 [INFO] User-Agent : twilio-python/9.7.0 (Linux x86_64) Python/3.9.23
2025-08-08 18:22:02,357 [INFO] X-Twilio-Client : python-9.7.0
2025-08-08 18:22:02,357 [INFO] Accept-Charset : utf-8
2025-08-08 18:22:02,357 [INFO] -- END Twilio API Request --
2025-08-08 18:22:03,110 [INFO] Response Status Code: 201
2025-08-08 18:22:03,110 [INFO] Response Headers: {'Content-Type': 'application/json;charset=utf-8', 'Content-Length': '900', 'Connection': 'keep-alive', 'Date': 'Fri, 08 Aug 2025 18:22:03 GMT', 'Twilio-Concurrent-Requests': '1', 'Twilio-Request-Id': 'RQ03e7cd73a5a4e8019c6c3febd41a3012', 'Twilio-Request-Duration': '0.113', 'X-Home-Region': 'us1', 'X-API-Domain': 'api.twilio.com', 'Strict-Transport-Security': 'max-age=31536000', 'X-Cache': 'Miss from cloudfront', 'Via': '1.1 b0c4c3183ea0dd9a0f495a148c420656.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'GRU3-P4', 'X-Amz-Cf-Id': 'MDXsuelpxGZC-b4dc8YE_uTMbHuy9LJfwXK0WLfbVviwe5VDbmXDuw==', 'X-Powered-By': 'AT-5000', 'X-Shenanigans': 'none', 'Vary': 'Origin'}
2025-08-08 18:22:03,111 [INFO] THREAD: Processamento finalizado para 'Oi'
2025-08-08 18:22:12,409 [INFO] 172.18.0.1 - - [08/Aug/2025 18:22:12] "POST /webhook HTTP/1.1" 200 -
2025-08-08 18:22:12,410 [INFO] Arquivo de sess√£o encontrado. Carregando.
2025-08-08 18:22:12,414 [INFO] INTEN√á√ÉO PROCESSADA: {'tool_name': 'get_top_selling_products', 'parameters': {}}
2025-08-08 18:22:12,434 [INFO] Salvando sess√£o: {'customer_context': None, 'shopping_cart': [], 'last_search_type': 'top_selling', 'last_search_params': {}, 'current_offset': 5, 'last_shown_products': [], 'last_bot_action': 'AWAITING_PRODUCT_SELECTION', 'pending_action': None, 'last_kb_search_term': None}
2025-08-08 18:22:12,436 [INFO] Enviando mensagem proativa para whatsapp:+5511940726493: 'ü§ñ Estes s√£o nossos produtos mais populares:
Nenhum produto encontrado com esse crit√©rio.'
2025-08-08 18:22:12,437 [INFO] -- BEGIN Twilio API Request --
2025-08-08 18:22:12,437 [INFO] POST Request: https://api.twilio.com/2010-04-01/Accounts/ACd2a6cd60871d661c034ecb40ddbd51e7/Messages.json
2025-08-08 18:22:12,437 [INFO] Headers:
2025-08-08 18:22:12,437 [INFO] Content-Type : application/x-www-form-urlencoded
2025-08-08 18:22:12,438 [INFO] Accept : application/json
2025-08-08 18:22:12,438 [INFO] User-Agent : twilio-python/9.7.0 (Linux x86_64) Python/3.9.23
2025-08-08 18:22:12,438 [INFO] X-Twilio-Client : python-9.7.0
2025-08-08 18:22:12,439 [INFO] Accept-Charset : utf-8
2025-08-08 18:22:12,439 [INFO] -- END Twilio API Request --
2025-08-08 18:22:12,727 [INFO] Response Status Code: 429
2025-08-08 18:22:12,727 [INFO] Response Headers: {'Content-Type': 'application/json', 'Content-Length': '173', 'Connection': 'keep-alive', 'Date': 'Fri, 08 Aug 2025 18:22:12 GMT', 'X-Twilio-Error-Code': '63038', 'Twilio-Concurrent-Requests': '1', 'Twilio-Request-Id': 'RQ35871c1b0b13fc3c43831a957c45c8d1', 'Twilio-Request-Duration': '0.041', 'X-Home-Region': 'us1', 'X-API-Domain': 'api.twilio.com', 'Strict-Transport-Security': 'max-age=31536000', 'X-Cache': 'Error from cloudfront', 'Via': '1.1 b0c4c3183ea0dd9a0f495a148c420656.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'GRU3-P4', 'X-Amz-Cf-Id': 'im5Zi1bFK9eSw34XSWepUUl5Wk_K67R0tmxuEi0J1sOx92M8Y7ZDnA==', 'X-Powered-By': 'AT-5000', 'X-Shenanigans': 'none', 'Vary': 'Origin'}
2025-08-08 18:22:12,728 [ERROR] Falha ao enviar mensagem via API da Twilio: HTTP 429 error: Unable to create record: Account ACd2a6cd60871d661c034ecb40ddbd51e7 exceeded the 9 daily messages limit
2025-08-08 18:22:12,728 [INFO] THREAD: Processamento finalizado para 'Sim'
2025-08-08 18:35:06,695 [INFO]  * Detected change in '/app/ai_llm/llm_interface.py', reloading
2025-08-08 18:35:06,736 [INFO]  * Restarting with stat
2025-08-08 18:35:07,411 [WARNING]  * Debugger is active!
2025-08-08 18:35:07,411 [INFO]  * Debugger PIN: 112-391-589
2025-08-08 19:01:43,443 [INFO] [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8080
 * Running on http://172.18.0.3:8080
2025-08-08 19:01:43,443 [INFO] [33mPress CTRL+C to quit[0m
2025-08-08 19:01:43,444 [INFO]  * Restarting with stat
2025-08-08 19:01:44,193 [WARNING]  * Debugger is active!
2025-08-08 19:01:44,194 [INFO]  * Debugger PIN: 955-781-476
2025-08-08 19:19:48,594 [INFO] [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8080
 * Running on http://172.18.0.3:8080
2025-08-08 19:19:48,595 [INFO] [33mPress CTRL+C to quit[0m
2025-08-08 19:19:48,597 [INFO]  * Restarting with stat
2025-08-08 19:19:49,280 [WARNING]  * Debugger is active!
2025-08-08 19:19:49,281 [INFO]  * Debugger PIN: 112-853-424
2025-08-08 19:19:54,868 [INFO] 172.18.0.1 - - [08/Aug/2025 19:19:54] "POST /webhook HTTP/1.1" 200 -
2025-08-08 19:19:54,869 [INFO] Arquivo de sess√£o encontrado. Carregando.
2025-08-08 19:19:54,880 [INFO] [llm_interface.py] Iniciando get_intent para mensagem: 'Oi...'
2025-08-08 19:19:54,880 [INFO] [llm_interface.py] Tentando carregar prompt de: ai_llm/gav_prompt.txt
2025-08-08 19:19:54,887 [INFO] [llm_interface.py] Prompt carregado com sucesso. Tamanho: 2523 caracteres
2025-08-08 19:19:54,887 [INFO] [llm_interface.py] System prompt preparado. Tamanho: 2455 caracteres
2025-08-08 19:19:54,887 [INFO] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-08 19:19:54,903 [INFO] [llm_interface.py] Verificando disponibilidade do modelo: llama3.1
2025-08-08 19:19:54,932 [INFO] HTTP Request: GET http://host.docker.internal:11434/api/tags "HTTP/1.1 200 OK"
2025-08-08 19:19:54,933 [WARNING] [llm_interface.py] N√£o foi poss√≠vel verificar modelos dispon√≠veis: 'name'
2025-08-08 19:19:54,934 [INFO] [llm_interface.py] Enviando requisi√ß√£o para o modelo llama3.1
2025-08-08 19:20:04,088 [INFO] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-08 19:20:04,088 [INFO] [llm_interface.py] Resposta recebida do LLM. Tamanho: 267 caracteres
2025-08-08 19:20:04,089 [INFO] [llm_interface.py] JSON parseado com sucesso: {'tool_name': 'handle_chitchat', 'parameters': {'response_text': 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√≥a. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'}}
2025-08-08 19:20:04,089 [INFO] INTEN√á√ÉO PROCESSADA: {'tool_name': 'handle_chitchat', 'parameters': {'response_text': 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√≥a. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'}}
2025-08-08 19:20:04,089 [INFO] Salvando sess√£o: {'customer_context': None, 'shopping_cart': [], 'last_search_type': 'top_selling', 'last_search_params': {}, 'current_offset': 5, 'last_shown_products': [], 'last_bot_action': 'AWAITING_PRODUCT_SELECTION', 'pending_action': None, 'last_kb_search_term': None}
2025-08-08 19:20:04,093 [INFO] Enviando mensagem proativa para whatsapp:+5511940726493: 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√≥a. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'
2025-08-08 19:20:04,135 [INFO] -- BEGIN Twilio API Request --
2025-08-08 19:20:04,136 [INFO] POST Request: https://api.twilio.com/2010-04-01/Accounts/ACd2a6cd60871d661c034ecb40ddbd51e7/Messages.json
2025-08-08 19:20:04,136 [INFO] Headers:
2025-08-08 19:20:04,136 [INFO] Content-Type : application/x-www-form-urlencoded
2025-08-08 19:20:04,136 [INFO] Accept : application/json
2025-08-08 19:20:04,136 [INFO] User-Agent : twilio-python/9.7.0 (Linux x86_64) Python/3.9.23
2025-08-08 19:20:04,136 [INFO] X-Twilio-Client : python-9.7.0
2025-08-08 19:20:04,136 [INFO] Accept-Charset : utf-8
2025-08-08 19:20:04,136 [INFO] -- END Twilio API Request --
2025-08-08 19:20:04,780 [INFO] Response Status Code: 429
2025-08-08 19:20:04,780 [INFO] Response Headers: {'Content-Type': 'application/json', 'Content-Length': '173', 'Connection': 'keep-alive', 'Date': 'Fri, 08 Aug 2025 19:20:04 GMT', 'X-Twilio-Error-Code': '63038', 'Twilio-Concurrent-Requests': '1', 'Twilio-Request-Id': 'RQ87372ead545c8c9b8c8b180f6d16bf19', 'Twilio-Request-Duration': '0.053', 'X-Home-Region': 'us1', 'X-API-Domain': 'api.twilio.com', 'Strict-Transport-Security': 'max-age=31536000', 'X-Cache': 'Error from cloudfront', 'Via': '1.1 1f46652afcaf0a377b232da3cffaae08.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'GRU3-P4', 'X-Amz-Cf-Id': 'LOTc4jdKCUAmk_3APZx5_ccfGGRs1egVIA7a2I4nTwwRsKG1ERv5Tg==', 'X-Powered-By': 'AT-5000', 'X-Shenanigans': 'none', 'Vary': 'Origin'}
2025-08-08 19:20:04,780 [ERROR] Falha ao enviar mensagem via API da Twilio: HTTP 429 error: Unable to create record: Account ACd2a6cd60871d661c034ecb40ddbd51e7 exceeded the 9 daily messages limit
2025-08-08 19:20:04,781 [INFO] THREAD: Processamento finalizado para 'Oi'
2025-08-08 19:20:17,751 [INFO] 172.18.0.1 - - [08/Aug/2025 19:20:17] "POST /webhook HTTP/1.1" 200 -
2025-08-08 19:20:17,752 [INFO] Arquivo de sess√£o encontrado. Carregando.
2025-08-08 19:20:17,754 [INFO] [llm_interface.py] Iniciando get_intent para mensagem: 'Oi...'
2025-08-08 19:20:17,755 [INFO] [llm_interface.py] Tentando carregar prompt de: ai_llm/gav_prompt.txt
2025-08-08 19:20:17,756 [INFO] [llm_interface.py] Prompt carregado com sucesso. Tamanho: 2523 caracteres
2025-08-08 19:20:17,756 [INFO] [llm_interface.py] System prompt preparado. Tamanho: 2455 caracteres
2025-08-08 19:20:17,756 [INFO] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-08 19:20:17,777 [INFO] [llm_interface.py] Verificando disponibilidade do modelo: llama3.1
2025-08-08 19:20:17,783 [INFO] HTTP Request: GET http://host.docker.internal:11434/api/tags "HTTP/1.1 200 OK"
2025-08-08 19:20:17,784 [WARNING] [llm_interface.py] N√£o foi poss√≠vel verificar modelos dispon√≠veis: 'name'
2025-08-08 19:20:17,784 [INFO] [llm_interface.py] Enviando requisi√ß√£o para o modelo llama3.1
2025-08-08 19:20:19,791 [INFO] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-08 19:20:19,792 [INFO] [llm_interface.py] Resposta recebida do LLM. Tamanho: 272 caracteres
2025-08-08 19:20:19,792 [INFO] [llm_interface.py] JSON parseado com sucesso: {'tool_name': 'handle_chitchat', 'parameters': {'response_text': 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'}}
2025-08-08 19:20:19,792 [INFO] INTEN√á√ÉO PROCESSADA: {'tool_name': 'handle_chitchat', 'parameters': {'response_text': 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'}}
2025-08-08 19:20:19,793 [INFO] Salvando sess√£o: {'customer_context': None, 'shopping_cart': [], 'last_search_type': 'top_selling', 'last_search_params': {}, 'current_offset': 5, 'last_shown_products': [], 'last_bot_action': 'AWAITING_PRODUCT_SELECTION', 'pending_action': None, 'last_kb_search_term': None}
2025-08-08 19:20:19,794 [INFO] Enviando mensagem proativa para whatsapp:+5511940726493: 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'
2025-08-08 19:20:19,794 [INFO] -- BEGIN Twilio API Request --
2025-08-08 19:20:19,795 [INFO] POST Request: https://api.twilio.com/2010-04-01/Accounts/ACd2a6cd60871d661c034ecb40ddbd51e7/Messages.json
2025-08-08 19:20:19,795 [INFO] Headers:
2025-08-08 19:20:19,795 [INFO] Content-Type : application/x-www-form-urlencoded
2025-08-08 19:20:19,795 [INFO] Accept : application/json
2025-08-08 19:20:19,795 [INFO] User-Agent : twilio-python/9.7.0 (Linux x86_64) Python/3.9.23
2025-08-08 19:20:19,795 [INFO] X-Twilio-Client : python-9.7.0
2025-08-08 19:20:19,795 [INFO] Accept-Charset : utf-8
2025-08-08 19:20:19,795 [INFO] -- END Twilio API Request --
2025-08-08 19:20:20,109 [INFO] Response Status Code: 201
2025-08-08 19:20:20,109 [INFO] Response Headers: {'Content-Type': 'application/json;charset=utf-8', 'Content-Length': '991', 'Connection': 'keep-alive', 'Date': 'Fri, 08 Aug 2025 19:20:20 GMT', 'Twilio-Concurrent-Requests': '1', 'Twilio-Request-Id': 'RQb7a33d05eb82311e99269fe3563797c2', 'Twilio-Request-Duration': '0.104', 'X-Home-Region': 'us1', 'X-API-Domain': 'api.twilio.com', 'Strict-Transport-Security': 'max-age=31536000', 'X-Cache': 'Miss from cloudfront', 'Via': '1.1 1f46652afcaf0a377b232da3cffaae08.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'GRU3-P4', 'X-Amz-Cf-Id': 'rzfNOpnAdxtJLQI4h8zDK3DVnM2wqCJnJ2jrOXY2CcfGFxaXKGTr3Q==', 'X-Powered-By': 'AT-5000', 'X-Shenanigans': 'none', 'Vary': 'Origin'}
2025-08-08 19:20:20,109 [INFO] THREAD: Processamento finalizado para 'Oi'
2025-08-08 19:20:30,913 [INFO] 172.18.0.1 - - [08/Aug/2025 19:20:30] "POST /webhook HTTP/1.1" 200 -
2025-08-08 19:20:30,914 [INFO] Arquivo de sess√£o encontrado. Carregando.
2025-08-08 19:20:30,916 [INFO] [llm_interface.py] Iniciando get_intent para mensagem: 'Gostaria de comprar coca cola...'
2025-08-08 19:20:30,916 [INFO] [llm_interface.py] Tentando carregar prompt de: ai_llm/gav_prompt.txt
2025-08-08 19:20:30,917 [INFO] [llm_interface.py] Prompt carregado com sucesso. Tamanho: 2523 caracteres
2025-08-08 19:20:30,918 [INFO] [llm_interface.py] System prompt preparado. Tamanho: 2455 caracteres
2025-08-08 19:20:30,918 [INFO] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-08 19:20:30,935 [INFO] [llm_interface.py] Verificando disponibilidade do modelo: llama3.1
2025-08-08 19:20:30,946 [INFO] HTTP Request: GET http://host.docker.internal:11434/api/tags "HTTP/1.1 200 OK"
2025-08-08 19:20:30,947 [WARNING] [llm_interface.py] N√£o foi poss√≠vel verificar modelos dispon√≠veis: 'name'
2025-08-08 19:20:30,947 [INFO] [llm_interface.py] Enviando requisi√ß√£o para o modelo llama3.1
2025-08-08 19:20:31,777 [INFO] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-08 19:20:31,777 [INFO] [llm_interface.py] Resposta recebida do LLM. Tamanho: 94 caracteres
2025-08-08 19:20:31,777 [INFO] [llm_interface.py] JSON parseado com sucesso: {'tool_name': 'get_top_selling_products_by_name', 'parameters': {'product_name': 'coca cola'}}
2025-08-08 19:20:31,777 [INFO] INTEN√á√ÉO PROCESSADA: {'tool_name': 'get_top_selling_products_by_name', 'parameters': {'product_name': 'coca cola'}}
2025-08-08 19:20:31,780 [INFO] Base de conhecimento 'knowledge/knowledge_base.json' carregada.
2025-08-08 19:20:31,796 [INFO] Salvando sess√£o: {'customer_context': None, 'shopping_cart': [], 'last_search_type': 'by_name', 'last_search_params': {'product_name': 'coca cola'}, 'current_offset': 5, 'last_shown_products': [], 'last_bot_action': 'AWAITING_PRODUCT_SELECTION', 'pending_action': None, 'last_kb_search_term': None}
2025-08-08 19:20:31,798 [INFO] Enviando mensagem proativa para whatsapp:+5511940726493: 'ü§ñ Encontrei estes produtos relacionados a 'coca cola':
Nenhum produto encontrado com esse crit√©rio.'
2025-08-08 19:20:31,798 [INFO] -- BEGIN Twilio API Request --
2025-08-08 19:20:31,798 [INFO] POST Request: https://api.twilio.com/2010-04-01/Accounts/ACd2a6cd60871d661c034ecb40ddbd51e7/Messages.json
2025-08-08 19:20:31,799 [INFO] Headers:
2025-08-08 19:20:31,799 [INFO] Content-Type : application/x-www-form-urlencoded
2025-08-08 19:20:31,799 [INFO] Accept : application/json
2025-08-08 19:20:31,800 [INFO] User-Agent : twilio-python/9.7.0 (Linux x86_64) Python/3.9.23
2025-08-08 19:20:31,800 [INFO] X-Twilio-Client : python-9.7.0
2025-08-08 19:20:31,801 [INFO] Accept-Charset : utf-8
2025-08-08 19:20:31,801 [INFO] -- END Twilio API Request --
2025-08-08 19:20:32,061 [INFO] Response Status Code: 429
2025-08-08 19:20:32,061 [INFO] Response Headers: {'Content-Type': 'application/json', 'Content-Length': '173', 'Connection': 'keep-alive', 'Date': 'Fri, 08 Aug 2025 19:20:31 GMT', 'X-Twilio-Error-Code': '63038', 'Twilio-Concurrent-Requests': '1', 'Twilio-Request-Id': 'RQ310f8df72981d4d66400330d6e9adab1', 'Twilio-Request-Duration': '0.030', 'X-Home-Region': 'us1', 'X-API-Domain': 'api.twilio.com', 'Strict-Transport-Security': 'max-age=31536000', 'X-Cache': 'Error from cloudfront', 'Via': '1.1 1f46652afcaf0a377b232da3cffaae08.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'GRU3-P4', 'X-Amz-Cf-Id': 'mLOXqYK1N0pvB8Tw1j0FKGIBefWlhEJCf_zaLzWeFb2m5lRYPM0DcQ==', 'X-Powered-By': 'AT-5000', 'X-Shenanigans': 'none', 'Vary': 'Origin'}
2025-08-08 19:20:32,061 [ERROR] Falha ao enviar mensagem via API da Twilio: HTTP 429 error: Unable to create record: Account ACd2a6cd60871d661c034ecb40ddbd51e7 exceeded the 9 daily messages limit
2025-08-08 19:20:32,062 [INFO] THREAD: Processamento finalizado para 'Gostaria de comprar coca cola'
2025-08-08 19:21:04,795 [INFO] 172.18.0.1 - - [08/Aug/2025 19:21:04] "POST /webhook HTTP/1.1" 200 -
2025-08-08 19:21:04,796 [INFO] Arquivo de sess√£o encontrado. Carregando.
2025-08-08 19:21:04,798 [INFO] [llm_interface.py] Iniciando get_intent para mensagem: 'Gostaria de comprar coca-cola...'
2025-08-08 19:21:04,799 [INFO] [llm_interface.py] Tentando carregar prompt de: ai_llm/gav_prompt.txt
2025-08-08 19:21:04,800 [INFO] [llm_interface.py] Prompt carregado com sucesso. Tamanho: 2523 caracteres
2025-08-08 19:21:04,800 [INFO] [llm_interface.py] System prompt preparado. Tamanho: 2455 caracteres
2025-08-08 19:21:04,800 [INFO] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-08 19:21:04,814 [INFO] [llm_interface.py] Verificando disponibilidade do modelo: llama3.1
2025-08-08 19:21:04,819 [INFO] HTTP Request: GET http://host.docker.internal:11434/api/tags "HTTP/1.1 200 OK"
2025-08-08 19:21:04,819 [WARNING] [llm_interface.py] N√£o foi poss√≠vel verificar modelos dispon√≠veis: 'name'
2025-08-08 19:21:04,819 [INFO] [llm_interface.py] Enviando requisi√ß√£o para o modelo llama3.1
2025-08-08 19:21:05,745 [INFO] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-08 19:21:05,745 [INFO] [llm_interface.py] Resposta recebida do LLM. Tamanho: 89 caracteres
2025-08-08 19:21:05,745 [INFO] [llm_interface.py] JSON parseado com sucesso: {'tool_name': 'get_top_selling_products_by_name', 'parameters': {'product_name': 'coca'}}
2025-08-08 19:21:05,746 [INFO] INTEN√á√ÉO PROCESSADA: {'tool_name': 'get_top_selling_products_by_name', 'parameters': {'product_name': 'coca'}}
2025-08-08 19:21:05,751 [INFO] Salvando sess√£o: {'customer_context': None, 'shopping_cart': [], 'last_search_type': 'by_name', 'last_search_params': {'product_name': 'coca'}, 'current_offset': 5, 'last_shown_products': [{'codprod': 8130, 'descricao': 'REFRIG.COCA-COLA LT 350ML', 'pvenda': 4.2}, {'codprod': 13700, 'descricao': 'REFRIG.COCA-COLA PET 2L', 'pvenda': 8.5}], 'last_bot_action': 'AWAITING_PRODUCT_SELECTION', 'pending_action': None, 'last_kb_search_term': None}
2025-08-08 19:21:05,753 [INFO] Enviando mensagem proativa para whatsapp:+5511940726493: 'ü§ñ Encontrei estes produtos relacionados a 'coca':
1. REFRIG.COCA-COLA LT 350ML - R$ 4,20
2. REFRIG.COCA-COLA PET 2L - R$ 8,50
Me diga o nome ou o n√∫mero do item que deseja adicionar.
'
2025-08-08 19:21:05,753 [INFO] -- BEGIN Twilio API Request --
2025-08-08 19:21:05,753 [INFO] POST Request: https://api.twilio.com/2010-04-01/Accounts/ACd2a6cd60871d661c034ecb40ddbd51e7/Messages.json
2025-08-08 19:21:05,753 [INFO] Headers:
2025-08-08 19:21:05,753 [INFO] Content-Type : application/x-www-form-urlencoded
2025-08-08 19:21:05,754 [INFO] Accept : application/json
2025-08-08 19:21:05,754 [INFO] User-Agent : twilio-python/9.7.0 (Linux x86_64) Python/3.9.23
2025-08-08 19:21:05,754 [INFO] X-Twilio-Client : python-9.7.0
2025-08-08 19:21:05,754 [INFO] Accept-Charset : utf-8
2025-08-08 19:21:05,754 [INFO] -- END Twilio API Request --
2025-08-08 19:21:06,951 [INFO] Response Status Code: 201
2025-08-08 19:21:06,951 [INFO] Response Headers: {'Content-Type': 'application/json;charset=utf-8', 'Content-Length': '986', 'Connection': 'keep-alive', 'Date': 'Fri, 08 Aug 2025 19:21:06 GMT', 'Twilio-Concurrent-Requests': '1', 'Twilio-Request-Id': 'RQ25503306549447a45babedfa808ad3f6', 'Twilio-Request-Duration': '0.087', 'X-Home-Region': 'us1', 'X-API-Domain': 'api.twilio.com', 'Strict-Transport-Security': 'max-age=31536000', 'X-Cache': 'Miss from cloudfront', 'Via': '1.1 1f46652afcaf0a377b232da3cffaae08.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'GRU3-P4', 'X-Amz-Cf-Id': '9JvpZT30wNLYW0n5T-WIqjovNam7hPZFqZMfelQE-MEJzRUXThW8lg==', 'X-Powered-By': 'AT-5000', 'X-Shenanigans': 'none', 'Vary': 'Origin'}
2025-08-08 19:21:06,952 [INFO] THREAD: Processamento finalizado para 'Gostaria de comprar coca-cola'
2025-08-08 20:03:17,322 [INFO]  * Detected change in '/app/knowledge/knowledge.py', reloading
2025-08-08 20:03:17,495 [INFO]  * Restarting with stat
2025-08-08 20:17:14,024 [INFO] [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8080
 * Running on http://172.18.0.3:8080
2025-08-08 20:17:14,025 [INFO] [33mPress CTRL+C to quit[0m
2025-08-08 20:17:14,026 [INFO]  * Restarting with stat
2025-08-08 20:17:14,712 [WARNING]  * Debugger is active!
2025-08-08 20:17:14,713 [INFO]  * Debugger PIN: 586-468-811
2025-08-08 20:18:52,812 [INFO] 172.18.0.1 - - [08/Aug/2025 20:18:52] "POST /webhook HTTP/1.1" 200 -
2025-08-08 20:18:52,813 [INFO] Arquivo de sess√£o encontrado. Carregando.
2025-08-08 20:18:52,815 [INFO] [llm_interface.py] Iniciando get_intent para mensagem: 'oi...'
2025-08-08 20:18:52,815 [INFO] [llm_interface.py] Tentando carregar prompt de: ai_llm/gav_prompt.txt
2025-08-08 20:18:52,817 [INFO] [llm_interface.py] Prompt carregado com sucesso. Tamanho: 2326 caracteres
2025-08-08 20:18:52,817 [INFO] [llm_interface.py] System prompt preparado. Tamanho: 2262 caracteres
2025-08-08 20:18:52,817 [INFO] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-08 20:18:52,834 [INFO] [llm_interface.py] Verificando disponibilidade do modelo: llama3.1
2025-08-08 20:18:52,845 [INFO] HTTP Request: GET http://host.docker.internal:11434/api/tags "HTTP/1.1 200 OK"
2025-08-08 20:18:52,846 [WARNING] [llm_interface.py] N√£o foi poss√≠vel verificar modelos dispon√≠veis: 'name'
2025-08-08 20:18:52,846 [INFO] [llm_interface.py] Enviando requisi√ß√£o para o modelo llama3.1
2025-08-08 20:18:59,429 [INFO] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-08 20:18:59,430 [INFO] [llm_interface.py] Resposta recebida do LLM. Tamanho: 257 caracteres
2025-08-08 20:18:59,431 [INFO] [llm_interface.py] JSON parseado com sucesso: {'tool_name': 'handle_chitchat', 'parameters': {'response_text': 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'}}
2025-08-08 20:18:59,431 [INFO] INTEN√á√ÉO PROCESSADA: {'tool_name': 'handle_chitchat', 'parameters': {'response_text': 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'}}
2025-08-08 20:18:59,431 [INFO] Salvando sess√£o: {'customer_context': None, 'shopping_cart': [], 'last_search_type': 'by_name', 'last_search_params': {'product_name': 'coca'}, 'current_offset': 5, 'last_shown_products': [{'codprod': 8130, 'descricao': 'REFRIG.COCA-COLA LT 350ML', 'pvenda': 4.2}, {'codprod': 13700, 'descricao': 'REFRIG.COCA-COLA PET 2L', 'pvenda': 8.5}], 'last_bot_action': 'AWAITING_PRODUCT_SELECTION', 'pending_action': None, 'last_kb_search_term': None}
2025-08-08 20:18:59,434 [INFO] Enviando mensagem proativa para whatsapp:+5511940726493: 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'
2025-08-08 20:18:59,474 [INFO] -- BEGIN Twilio API Request --
2025-08-08 20:18:59,475 [INFO] POST Request: https://api.twilio.com/2010-04-01/Accounts/ACd2a6cd60871d661c034ecb40ddbd51e7/Messages.json
2025-08-08 20:18:59,475 [INFO] Headers:
2025-08-08 20:18:59,475 [INFO] Content-Type : application/x-www-form-urlencoded
2025-08-08 20:18:59,476 [INFO] Accept : application/json
2025-08-08 20:18:59,476 [INFO] User-Agent : twilio-python/9.7.0 (Linux x86_64) Python/3.9.23
2025-08-08 20:18:59,476 [INFO] X-Twilio-Client : python-9.7.0
2025-08-08 20:18:59,476 [INFO] Accept-Charset : utf-8
2025-08-08 20:18:59,476 [INFO] -- END Twilio API Request --
2025-08-08 20:19:00,450 [INFO] Response Status Code: 201
2025-08-08 20:19:00,450 [INFO] Response Headers: {'Content-Type': 'application/json;charset=utf-8', 'Content-Length': '991', 'Connection': 'keep-alive', 'Date': 'Fri, 08 Aug 2025 20:19:00 GMT', 'Twilio-Concurrent-Requests': '1', 'Twilio-Request-Id': 'RQ3586c09f65cd054d9e20683ba6fc6322', 'Twilio-Request-Duration': '0.102', 'X-Home-Region': 'us1', 'X-API-Domain': 'api.twilio.com', 'Strict-Transport-Security': 'max-age=31536000', 'X-Cache': 'Miss from cloudfront', 'Via': '1.1 ba909a19c27187e9d323c04aa5d94468.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'MIA3-P8', 'X-Amz-Cf-Id': '-_HLY5wZcsZ5FIYBFVcl-7bVPyMt9z5WfG72zuMzynjBdF6lu58z4Q==', 'X-Powered-By': 'AT-5000', 'X-Shenanigans': 'none', 'Vary': 'Origin'}
2025-08-08 20:19:00,451 [INFO] THREAD: Processamento finalizado para 'oi'
2025-08-08 20:19:10,737 [INFO] 172.18.0.1 - - [08/Aug/2025 20:19:10] "POST /webhook HTTP/1.1" 200 -
2025-08-08 20:19:10,739 [INFO] Arquivo de sess√£o encontrado. Carregando.
2025-08-08 20:19:10,740 [INFO] [llm_interface.py] Iniciando get_intent para mensagem: 'Quero ver os produtos da fanta...'
2025-08-08 20:19:10,741 [INFO] [llm_interface.py] Tentando carregar prompt de: ai_llm/gav_prompt.txt
2025-08-08 20:19:10,742 [INFO] [llm_interface.py] Prompt carregado com sucesso. Tamanho: 2326 caracteres
2025-08-08 20:19:10,743 [INFO] [llm_interface.py] System prompt preparado. Tamanho: 2262 caracteres
2025-08-08 20:19:10,743 [INFO] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-08 20:19:10,759 [INFO] [llm_interface.py] Verificando disponibilidade do modelo: llama3.1
2025-08-08 20:19:10,764 [INFO] HTTP Request: GET http://host.docker.internal:11434/api/tags "HTTP/1.1 200 OK"
2025-08-08 20:19:10,764 [WARNING] [llm_interface.py] N√£o foi poss√≠vel verificar modelos dispon√≠veis: 'name'
2025-08-08 20:19:10,764 [INFO] [llm_interface.py] Enviando requisi√ß√£o para o modelo llama3.1
2025-08-08 20:19:11,597 [INFO] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-08 20:19:11,597 [INFO] [llm_interface.py] Resposta recebida do LLM. Tamanho: 90 caracteres
2025-08-08 20:19:11,598 [INFO] [llm_interface.py] JSON parseado com sucesso: {'tool_name': 'get_top_selling_products_by_name', 'parameters': {'product_name': 'Fanta'}}
2025-08-08 20:19:11,598 [INFO] INTEN√á√ÉO PROCESSADA: {'tool_name': 'get_top_selling_products_by_name', 'parameters': {'product_name': 'Fanta'}}
2025-08-08 20:19:11,599 [INFO] Base de conhecimento 'knowledge/knowledge_base.json' carregada com 0 termos.
2025-08-08 20:19:11,612 [INFO] Salvando sess√£o: {'customer_context': None, 'shopping_cart': [], 'last_search_type': 'by_name', 'last_search_params': {'product_name': 'Fanta'}, 'current_offset': 5, 'last_shown_products': [], 'last_bot_action': 'AWAITING_PRODUCT_SELECTION', 'pending_action': None, 'last_kb_search_term': None}
2025-08-08 20:19:11,614 [INFO] Enviando mensagem proativa para whatsapp:+5511940726493: 'ü§ñ Encontrei estes produtos relacionados a 'Fanta':
Nenhum produto encontrado com esse crit√©rio.'
2025-08-08 20:19:11,614 [INFO] -- BEGIN Twilio API Request --
2025-08-08 20:19:11,615 [INFO] POST Request: https://api.twilio.com/2010-04-01/Accounts/ACd2a6cd60871d661c034ecb40ddbd51e7/Messages.json
2025-08-08 20:19:11,615 [INFO] Headers:
2025-08-08 20:19:11,615 [INFO] Content-Type : application/x-www-form-urlencoded
2025-08-08 20:19:11,615 [INFO] Accept : application/json
2025-08-08 20:19:11,615 [INFO] User-Agent : twilio-python/9.7.0 (Linux x86_64) Python/3.9.23
2025-08-08 20:19:11,615 [INFO] X-Twilio-Client : python-9.7.0
2025-08-08 20:19:11,615 [INFO] Accept-Charset : utf-8
2025-08-08 20:19:11,616 [INFO] -- END Twilio API Request --
2025-08-08 20:19:11,855 [INFO] Response Status Code: 201
2025-08-08 20:19:11,855 [INFO] Response Headers: {'Content-Type': 'application/json;charset=utf-8', 'Content-Length': '895', 'Connection': 'keep-alive', 'Date': 'Fri, 08 Aug 2025 20:19:11 GMT', 'Twilio-Concurrent-Requests': '1', 'Twilio-Request-Id': 'RQ3c897f515407042351ee33a6c0382bd6', 'Twilio-Request-Duration': '0.099', 'X-Home-Region': 'us1', 'X-API-Domain': 'api.twilio.com', 'Strict-Transport-Security': 'max-age=31536000', 'X-Cache': 'Miss from cloudfront', 'Via': '1.1 ba909a19c27187e9d323c04aa5d94468.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'MIA3-P8', 'X-Amz-Cf-Id': '7kFjcARm4P7h2lfI67ZbgMYPw257O7tPdXBLAEeQ1yQzb8qk7Cb08w==', 'X-Powered-By': 'AT-5000', 'X-Shenanigans': 'none', 'Vary': 'Origin'}
2025-08-08 20:19:11,855 [INFO] THREAD: Processamento finalizado para 'Quero ver os produtos da fanta'
2025-08-08 20:19:21,491 [INFO] 172.18.0.1 - - [08/Aug/2025 20:19:21] "POST /webhook HTTP/1.1" 200 -
2025-08-08 20:19:21,492 [INFO] Arquivo de sess√£o encontrado. Carregando.
2025-08-08 20:19:21,504 [INFO] [llm_interface.py] Iniciando get_intent para mensagem: 'e coca cola ?...'
2025-08-08 20:19:21,504 [INFO] [llm_interface.py] Tentando carregar prompt de: ai_llm/gav_prompt.txt
2025-08-08 20:19:21,511 [INFO] [llm_interface.py] Prompt carregado com sucesso. Tamanho: 2326 caracteres
2025-08-08 20:19:21,511 [INFO] [llm_interface.py] System prompt preparado. Tamanho: 2262 caracteres
2025-08-08 20:19:21,512 [INFO] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-08 20:19:21,526 [INFO] [llm_interface.py] Verificando disponibilidade do modelo: llama3.1
2025-08-08 20:19:21,535 [INFO] HTTP Request: GET http://host.docker.internal:11434/api/tags "HTTP/1.1 200 OK"
2025-08-08 20:19:21,536 [WARNING] [llm_interface.py] N√£o foi poss√≠vel verificar modelos dispon√≠veis: 'name'
2025-08-08 20:19:21,538 [INFO] [llm_interface.py] Enviando requisi√ß√£o para o modelo llama3.1
2025-08-08 20:19:22,412 [INFO] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-08 20:19:22,412 [INFO] [llm_interface.py] Resposta recebida do LLM. Tamanho: 94 caracteres
2025-08-08 20:19:22,412 [INFO] [llm_interface.py] JSON parseado com sucesso: {'tool_name': 'get_top_selling_products_by_name', 'parameters': {'product_name': 'coca cola'}}
2025-08-08 20:19:22,412 [INFO] INTEN√á√ÉO PROCESSADA: {'tool_name': 'get_top_selling_products_by_name', 'parameters': {'product_name': 'coca cola'}}
2025-08-08 20:19:22,417 [INFO] Salvando sess√£o: {'customer_context': None, 'shopping_cart': [], 'last_search_type': 'by_name', 'last_search_params': {'product_name': 'coca cola'}, 'current_offset': 5, 'last_shown_products': [], 'last_bot_action': 'AWAITING_PRODUCT_SELECTION', 'pending_action': None, 'last_kb_search_term': None}
2025-08-08 20:19:22,419 [INFO] Enviando mensagem proativa para whatsapp:+5511940726493: 'ü§ñ Encontrei estes produtos relacionados a 'coca cola':
Nenhum produto encontrado com esse crit√©rio.'
2025-08-08 20:19:22,419 [INFO] -- BEGIN Twilio API Request --
2025-08-08 20:19:22,420 [INFO] POST Request: https://api.twilio.com/2010-04-01/Accounts/ACd2a6cd60871d661c034ecb40ddbd51e7/Messages.json
2025-08-08 20:19:22,420 [INFO] Headers:
2025-08-08 20:19:22,420 [INFO] Content-Type : application/x-www-form-urlencoded
2025-08-08 20:19:22,420 [INFO] Accept : application/json
2025-08-08 20:19:22,421 [INFO] User-Agent : twilio-python/9.7.0 (Linux x86_64) Python/3.9.23
2025-08-08 20:19:22,421 [INFO] X-Twilio-Client : python-9.7.0
2025-08-08 20:19:22,421 [INFO] Accept-Charset : utf-8
2025-08-08 20:19:22,421 [INFO] -- END Twilio API Request --
2025-08-08 20:19:22,656 [INFO] Response Status Code: 201
2025-08-08 20:19:22,656 [INFO] Response Headers: {'Content-Type': 'application/json;charset=utf-8', 'Content-Length': '899', 'Connection': 'keep-alive', 'Date': 'Fri, 08 Aug 2025 20:19:22 GMT', 'Twilio-Concurrent-Requests': '1', 'Twilio-Request-Id': 'RQbf57c4b9de772899173146a1b466e89e', 'Twilio-Request-Duration': '0.095', 'X-Home-Region': 'us1', 'X-API-Domain': 'api.twilio.com', 'Strict-Transport-Security': 'max-age=31536000', 'X-Cache': 'Miss from cloudfront', 'Via': '1.1 ba909a19c27187e9d323c04aa5d94468.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'MIA3-P8', 'X-Amz-Cf-Id': 'BFXJDRvFkkmmQMFvdP0OG9285iASYsQn-K4EV0_U27XM0Gz6C5g08A==', 'X-Powered-By': 'AT-5000', 'X-Shenanigans': 'none', 'Vary': 'Origin'}
2025-08-08 20:19:22,656 [INFO] THREAD: Processamento finalizado para 'e coca cola ?'
2025-08-08 20:31:53,415 [INFO]  * Detected change in '/app/knowledge/knowledge.py', reloading
2025-08-08 20:31:53,500 [INFO]  * Restarting with stat
2025-08-08 20:31:54,342 [WARNING]  * Debugger is active!
2025-08-08 20:31:54,344 [INFO]  * Debugger PIN: 586-468-811
2025-08-08 20:32:15,970 [INFO] [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8080
 * Running on http://172.18.0.3:8080
2025-08-08 20:32:15,971 [INFO] [33mPress CTRL+C to quit[0m
2025-08-08 20:32:15,972 [INFO]  * Restarting with stat
2025-08-08 20:32:16,724 [WARNING]  * Debugger is active!
2025-08-08 20:32:16,725 [INFO]  * Debugger PIN: 100-851-203
2025-08-08 20:32:28,773 [INFO] 172.18.0.1 - - [08/Aug/2025 20:32:28] "POST /webhook HTTP/1.1" 200 -
2025-08-08 20:32:28,774 [INFO] Arquivo de sess√£o encontrado. Carregando.
2025-08-08 20:32:28,777 [INFO] [llm_interface.py] Iniciando get_intent para mensagem: 'oi...'
2025-08-08 20:32:28,777 [INFO] [llm_interface.py] Tentando carregar prompt de: ai_llm/gav_prompt.txt
2025-08-08 20:32:28,778 [INFO] [llm_interface.py] Prompt carregado com sucesso. Tamanho: 2326 caracteres
2025-08-08 20:32:28,779 [INFO] [llm_interface.py] System prompt preparado. Tamanho: 2262 caracteres
2025-08-08 20:32:28,779 [INFO] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-08 20:32:28,793 [INFO] [llm_interface.py] Verificando disponibilidade do modelo: llama3.1
2025-08-08 20:32:28,803 [INFO] HTTP Request: GET http://host.docker.internal:11434/api/tags "HTTP/1.1 200 OK"
2025-08-08 20:32:28,803 [WARNING] [llm_interface.py] N√£o foi poss√≠vel verificar modelos dispon√≠veis: 'name'
2025-08-08 20:32:28,806 [INFO] [llm_interface.py] Enviando requisi√ß√£o para o modelo llama3.1
2025-08-08 20:32:34,821 [INFO] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-08 20:32:34,822 [INFO] [llm_interface.py] Resposta recebida do LLM. Tamanho: 262 caracteres
2025-08-08 20:32:34,822 [INFO] [llm_interface.py] JSON parseado com sucesso: {'tool_name': 'handle_chitchat', 'parameters': {'response_text': 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'}}
2025-08-08 20:32:34,822 [INFO] INTEN√á√ÉO PROCESSADA: {'tool_name': 'handle_chitchat', 'parameters': {'response_text': 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'}}
2025-08-08 20:32:34,823 [INFO] Salvando sess√£o: {'customer_context': None, 'shopping_cart': [], 'last_search_type': 'by_name', 'last_search_params': {'product_name': 'coca cola'}, 'current_offset': 5, 'last_shown_products': [], 'last_bot_action': 'AWAITING_PRODUCT_SELECTION', 'pending_action': None, 'last_kb_search_term': None}
2025-08-08 20:32:34,825 [INFO] Enviando mensagem proativa para whatsapp:+5511940726493: 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'
2025-08-08 20:32:34,860 [INFO] -- BEGIN Twilio API Request --
2025-08-08 20:32:34,861 [INFO] POST Request: https://api.twilio.com/2010-04-01/Accounts/ACd2a6cd60871d661c034ecb40ddbd51e7/Messages.json
2025-08-08 20:32:34,861 [INFO] Headers:
2025-08-08 20:32:34,861 [INFO] Content-Type : application/x-www-form-urlencoded
2025-08-08 20:32:34,861 [INFO] Accept : application/json
2025-08-08 20:32:34,861 [INFO] User-Agent : twilio-python/9.7.0 (Linux x86_64) Python/3.9.23
2025-08-08 20:32:34,861 [INFO] X-Twilio-Client : python-9.7.0
2025-08-08 20:32:34,861 [INFO] Accept-Charset : utf-8
2025-08-08 20:32:34,861 [INFO] -- END Twilio API Request --
2025-08-08 20:32:35,123 [INFO] Response Status Code: 201
2025-08-08 20:32:35,124 [INFO] Response Headers: {'Content-Type': 'application/json;charset=utf-8', 'Content-Length': '991', 'Connection': 'keep-alive', 'Date': 'Fri, 08 Aug 2025 20:32:35 GMT', 'Twilio-Concurrent-Requests': '1', 'Twilio-Request-Id': 'RQff179f06d2d8be1bd21b4c9ceccfd112', 'Twilio-Request-Duration': '0.115', 'X-Home-Region': 'us1', 'X-API-Domain': 'api.twilio.com', 'Strict-Transport-Security': 'max-age=31536000', 'X-Cache': 'Miss from cloudfront', 'Via': '1.1 6f2f291762a32a9876c9d69d778cb280.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'GRU3-P4', 'X-Amz-Cf-Id': '-3AKbSc0qrXVBZ1i4N40t_6PQ0XvpxqqGlKmzElPjtRaOEopTwxtNw==', 'X-Powered-By': 'AT-5000', 'X-Shenanigans': 'none', 'Vary': 'Origin'}
2025-08-08 20:32:35,124 [INFO] THREAD: Processamento finalizado para 'oi'
2025-08-08 20:35:51,349 [INFO]  * Detected change in '/app/knowledge/knowledge.py', reloading
2025-08-08 20:35:51,399 [INFO]  * Restarting with stat
2025-08-08 20:35:52,111 [WARNING]  * Debugger is active!
2025-08-08 20:35:52,113 [INFO]  * Debugger PIN: 100-851-203
2025-08-08 20:41:16,272 [INFO] [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8080
 * Running on http://172.18.0.3:8080
2025-08-08 20:41:16,272 [INFO] [33mPress CTRL+C to quit[0m
2025-08-08 20:41:16,273 [INFO]  * Restarting with stat
2025-08-08 20:41:17,009 [WARNING]  * Debugger is active!
2025-08-08 20:41:17,010 [INFO]  * Debugger PIN: 139-787-397
2025-08-08 20:44:01,312 [INFO] [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8080
 * Running on http://172.18.0.3:8080
2025-08-08 20:44:01,312 [INFO] [33mPress CTRL+C to quit[0m
2025-08-08 20:44:01,313 [INFO]  * Restarting with stat
2025-08-08 20:44:01,977 [WARNING]  * Debugger is active!
2025-08-08 20:44:01,978 [INFO]  * Debugger PIN: 100-009-944
2025-08-08 20:44:25,657 [INFO] 172.18.0.1 - - [08/Aug/2025 20:44:25] "POST /webhook HTTP/1.1" 200 -
2025-08-08 20:44:25,658 [INFO] Arquivo de sess√£o encontrado. Carregando.
2025-08-08 20:44:25,660 [INFO] [llm_interface.py] Iniciando get_intent para mensagem: 'quero coca cola...'
2025-08-08 20:44:25,661 [INFO] [llm_interface.py] Tentando carregar prompt de: ai_llm/gav_prompt.txt
2025-08-08 20:44:25,701 [INFO] [llm_interface.py] Prompt carregado com sucesso. Tamanho: 2326 caracteres
2025-08-08 20:44:25,701 [INFO] [llm_interface.py] System prompt preparado. Tamanho: 2262 caracteres
2025-08-08 20:44:25,701 [INFO] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-08 20:44:25,715 [INFO] [llm_interface.py] Verificando disponibilidade do modelo: llama3.1
2025-08-08 20:44:25,733 [INFO] HTTP Request: GET http://host.docker.internal:11434/api/tags "HTTP/1.1 200 OK"
2025-08-08 20:44:25,734 [WARNING] [llm_interface.py] N√£o foi poss√≠vel verificar modelos dispon√≠veis: 'name'
2025-08-08 20:44:25,734 [INFO] [llm_interface.py] Enviando requisi√ß√£o para o modelo llama3.1
2025-08-08 20:44:29,030 [INFO] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-08 20:44:29,031 [INFO] [llm_interface.py] Resposta recebida do LLM. Tamanho: 94 caracteres
2025-08-08 20:44:29,032 [INFO] [llm_interface.py] JSON parseado com sucesso: {'tool_name': 'get_top_selling_products_by_name', 'parameters': {'product_name': 'Coca Cola'}}
2025-08-08 20:44:29,032 [INFO] INTEN√á√ÉO PROCESSADA: {'tool_name': 'get_top_selling_products_by_name', 'parameters': {'product_name': 'Coca Cola'}}
2025-08-08 20:44:29,036 [INFO] Base de conhecimento '/app/knowledge/knowledge_base.json' carregada com 0 produtos e 0 termos.
2025-08-08 20:44:29,045 [INFO] Salvando sess√£o: {'customer_context': None, 'shopping_cart': [], 'last_search_type': 'by_name', 'last_search_params': {'product_name': 'Coca Cola'}, 'current_offset': 5, 'last_shown_products': [], 'last_bot_action': 'AWAITING_PRODUCT_SELECTION', 'pending_action': None, 'last_kb_search_term': None}
2025-08-08 20:44:29,047 [INFO] Enviando mensagem proativa para whatsapp:+5511940726493: 'ü§ñ Encontrei estes produtos relacionados a 'Coca Cola':
Nenhum produto encontrado com esse crit√©rio.'
2025-08-08 20:44:29,072 [INFO] -- BEGIN Twilio API Request --
2025-08-08 20:44:29,072 [INFO] POST Request: https://api.twilio.com/2010-04-01/Accounts/ACd2a6cd60871d661c034ecb40ddbd51e7/Messages.json
2025-08-08 20:44:29,073 [INFO] Headers:
2025-08-08 20:44:29,073 [INFO] Content-Type : application/x-www-form-urlencoded
2025-08-08 20:44:29,073 [INFO] Accept : application/json
2025-08-08 20:44:29,073 [INFO] User-Agent : twilio-python/9.7.0 (Linux x86_64) Python/3.9.23
2025-08-08 20:44:29,073 [INFO] X-Twilio-Client : python-9.7.0
2025-08-08 20:44:29,073 [INFO] Accept-Charset : utf-8
2025-08-08 20:44:29,074 [INFO] -- END Twilio API Request --
2025-08-08 20:44:29,469 [INFO] Response Status Code: 201
2025-08-08 20:44:29,469 [INFO] Response Headers: {'Content-Type': 'application/json;charset=utf-8', 'Content-Length': '899', 'Connection': 'keep-alive', 'Date': 'Fri, 08 Aug 2025 20:44:29 GMT', 'Twilio-Concurrent-Requests': '1', 'Twilio-Request-Id': 'RQ976cd4706556c10f41a66f901f65dbef', 'Twilio-Request-Duration': '0.126', 'X-Home-Region': 'us1', 'X-API-Domain': 'api.twilio.com', 'Strict-Transport-Security': 'max-age=31536000', 'X-Cache': 'Miss from cloudfront', 'Via': '1.1 381ddca30a3b9978a6c84a246d0a25ce.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'GRU3-P4', 'X-Amz-Cf-Id': 'zMH5tSU2cSNLjaiR9U29RxhkQ9P89S-jZyoirC-hrYnz5XpsyXogMQ==', 'X-Powered-By': 'AT-5000', 'X-Shenanigans': 'none', 'Vary': 'Origin'}
2025-08-08 20:44:29,469 [INFO] THREAD: Processamento finalizado para 'quero coca cola'
2025-08-08 20:45:59,558 [INFO] 172.18.0.1 - - [08/Aug/2025 20:45:59] "POST /webhook HTTP/1.1" 200 -
2025-08-08 20:45:59,559 [INFO] Arquivo de sess√£o encontrado. Carregando.
2025-08-08 20:45:59,560 [INFO] [llm_interface.py] Iniciando get_intent para mensagem: 'quero coca cola...'
2025-08-08 20:45:59,561 [INFO] [llm_interface.py] Tentando carregar prompt de: ai_llm/gav_prompt.txt
2025-08-08 20:45:59,562 [INFO] [llm_interface.py] Prompt carregado com sucesso. Tamanho: 2326 caracteres
2025-08-08 20:45:59,562 [INFO] [llm_interface.py] System prompt preparado. Tamanho: 2262 caracteres
2025-08-08 20:45:59,562 [INFO] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-08 20:45:59,576 [INFO] [llm_interface.py] Verificando disponibilidade do modelo: llama3.1
2025-08-08 20:45:59,581 [INFO] HTTP Request: GET http://host.docker.internal:11434/api/tags "HTTP/1.1 200 OK"
2025-08-08 20:45:59,581 [WARNING] [llm_interface.py] N√£o foi poss√≠vel verificar modelos dispon√≠veis: 'name'
2025-08-08 20:45:59,581 [INFO] [llm_interface.py] Enviando requisi√ß√£o para o modelo llama3.1
2025-08-08 20:46:00,859 [INFO] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-08 20:46:00,859 [INFO] [llm_interface.py] Resposta recebida do LLM. Tamanho: 94 caracteres
2025-08-08 20:46:00,860 [INFO] [llm_interface.py] JSON parseado com sucesso: {'tool_name': 'get_top_selling_products_by_name', 'parameters': {'product_name': 'coca cola'}}
2025-08-08 20:46:00,860 [INFO] INTEN√á√ÉO PROCESSADA: {'tool_name': 'get_top_selling_products_by_name', 'parameters': {'product_name': 'coca cola'}}
2025-08-08 20:46:00,864 [INFO] Salvando sess√£o: {'customer_context': None, 'shopping_cart': [], 'last_search_type': 'by_name', 'last_search_params': {'product_name': 'coca cola'}, 'current_offset': 5, 'last_shown_products': [], 'last_bot_action': 'AWAITING_PRODUCT_SELECTION', 'pending_action': None, 'last_kb_search_term': None}
2025-08-08 20:46:00,866 [INFO] Enviando mensagem proativa para whatsapp:+5511940726493: 'ü§ñ Encontrei estes produtos relacionados a 'coca cola':
Nenhum produto encontrado com esse crit√©rio.'
2025-08-08 20:46:00,866 [INFO] -- BEGIN Twilio API Request --
2025-08-08 20:46:00,866 [INFO] POST Request: https://api.twilio.com/2010-04-01/Accounts/ACd2a6cd60871d661c034ecb40ddbd51e7/Messages.json
2025-08-08 20:46:00,866 [INFO] Headers:
2025-08-08 20:46:00,866 [INFO] Content-Type : application/x-www-form-urlencoded
2025-08-08 20:46:00,874 [INFO] Accept : application/json
2025-08-08 20:46:00,874 [INFO] User-Agent : twilio-python/9.7.0 (Linux x86_64) Python/3.9.23
2025-08-08 20:46:00,874 [INFO] X-Twilio-Client : python-9.7.0
2025-08-08 20:46:00,875 [INFO] Accept-Charset : utf-8
2025-08-08 20:46:00,875 [INFO] -- END Twilio API Request --
2025-08-08 20:46:01,037 [INFO] Response Status Code: 429
2025-08-08 20:46:01,037 [INFO] Response Headers: {'Content-Type': 'application/json', 'Content-Length': '173', 'Connection': 'keep-alive', 'Date': 'Fri, 08 Aug 2025 20:46:00 GMT', 'X-Twilio-Error-Code': '63038', 'Twilio-Concurrent-Requests': '1', 'Twilio-Request-Id': 'RQ23b4267f356b6ab511eebeaa1d382f3e', 'Twilio-Request-Duration': '0.037', 'X-Home-Region': 'us1', 'X-API-Domain': 'api.twilio.com', 'Strict-Transport-Security': 'max-age=31536000', 'X-Cache': 'Error from cloudfront', 'Via': '1.1 381ddca30a3b9978a6c84a246d0a25ce.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'GRU3-P4', 'X-Amz-Cf-Id': 'Ae_VWt3PF2l8GcT8cYpMtCPwM_DmnCt3Wjfaa7DQLSbGyArCWu6d4g==', 'X-Powered-By': 'AT-5000', 'X-Shenanigans': 'none', 'Vary': 'Origin'}
2025-08-08 20:46:01,038 [ERROR] Falha ao enviar mensagem via API da Twilio: HTTP 429 error: Unable to create record: Account ACd2a6cd60871d661c034ecb40ddbd51e7 exceeded the 9 daily messages limit
2025-08-08 20:46:01,038 [INFO] THREAD: Processamento finalizado para 'quero coca cola'
2025-08-08 20:46:13,791 [INFO] 172.18.0.1 - - [08/Aug/2025 20:46:13] "POST /webhook HTTP/1.1" 200 -
2025-08-08 20:46:13,792 [INFO] Arquivo de sess√£o encontrado. Carregando.
2025-08-08 20:46:13,794 [INFO] [llm_interface.py] Iniciando get_intent para mensagem: 'oi...'
2025-08-08 20:46:13,794 [INFO] [llm_interface.py] Tentando carregar prompt de: ai_llm/gav_prompt.txt
2025-08-08 20:46:13,795 [INFO] [llm_interface.py] Prompt carregado com sucesso. Tamanho: 2326 caracteres
2025-08-08 20:46:13,796 [INFO] [llm_interface.py] System prompt preparado. Tamanho: 2262 caracteres
2025-08-08 20:46:13,796 [INFO] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-08 20:46:13,813 [INFO] [llm_interface.py] Verificando disponibilidade do modelo: llama3.1
2025-08-08 20:46:13,826 [INFO] HTTP Request: GET http://host.docker.internal:11434/api/tags "HTTP/1.1 200 OK"
2025-08-08 20:46:13,827 [WARNING] [llm_interface.py] N√£o foi poss√≠vel verificar modelos dispon√≠veis: 'name'
2025-08-08 20:46:13,828 [INFO] [llm_interface.py] Enviando requisi√ß√£o para o modelo llama3.1
2025-08-08 20:46:16,030 [INFO] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-08 20:46:16,031 [INFO] [llm_interface.py] Resposta recebida do LLM. Tamanho: 277 caracteres
2025-08-08 20:46:16,033 [INFO] [llm_interface.py] JSON parseado com sucesso: {'tool_name': 'handle_chitchat', 'parameters': {'response_text': 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'}}
2025-08-08 20:46:16,034 [INFO] INTEN√á√ÉO PROCESSADA: {'tool_name': 'handle_chitchat', 'parameters': {'response_text': 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'}}
2025-08-08 20:46:16,034 [INFO] Salvando sess√£o: {'customer_context': None, 'shopping_cart': [], 'last_search_type': 'by_name', 'last_search_params': {'product_name': 'coca cola'}, 'current_offset': 5, 'last_shown_products': [], 'last_bot_action': 'AWAITING_PRODUCT_SELECTION', 'pending_action': None, 'last_kb_search_term': None}
2025-08-08 20:46:16,051 [INFO] Enviando mensagem proativa para whatsapp:+5511940726493: 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'
2025-08-08 20:46:16,052 [INFO] -- BEGIN Twilio API Request --
2025-08-08 20:46:16,052 [INFO] POST Request: https://api.twilio.com/2010-04-01/Accounts/ACd2a6cd60871d661c034ecb40ddbd51e7/Messages.json
2025-08-08 20:46:16,054 [INFO] Headers:
2025-08-08 20:46:16,054 [INFO] Content-Type : application/x-www-form-urlencoded
2025-08-08 20:46:16,054 [INFO] Accept : application/json
2025-08-08 20:46:16,054 [INFO] User-Agent : twilio-python/9.7.0 (Linux x86_64) Python/3.9.23
2025-08-08 20:46:16,055 [INFO] X-Twilio-Client : python-9.7.0
2025-08-08 20:46:16,055 [INFO] Accept-Charset : utf-8
2025-08-08 20:46:16,055 [INFO] -- END Twilio API Request --
2025-08-08 20:46:16,216 [INFO] Response Status Code: 429
2025-08-08 20:46:16,217 [INFO] Response Headers: {'Content-Type': 'application/json', 'Content-Length': '173', 'Connection': 'keep-alive', 'Date': 'Fri, 08 Aug 2025 20:46:16 GMT', 'X-Twilio-Error-Code': '63038', 'Twilio-Concurrent-Requests': '1', 'Twilio-Request-Id': 'RQ7ddce4a33603e8ca981bd3293bf9d166', 'Twilio-Request-Duration': '0.038', 'X-Home-Region': 'us1', 'X-API-Domain': 'api.twilio.com', 'Strict-Transport-Security': 'max-age=31536000', 'X-Cache': 'Error from cloudfront', 'Via': '1.1 381ddca30a3b9978a6c84a246d0a25ce.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'GRU3-P4', 'X-Amz-Cf-Id': 'JTNqQd9EuNNm2PPVkHB9yrjIe2WUSspi9ktrfRjZCfaUNxerBc70ag==', 'X-Powered-By': 'AT-5000', 'X-Shenanigans': 'none', 'Vary': 'Origin'}
2025-08-08 20:46:16,218 [ERROR] Falha ao enviar mensagem via API da Twilio: HTTP 429 error: Unable to create record: Account ACd2a6cd60871d661c034ecb40ddbd51e7 exceeded the 9 daily messages limit
2025-08-08 20:46:16,219 [INFO] THREAD: Processamento finalizado para 'oi'
2025-08-08 20:46:24,657 [INFO] 172.18.0.1 - - [08/Aug/2025 20:46:24] "POST /webhook HTTP/1.1" 200 -
2025-08-08 20:46:24,658 [INFO] Arquivo de sess√£o encontrado. Carregando.
2025-08-08 20:46:24,660 [INFO] [llm_interface.py] Iniciando get_intent para mensagem: 'Quero coca cola...'
2025-08-08 20:46:24,660 [INFO] [llm_interface.py] Tentando carregar prompt de: ai_llm/gav_prompt.txt
2025-08-08 20:46:24,662 [INFO] [llm_interface.py] Prompt carregado com sucesso. Tamanho: 2326 caracteres
2025-08-08 20:46:24,663 [INFO] [llm_interface.py] System prompt preparado. Tamanho: 2262 caracteres
2025-08-08 20:46:24,663 [INFO] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-08 20:46:24,676 [INFO] [llm_interface.py] Verificando disponibilidade do modelo: llama3.1
2025-08-08 20:46:24,686 [INFO] HTTP Request: GET http://host.docker.internal:11434/api/tags "HTTP/1.1 200 OK"
2025-08-08 20:46:24,687 [WARNING] [llm_interface.py] N√£o foi poss√≠vel verificar modelos dispon√≠veis: 'name'
2025-08-08 20:46:24,687 [INFO] [llm_interface.py] Enviando requisi√ß√£o para o modelo llama3.1
2025-08-08 20:46:25,512 [INFO] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-08 20:46:25,512 [INFO] [llm_interface.py] Resposta recebida do LLM. Tamanho: 94 caracteres
2025-08-08 20:46:25,513 [INFO] [llm_interface.py] JSON parseado com sucesso: {'tool_name': 'get_top_selling_products_by_name', 'parameters': {'product_name': 'coca cola'}}
2025-08-08 20:46:25,513 [INFO] INTEN√á√ÉO PROCESSADA: {'tool_name': 'get_top_selling_products_by_name', 'parameters': {'product_name': 'coca cola'}}
2025-08-08 20:46:25,517 [INFO] Salvando sess√£o: {'customer_context': None, 'shopping_cart': [], 'last_search_type': 'by_name', 'last_search_params': {'product_name': 'coca cola'}, 'current_offset': 5, 'last_shown_products': [], 'last_bot_action': 'AWAITING_PRODUCT_SELECTION', 'pending_action': None, 'last_kb_search_term': None}
2025-08-08 20:46:25,528 [INFO] Enviando mensagem proativa para whatsapp:+5511940726493: 'ü§ñ Encontrei estes produtos relacionados a 'coca cola':
Nenhum produto encontrado com esse crit√©rio.'
2025-08-08 20:46:25,536 [INFO] -- BEGIN Twilio API Request --
2025-08-08 20:46:25,536 [INFO] POST Request: https://api.twilio.com/2010-04-01/Accounts/ACd2a6cd60871d661c034ecb40ddbd51e7/Messages.json
2025-08-08 20:46:25,536 [INFO] Headers:
2025-08-08 20:46:25,536 [INFO] Content-Type : application/x-www-form-urlencoded
2025-08-08 20:46:25,536 [INFO] Accept : application/json
2025-08-08 20:46:25,537 [INFO] User-Agent : twilio-python/9.7.0 (Linux x86_64) Python/3.9.23
2025-08-08 20:46:25,537 [INFO] X-Twilio-Client : python-9.7.0
2025-08-08 20:46:25,630 [INFO] Accept-Charset : utf-8
2025-08-08 20:46:25,631 [INFO] -- END Twilio API Request --
2025-08-08 20:46:25,855 [INFO] Response Status Code: 201
2025-08-08 20:46:25,855 [INFO] Response Headers: {'Content-Type': 'application/json;charset=utf-8', 'Content-Length': '899', 'Connection': 'keep-alive', 'Date': 'Fri, 08 Aug 2025 20:46:25 GMT', 'Twilio-Concurrent-Requests': '1', 'Twilio-Request-Id': 'RQ6f4a01342950f3b3bd6b89cda6eec085', 'Twilio-Request-Duration': '0.101', 'X-Home-Region': 'us1', 'X-API-Domain': 'api.twilio.com', 'Strict-Transport-Security': 'max-age=31536000', 'X-Cache': 'Miss from cloudfront', 'Via': '1.1 381ddca30a3b9978a6c84a246d0a25ce.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'GRU3-P4', 'X-Amz-Cf-Id': 'mMy3219zHiYbOlV7ynpuxgSHSBePtIi6yw2uZHIet-N8z3MbpSVKNg==', 'X-Powered-By': 'AT-5000', 'X-Shenanigans': 'none', 'Vary': 'Origin'}
2025-08-08 20:46:25,855 [INFO] THREAD: Processamento finalizado para 'Quero coca cola'
2025-08-08 20:46:36,752 [INFO] 172.18.0.1 - - [08/Aug/2025 20:46:36] "POST /webhook HTTP/1.1" 200 -
2025-08-08 20:46:36,758 [INFO] Arquivo de sess√£o encontrado. Carregando.
2025-08-08 20:46:36,760 [INFO] [llm_interface.py] Iniciando get_intent para mensagem: 'quero lata...'
2025-08-08 20:46:36,761 [INFO] [llm_interface.py] Tentando carregar prompt de: ai_llm/gav_prompt.txt
2025-08-08 20:46:36,762 [INFO] [llm_interface.py] Prompt carregado com sucesso. Tamanho: 2326 caracteres
2025-08-08 20:46:36,762 [INFO] [llm_interface.py] System prompt preparado. Tamanho: 2262 caracteres
2025-08-08 20:46:36,763 [INFO] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-08 20:46:36,776 [INFO] [llm_interface.py] Verificando disponibilidade do modelo: llama3.1
2025-08-08 20:46:36,782 [INFO] HTTP Request: GET http://host.docker.internal:11434/api/tags "HTTP/1.1 200 OK"
2025-08-08 20:46:36,783 [WARNING] [llm_interface.py] N√£o foi poss√≠vel verificar modelos dispon√≠veis: 'name'
2025-08-08 20:46:36,783 [INFO] [llm_interface.py] Enviando requisi√ß√£o para o modelo llama3.1
2025-08-08 20:46:37,681 [INFO] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-08 20:46:37,681 [INFO] [llm_interface.py] Resposta recebida do LLM. Tamanho: 89 caracteres
2025-08-08 20:46:37,682 [INFO] [llm_interface.py] JSON parseado com sucesso: {'tool_name': 'get_top_selling_products_by_name', 'parameters': {'product_name': 'lata'}}
2025-08-08 20:46:37,682 [INFO] INTEN√á√ÉO PROCESSADA: {'tool_name': 'get_top_selling_products_by_name', 'parameters': {'product_name': 'lata'}}
2025-08-08 20:46:37,687 [INFO] Salvando sess√£o: {'customer_context': None, 'shopping_cart': [], 'last_search_type': 'by_name', 'last_search_params': {'product_name': 'lata'}, 'current_offset': 5, 'last_shown_products': [], 'last_bot_action': 'AWAITING_PRODUCT_SELECTION', 'pending_action': None, 'last_kb_search_term': None}
2025-08-08 20:46:37,689 [INFO] Enviando mensagem proativa para whatsapp:+5511940726493: 'ü§ñ Encontrei estes produtos relacionados a 'lata':
Nenhum produto encontrado com esse crit√©rio.'
2025-08-08 20:46:37,690 [INFO] -- BEGIN Twilio API Request --
2025-08-08 20:46:37,690 [INFO] POST Request: https://api.twilio.com/2010-04-01/Accounts/ACd2a6cd60871d661c034ecb40ddbd51e7/Messages.json
2025-08-08 20:46:37,690 [INFO] Headers:
2025-08-08 20:46:37,690 [INFO] Content-Type : application/x-www-form-urlencoded
2025-08-08 20:46:37,690 [INFO] Accept : application/json
2025-08-08 20:46:37,691 [INFO] User-Agent : twilio-python/9.7.0 (Linux x86_64) Python/3.9.23
2025-08-08 20:46:37,691 [INFO] X-Twilio-Client : python-9.7.0
2025-08-08 20:46:37,691 [INFO] Accept-Charset : utf-8
2025-08-08 20:46:37,691 [INFO] -- END Twilio API Request --
2025-08-08 20:46:37,938 [INFO] Response Status Code: 201
2025-08-08 20:46:37,939 [INFO] Response Headers: {'Content-Type': 'application/json;charset=utf-8', 'Content-Length': '894', 'Connection': 'keep-alive', 'Date': 'Fri, 08 Aug 2025 20:46:37 GMT', 'Twilio-Concurrent-Requests': '1', 'Twilio-Request-Id': 'RQ0d6c3da6b6aa61976ff9f22bb9110d1b', 'Twilio-Request-Duration': '0.124', 'X-Home-Region': 'us1', 'X-API-Domain': 'api.twilio.com', 'Strict-Transport-Security': 'max-age=31536000', 'X-Cache': 'Miss from cloudfront', 'Via': '1.1 381ddca30a3b9978a6c84a246d0a25ce.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'GRU3-P4', 'X-Amz-Cf-Id': '8cI6EacLc1cH_hJQHT6G3Z2dnO8Vw06Gz1bla-yYPvLzKdHChuP9Ww==', 'X-Powered-By': 'AT-5000', 'X-Shenanigans': 'none', 'Vary': 'Origin'}
2025-08-08 20:46:37,939 [INFO] THREAD: Processamento finalizado para 'quero lata'
2025-08-08 20:46:45,915 [INFO] 172.18.0.1 - - [08/Aug/2025 20:46:45] "POST /webhook HTTP/1.1" 200 -
2025-08-08 20:46:45,916 [INFO] Arquivo de sess√£o encontrado. Carregando.
2025-08-08 20:46:45,921 [INFO] [llm_interface.py] Iniciando get_intent para mensagem: 'produto coca cola...'
2025-08-08 20:46:45,922 [INFO] [llm_interface.py] Tentando carregar prompt de: ai_llm/gav_prompt.txt
2025-08-08 20:46:45,924 [INFO] [llm_interface.py] Prompt carregado com sucesso. Tamanho: 2326 caracteres
2025-08-08 20:46:45,924 [INFO] [llm_interface.py] System prompt preparado. Tamanho: 2262 caracteres
2025-08-08 20:46:45,924 [INFO] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-08 20:46:45,940 [INFO] [llm_interface.py] Verificando disponibilidade do modelo: llama3.1
2025-08-08 20:46:45,947 [INFO] HTTP Request: GET http://host.docker.internal:11434/api/tags "HTTP/1.1 200 OK"
2025-08-08 20:46:45,948 [WARNING] [llm_interface.py] N√£o foi poss√≠vel verificar modelos dispon√≠veis: 'name'
2025-08-08 20:46:45,948 [INFO] [llm_interface.py] Enviando requisi√ß√£o para o modelo llama3.1
2025-08-08 20:46:46,899 [INFO] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-08 20:46:46,900 [INFO] [llm_interface.py] Resposta recebida do LLM. Tamanho: 94 caracteres
2025-08-08 20:46:46,900 [INFO] [llm_interface.py] JSON parseado com sucesso: {'tool_name': 'get_top_selling_products_by_name', 'parameters': {'product_name': 'coca cola'}}
2025-08-08 20:46:46,900 [INFO] INTEN√á√ÉO PROCESSADA: {'tool_name': 'get_top_selling_products_by_name', 'parameters': {'product_name': 'coca cola'}}
2025-08-08 20:46:46,904 [INFO] Salvando sess√£o: {'customer_context': None, 'shopping_cart': [], 'last_search_type': 'by_name', 'last_search_params': {'product_name': 'coca cola'}, 'current_offset': 5, 'last_shown_products': [], 'last_bot_action': 'AWAITING_PRODUCT_SELECTION', 'pending_action': None, 'last_kb_search_term': None}
2025-08-08 20:46:46,906 [INFO] Enviando mensagem proativa para whatsapp:+5511940726493: 'ü§ñ Encontrei estes produtos relacionados a 'coca cola':
Nenhum produto encontrado com esse crit√©rio.'
2025-08-08 20:46:46,906 [INFO] -- BEGIN Twilio API Request --
2025-08-08 20:46:46,906 [INFO] POST Request: https://api.twilio.com/2010-04-01/Accounts/ACd2a6cd60871d661c034ecb40ddbd51e7/Messages.json
2025-08-08 20:46:46,907 [INFO] Headers:
2025-08-08 20:46:46,907 [INFO] Content-Type : application/x-www-form-urlencoded
2025-08-08 20:46:46,907 [INFO] Accept : application/json
2025-08-08 20:46:46,907 [INFO] User-Agent : twilio-python/9.7.0 (Linux x86_64) Python/3.9.23
2025-08-08 20:46:46,908 [INFO] X-Twilio-Client : python-9.7.0
2025-08-08 20:46:46,909 [INFO] Accept-Charset : utf-8
2025-08-08 20:46:46,909 [INFO] -- END Twilio API Request --
2025-08-08 20:46:47,130 [INFO] Response Status Code: 201
2025-08-08 20:46:47,130 [INFO] Response Headers: {'Content-Type': 'application/json;charset=utf-8', 'Content-Length': '899', 'Connection': 'keep-alive', 'Date': 'Fri, 08 Aug 2025 20:46:47 GMT', 'Twilio-Concurrent-Requests': '1', 'Twilio-Request-Id': 'RQ5e432e7ddf80c45abe4abe877515dfa2', 'Twilio-Request-Duration': '0.097', 'X-Home-Region': 'us1', 'X-API-Domain': 'api.twilio.com', 'Strict-Transport-Security': 'max-age=31536000', 'X-Cache': 'Miss from cloudfront', 'Via': '1.1 381ddca30a3b9978a6c84a246d0a25ce.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'GRU3-P4', 'X-Amz-Cf-Id': 'BSlJWpq0OtKxvcrqhPzncwHruokpKVEETI363qmVmUYl-bTG4fQ26g==', 'X-Powered-By': 'AT-5000', 'X-Shenanigans': 'none', 'Vary': 'Origin'}
2025-08-08 20:46:47,130 [INFO] THREAD: Processamento finalizado para 'produto coca cola'
2025-08-09 13:34:21,560 [INFO] [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8080
 * Running on http://172.18.0.3:8080
2025-08-09 13:34:21,560 [INFO] [33mPress CTRL+C to quit[0m
2025-08-09 13:34:21,561 [INFO]  * Restarting with stat
2025-08-09 13:34:22,197 [WARNING]  * Debugger is active!
2025-08-09 13:34:22,198 [INFO]  * Debugger PIN: 503-272-662
2025-08-09 13:34:36,785 [INFO] 172.18.0.1 - - [09/Aug/2025 13:34:36] "[33mPOST / HTTP/1.1[0m" 404 -
2025-08-09 13:35:16,935 [INFO] 172.18.0.1 - - [09/Aug/2025 13:35:16] "POST /webhook HTTP/1.1" 200 -
2025-08-09 13:35:16,937 [INFO] Arquivo de sess√£o encontrado. Carregando.
2025-08-09 13:35:16,939 [INFO] [llm_interface.py] Iniciando get_intent para mensagem: 'oi...'
2025-08-09 13:35:16,939 [INFO] [llm_interface.py] Tentando carregar prompt de: ai_llm/gav_prompt.txt
2025-08-09 13:35:16,941 [INFO] [llm_interface.py] Prompt carregado com sucesso. Tamanho: 2326 caracteres
2025-08-09 13:35:16,941 [INFO] [llm_interface.py] System prompt preparado. Tamanho: 2262 caracteres
2025-08-09 13:35:16,941 [INFO] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-09 13:35:16,955 [INFO] [llm_interface.py] Verificando disponibilidade do modelo: llama3.1
2025-08-09 13:35:16,968 [INFO] HTTP Request: GET http://host.docker.internal:11434/api/tags "HTTP/1.1 200 OK"
2025-08-09 13:35:16,970 [WARNING] [llm_interface.py] N√£o foi poss√≠vel verificar modelos dispon√≠veis: 'name'
2025-08-09 13:35:16,972 [INFO] [llm_interface.py] Enviando requisi√ß√£o para o modelo llama3.1
2025-08-09 13:35:23,682 [INFO] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-09 13:35:23,683 [INFO] [llm_interface.py] Resposta recebida do LLM. Tamanho: 257 caracteres
2025-08-09 13:35:23,683 [INFO] [llm_interface.py] JSON parseado com sucesso: {'tool_name': 'handle_chitchat', 'parameters': {'response_text': 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'}}
2025-08-09 13:35:23,683 [INFO] INTEN√á√ÉO PROCESSADA: {'tool_name': 'handle_chitchat', 'parameters': {'response_text': 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'}}
2025-08-09 13:35:23,683 [INFO] Salvando sess√£o: {'customer_context': None, 'shopping_cart': [], 'last_search_type': 'by_name', 'last_search_params': {'product_name': 'coca cola'}, 'current_offset': 5, 'last_shown_products': [], 'last_bot_action': 'AWAITING_PRODUCT_SELECTION', 'pending_action': None, 'last_kb_search_term': None}
2025-08-09 13:35:23,685 [INFO] Enviando mensagem proativa para whatsapp:+5511940726493: 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'
2025-08-09 13:35:23,724 [INFO] -- BEGIN Twilio API Request --
2025-08-09 13:35:23,724 [INFO] POST Request: https://api.twilio.com/2010-04-01/Accounts/ACd2a6cd60871d661c034ecb40ddbd51e7/Messages.json
2025-08-09 13:35:23,724 [INFO] Headers:
2025-08-09 13:35:23,724 [INFO] Content-Type : application/x-www-form-urlencoded
2025-08-09 13:35:23,725 [INFO] Accept : application/json
2025-08-09 13:35:23,725 [INFO] User-Agent : twilio-python/9.7.0 (Linux x86_64) Python/3.9.23
2025-08-09 13:35:23,725 [INFO] X-Twilio-Client : python-9.7.0
2025-08-09 13:35:23,725 [INFO] Accept-Charset : utf-8
2025-08-09 13:35:23,725 [INFO] -- END Twilio API Request --
2025-08-09 13:35:23,930 [INFO] Response Status Code: 429
2025-08-09 13:35:23,931 [INFO] Response Headers: {'Content-Type': 'application/json', 'Content-Length': '173', 'Connection': 'keep-alive', 'Date': 'Sat, 09 Aug 2025 13:35:23 GMT', 'X-Twilio-Error-Code': '63038', 'Twilio-Concurrent-Requests': '1', 'Twilio-Request-Id': 'RQed510e4952557f601c8ffbd6bc56e8c0', 'Twilio-Request-Duration': '0.062', 'X-Home-Region': 'us1', 'X-API-Domain': 'api.twilio.com', 'Strict-Transport-Security': 'max-age=31536000', 'X-Cache': 'Error from cloudfront', 'Via': '1.1 d25a1132f04e5b0e596d295b437a27be.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'GRU3-P4', 'X-Amz-Cf-Id': 'o6A7CehVz3-K5C6PpXhh73bjAMyJugs4mtLLBvccoRV0A4RFpHcPhA==', 'X-Powered-By': 'AT-5000', 'X-Shenanigans': 'none', 'Vary': 'Origin'}
2025-08-09 13:35:23,932 [ERROR] Falha ao enviar mensagem via API da Twilio: HTTP 429 error: Unable to create record: Account ACd2a6cd60871d661c034ecb40ddbd51e7 exceeded the 9 daily messages limit
2025-08-09 13:35:23,932 [INFO] THREAD: Processamento finalizado para 'oi'
2025-08-09 13:35:48,014 [INFO] 172.18.0.1 - - [09/Aug/2025 13:35:48] "POST /webhook HTTP/1.1" 200 -
2025-08-09 13:35:48,017 [INFO] Arquivo de sess√£o encontrado. Carregando.
2025-08-09 13:35:48,019 [INFO] [llm_interface.py] Iniciando get_intent para mensagem: 'oi...'
2025-08-09 13:35:48,019 [INFO] [llm_interface.py] Tentando carregar prompt de: ai_llm/gav_prompt.txt
2025-08-09 13:35:48,021 [INFO] [llm_interface.py] Prompt carregado com sucesso. Tamanho: 2326 caracteres
2025-08-09 13:35:48,021 [INFO] [llm_interface.py] System prompt preparado. Tamanho: 2262 caracteres
2025-08-09 13:35:48,021 [INFO] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-09 13:35:48,035 [INFO] [llm_interface.py] Verificando disponibilidade do modelo: llama3.1
2025-08-09 13:35:48,041 [INFO] HTTP Request: GET http://host.docker.internal:11434/api/tags "HTTP/1.1 200 OK"
2025-08-09 13:35:48,042 [WARNING] [llm_interface.py] N√£o foi poss√≠vel verificar modelos dispon√≠veis: 'name'
2025-08-09 13:35:48,042 [INFO] [llm_interface.py] Enviando requisi√ß√£o para o modelo llama3.1
2025-08-09 13:35:50,007 [INFO] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-09 13:35:50,008 [INFO] [llm_interface.py] Resposta recebida do LLM. Tamanho: 262 caracteres
2025-08-09 13:35:50,008 [INFO] [llm_interface.py] JSON parseado com sucesso: {'tool_name': 'handle_chitchat', 'parameters': {'response_text': 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'}}
2025-08-09 13:35:50,008 [INFO] INTEN√á√ÉO PROCESSADA: {'tool_name': 'handle_chitchat', 'parameters': {'response_text': 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'}}
2025-08-09 13:35:50,008 [INFO] Salvando sess√£o: {'customer_context': None, 'shopping_cart': [], 'last_search_type': 'by_name', 'last_search_params': {'product_name': 'coca cola'}, 'current_offset': 5, 'last_shown_products': [], 'last_bot_action': 'AWAITING_PRODUCT_SELECTION', 'pending_action': None, 'last_kb_search_term': None}
2025-08-09 13:35:50,011 [INFO] Enviando mensagem proativa para whatsapp:+5511940726493: 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'
2025-08-09 13:35:50,011 [INFO] -- BEGIN Twilio API Request --
2025-08-09 13:35:50,011 [INFO] POST Request: https://api.twilio.com/2010-04-01/Accounts/ACd2a6cd60871d661c034ecb40ddbd51e7/Messages.json
2025-08-09 13:35:50,011 [INFO] Headers:
2025-08-09 13:35:50,012 [INFO] Content-Type : application/x-www-form-urlencoded
2025-08-09 13:35:50,012 [INFO] Accept : application/json
2025-08-09 13:35:50,012 [INFO] User-Agent : twilio-python/9.7.0 (Linux x86_64) Python/3.9.23
2025-08-09 13:35:50,012 [INFO] X-Twilio-Client : python-9.7.0
2025-08-09 13:35:50,012 [INFO] Accept-Charset : utf-8
2025-08-09 13:35:50,012 [INFO] -- END Twilio API Request --
2025-08-09 13:35:50,228 [INFO] Response Status Code: 201
2025-08-09 13:35:50,229 [INFO] Response Headers: {'Content-Type': 'application/json;charset=utf-8', 'Content-Length': '991', 'Connection': 'keep-alive', 'Date': 'Sat, 09 Aug 2025 13:35:50 GMT', 'Twilio-Concurrent-Requests': '1', 'Twilio-Request-Id': 'RQ878a0357feada2c88f59f9bfca8d1554', 'Twilio-Request-Duration': '0.090', 'X-Home-Region': 'us1', 'X-API-Domain': 'api.twilio.com', 'Strict-Transport-Security': 'max-age=31536000', 'X-Cache': 'Miss from cloudfront', 'Via': '1.1 d25a1132f04e5b0e596d295b437a27be.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'GRU3-P4', 'X-Amz-Cf-Id': 'Nag_7FPelqjz7H5hNRNc8VrwzPfpVpZbc-Q-9REiOiILCI2hPtCOVA==', 'X-Powered-By': 'AT-5000', 'X-Shenanigans': 'none', 'Vary': 'Origin'}
2025-08-09 13:35:50,230 [INFO] THREAD: Processamento finalizado para 'oi'
2025-08-09 13:36:04,943 [INFO] 172.18.0.1 - - [09/Aug/2025 13:36:04] "POST /webhook HTTP/1.1" 200 -
2025-08-09 13:36:04,948 [INFO] Arquivo de sess√£o encontrado. Carregando.
2025-08-09 13:36:04,950 [INFO] [llm_interface.py] Iniciando get_intent para mensagem: 'quero ver os pre√ßos da coca cola...'
2025-08-09 13:36:04,950 [INFO] [llm_interface.py] Tentando carregar prompt de: ai_llm/gav_prompt.txt
2025-08-09 13:36:04,953 [INFO] [llm_interface.py] Prompt carregado com sucesso. Tamanho: 2326 caracteres
2025-08-09 13:36:04,953 [INFO] [llm_interface.py] System prompt preparado. Tamanho: 2262 caracteres
2025-08-09 13:36:04,953 [INFO] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-09 13:36:04,970 [INFO] [llm_interface.py] Verificando disponibilidade do modelo: llama3.1
2025-08-09 13:36:04,976 [INFO] HTTP Request: GET http://host.docker.internal:11434/api/tags "HTTP/1.1 200 OK"
2025-08-09 13:36:04,977 [WARNING] [llm_interface.py] N√£o foi poss√≠vel verificar modelos dispon√≠veis: 'name'
2025-08-09 13:36:04,977 [INFO] [llm_interface.py] Enviando requisi√ß√£o para o modelo llama3.1
2025-08-09 13:36:05,986 [INFO] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-09 13:36:05,991 [INFO] [llm_interface.py] Resposta recebida do LLM. Tamanho: 94 caracteres
2025-08-09 13:36:05,993 [INFO] [llm_interface.py] JSON parseado com sucesso: {'tool_name': 'get_top_selling_products_by_name', 'parameters': {'product_name': 'Coca Cola'}}
2025-08-09 13:36:05,993 [INFO] INTEN√á√ÉO PROCESSADA: {'tool_name': 'get_top_selling_products_by_name', 'parameters': {'product_name': 'Coca Cola'}}
2025-08-09 13:36:05,997 [INFO] Base de conhecimento '/app/knowledge/knowledge_base.json' carregada com 3 produtos e 57 termos.
2025-08-09 13:36:06,008 [INFO] Salvando sess√£o: {'customer_context': None, 'shopping_cart': [], 'last_search_type': 'by_name', 'last_search_params': {'product_name': 'coca cola'}, 'current_offset': 5, 'last_shown_products': [{'codprod': 13700, 'descricao': 'REFRIG.COCA-COLA PET 2L', 'pvenda': 8.5}], 'last_bot_action': 'AWAITING_PRODUCT_SELECTION', 'pending_action': None, 'last_kb_search_term': 'Coca Cola'}
2025-08-09 13:36:06,011 [INFO] Enviando mensagem proativa para whatsapp:+5511940726493: 'ü§ñ Encontrei isto para 'Coca Cola' (busca r√°pida):
1. REFRIG.COCA-COLA PET 2L - R$ 8,50
Me diga o nome ou o n√∫mero do item que deseja adicionar.
'
2025-08-09 13:36:06,011 [INFO] -- BEGIN Twilio API Request --
2025-08-09 13:36:06,011 [INFO] POST Request: https://api.twilio.com/2010-04-01/Accounts/ACd2a6cd60871d661c034ecb40ddbd51e7/Messages.json
2025-08-09 13:36:06,012 [INFO] Headers:
2025-08-09 13:36:06,012 [INFO] Content-Type : application/x-www-form-urlencoded
2025-08-09 13:36:06,012 [INFO] Accept : application/json
2025-08-09 13:36:06,012 [INFO] User-Agent : twilio-python/9.7.0 (Linux x86_64) Python/3.9.23
2025-08-09 13:36:06,012 [INFO] X-Twilio-Client : python-9.7.0
2025-08-09 13:36:06,012 [INFO] Accept-Charset : utf-8
2025-08-09 13:36:06,012 [INFO] -- END Twilio API Request --
2025-08-09 13:36:06,393 [INFO] Response Status Code: 201
2025-08-09 13:36:06,393 [INFO] Response Headers: {'Content-Type': 'application/json;charset=utf-8', 'Content-Length': '951', 'Connection': 'keep-alive', 'Date': 'Sat, 09 Aug 2025 13:36:06 GMT', 'Twilio-Concurrent-Requests': '1', 'Twilio-Request-Id': 'RQfea94e251c44d64a684475598bdf3690', 'Twilio-Request-Duration': '0.099', 'X-Home-Region': 'us1', 'X-API-Domain': 'api.twilio.com', 'Strict-Transport-Security': 'max-age=31536000', 'X-Cache': 'Miss from cloudfront', 'Via': '1.1 d25a1132f04e5b0e596d295b437a27be.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'GRU3-P4', 'X-Amz-Cf-Id': 'r7f4sWMmBI-EUGh97ccu-PvTmHa8aB0dHXEX5akD8Or90E-FTRXIOw==', 'X-Powered-By': 'AT-5000', 'X-Shenanigans': 'none', 'Vary': 'Origin'}
2025-08-09 13:36:06,393 [INFO] THREAD: Processamento finalizado para 'quero ver os pre√ßos da coca cola'
2025-08-09 13:39:17,350 [INFO]  * Detected change in '/app/communication/twilio_client.py', reloading
2025-08-09 13:39:17,390 [INFO]  * Restarting with stat
2025-08-09 13:39:18,146 [WARNING]  * Debugger is active!
2025-08-09 13:39:18,148 [INFO]  * Debugger PIN: 503-272-662
2025-08-09 13:39:21,368 [INFO]  * Detected change in '/app/communication/twilio_client.py', reloading
2025-08-09 13:39:21,402 [INFO]  * Restarting with stat
2025-08-09 13:39:22,069 [WARNING]  * Debugger is active!
2025-08-09 13:39:22,070 [INFO]  * Debugger PIN: 503-272-662
2025-08-09 13:40:37,705 [INFO] 172.18.0.1 - - [09/Aug/2025 13:40:37] "POST /webhook HTTP/1.1" 200 -
2025-08-09 13:40:37,706 [INFO] Arquivo de sess√£o encontrado. Carregando.
2025-08-09 13:40:37,708 [INFO] [llm_interface.py] Iniciando get_intent para mensagem: 'Oi...'
2025-08-09 13:40:37,708 [INFO] [llm_interface.py] Tentando carregar prompt de: ai_llm/gav_prompt.txt
2025-08-09 13:40:37,710 [INFO] [llm_interface.py] Prompt carregado com sucesso. Tamanho: 2326 caracteres
2025-08-09 13:40:37,710 [INFO] [llm_interface.py] System prompt preparado. Tamanho: 2262 caracteres
2025-08-09 13:40:37,710 [INFO] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-09 13:40:37,725 [INFO] [llm_interface.py] Verificando disponibilidade do modelo: llama3.1
2025-08-09 13:40:37,736 [INFO] HTTP Request: GET http://host.docker.internal:11434/api/tags "HTTP/1.1 200 OK"
2025-08-09 13:40:37,742 [WARNING] [llm_interface.py] N√£o foi poss√≠vel verificar modelos dispon√≠veis: 'name'
2025-08-09 13:40:37,743 [INFO] [llm_interface.py] Enviando requisi√ß√£o para o modelo llama3.1
2025-08-09 13:40:39,889 [INFO] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-09 13:40:39,889 [INFO] [llm_interface.py] Resposta recebida do LLM. Tamanho: 272 caracteres
2025-08-09 13:40:39,889 [INFO] [llm_interface.py] JSON parseado com sucesso: {'tool_name': 'handle_chitchat', 'parameters': {'response_text': 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'}}
2025-08-09 13:40:39,889 [INFO] INTEN√á√ÉO PROCESSADA: {'tool_name': 'handle_chitchat', 'parameters': {'response_text': 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'}}
2025-08-09 13:40:39,890 [INFO] Salvando sess√£o: {'customer_context': None, 'shopping_cart': [], 'last_search_type': 'by_name', 'last_search_params': {'product_name': 'coca cola'}, 'current_offset': 5, 'last_shown_products': [{'codprod': 13700, 'descricao': 'REFRIG.COCA-COLA PET 2L', 'pvenda': 8.5}], 'last_bot_action': 'AWAITING_PRODUCT_SELECTION', 'pending_action': None, 'last_kb_search_term': 'Coca Cola'}
2025-08-09 13:40:39,891 [INFO] Enviando mensagem proativa para whatsapp:+5511940726493: 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'
2025-08-09 13:40:39,914 [INFO] -- BEGIN Twilio API Request --
2025-08-09 13:40:39,915 [INFO] POST Request: https://api.twilio.com/2010-04-01/Accounts/ACd2a6cd60871d661c034ecb40ddbd51e7/Messages.json
2025-08-09 13:40:39,915 [INFO] Headers:
2025-08-09 13:40:39,915 [INFO] Content-Type : application/x-www-form-urlencoded
2025-08-09 13:40:39,916 [INFO] Accept : application/json
2025-08-09 13:40:39,916 [INFO] User-Agent : twilio-python/9.7.0 (Linux x86_64) Python/3.9.23
2025-08-09 13:40:39,916 [INFO] X-Twilio-Client : python-9.7.0
2025-08-09 13:40:39,916 [INFO] Accept-Charset : utf-8
2025-08-09 13:40:39,916 [INFO] -- END Twilio API Request --
2025-08-09 13:40:40,179 [INFO] Response Status Code: 201
2025-08-09 13:40:40,180 [INFO] Response Headers: {'Content-Type': 'application/json;charset=utf-8', 'Content-Length': '991', 'Connection': 'keep-alive', 'Date': 'Sat, 09 Aug 2025 13:40:40 GMT', 'Twilio-Concurrent-Requests': '1', 'Twilio-Request-Id': 'RQ541f16b647863d83205c87de56817f5d', 'Twilio-Request-Duration': '0.112', 'X-Home-Region': 'us1', 'X-API-Domain': 'api.twilio.com', 'Strict-Transport-Security': 'max-age=31536000', 'X-Cache': 'Miss from cloudfront', 'Via': '1.1 7119806636bd0f14f27aecbecb3f0b02.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'GRU3-P4', 'X-Amz-Cf-Id': 'Hv1V_rN51ROIHKqBbuzpBo_eOBDFfwfzFhk1qVrcGvCY8_vOfdEkGQ==', 'X-Powered-By': 'AT-5000', 'X-Shenanigans': 'none', 'Vary': 'Origin'}
2025-08-09 13:40:40,181 [INFO] THREAD: Processamento finalizado para 'Oi'
2025-08-09 13:41:11,585 [INFO] 172.18.0.1 - - [09/Aug/2025 13:41:11] "POST /webhook HTTP/1.1" 200 -
2025-08-09 13:41:11,587 [INFO] Arquivo de sess√£o encontrado. Carregando.
2025-08-09 13:41:11,588 [INFO] [llm_interface.py] Iniciando get_intent para mensagem: 'Oi...'
2025-08-09 13:41:11,589 [INFO] [llm_interface.py] Tentando carregar prompt de: ai_llm/gav_prompt.txt
2025-08-09 13:41:11,590 [INFO] [llm_interface.py] Prompt carregado com sucesso. Tamanho: 2326 caracteres
2025-08-09 13:41:11,591 [INFO] [llm_interface.py] System prompt preparado. Tamanho: 2262 caracteres
2025-08-09 13:41:11,591 [INFO] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-09 13:41:11,607 [INFO] [llm_interface.py] Verificando disponibilidade do modelo: llama3.1
2025-08-09 13:41:11,613 [INFO] HTTP Request: GET http://host.docker.internal:11434/api/tags "HTTP/1.1 200 OK"
2025-08-09 13:41:11,613 [WARNING] [llm_interface.py] N√£o foi poss√≠vel verificar modelos dispon√≠veis: 'name'
2025-08-09 13:41:11,614 [INFO] [llm_interface.py] Enviando requisi√ß√£o para o modelo llama3.1
2025-08-09 13:41:13,611 [INFO] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-09 13:41:13,612 [INFO] [llm_interface.py] Resposta recebida do LLM. Tamanho: 267 caracteres
2025-08-09 13:41:13,612 [INFO] [llm_interface.py] JSON parseado com sucesso: {'tool_name': 'handle_chitchat', 'parameters': {'response_text': 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'}}
2025-08-09 13:41:13,612 [INFO] INTEN√á√ÉO PROCESSADA: {'tool_name': 'handle_chitchat', 'parameters': {'response_text': 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'}}
2025-08-09 13:41:13,612 [INFO] Salvando sess√£o: {'customer_context': None, 'shopping_cart': [], 'last_search_type': 'by_name', 'last_search_params': {'product_name': 'coca cola'}, 'current_offset': 5, 'last_shown_products': [{'codprod': 13700, 'descricao': 'REFRIG.COCA-COLA PET 2L', 'pvenda': 8.5}], 'last_bot_action': 'AWAITING_PRODUCT_SELECTION', 'pending_action': None, 'last_kb_search_term': 'Coca Cola'}
2025-08-09 13:41:13,615 [INFO] Enviando mensagem proativa para whatsapp:+5511940726493: 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'
2025-08-09 13:41:13,615 [INFO] -- BEGIN Twilio API Request --
2025-08-09 13:41:13,615 [INFO] POST Request: https://api.twilio.com/2010-04-01/Accounts/ACd2a6cd60871d661c034ecb40ddbd51e7/Messages.json
2025-08-09 13:41:13,616 [INFO] Headers:
2025-08-09 13:41:13,616 [INFO] Content-Type : application/x-www-form-urlencoded
2025-08-09 13:41:13,616 [INFO] Accept : application/json
2025-08-09 13:41:13,616 [INFO] User-Agent : twilio-python/9.7.0 (Linux x86_64) Python/3.9.23
2025-08-09 13:41:13,616 [INFO] X-Twilio-Client : python-9.7.0
2025-08-09 13:41:13,616 [INFO] Accept-Charset : utf-8
2025-08-09 13:41:13,616 [INFO] -- END Twilio API Request --
2025-08-09 13:41:13,826 [INFO] Response Status Code: 201
2025-08-09 13:41:13,827 [INFO] Response Headers: {'Content-Type': 'application/json;charset=utf-8', 'Content-Length': '991', 'Connection': 'keep-alive', 'Date': 'Sat, 09 Aug 2025 13:41:13 GMT', 'Twilio-Concurrent-Requests': '1', 'Twilio-Request-Id': 'RQa78dde4676ec707391c3ee7605284c93', 'Twilio-Request-Duration': '0.088', 'X-Home-Region': 'us1', 'X-API-Domain': 'api.twilio.com', 'Strict-Transport-Security': 'max-age=31536000', 'X-Cache': 'Miss from cloudfront', 'Via': '1.1 7119806636bd0f14f27aecbecb3f0b02.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'GRU3-P4', 'X-Amz-Cf-Id': 'BsH0HNYJzBpUXAVKLu4saUo0tdOS2W2OukeilMwhQUdY6Ho_3W7HHQ==', 'X-Powered-By': 'AT-5000', 'X-Shenanigans': 'none', 'Vary': 'Origin'}
2025-08-09 13:41:13,827 [INFO] THREAD: Processamento finalizado para 'Oi'
2025-08-09 13:41:20,336 [INFO] 172.18.0.1 - - [09/Aug/2025 13:41:20] "POST /webhook HTTP/1.1" 200 -
2025-08-09 13:41:20,340 [INFO] Arquivo de sess√£o encontrado. Carregando.
2025-08-09 13:41:20,341 [INFO] [llm_interface.py] Iniciando get_intent para mensagem: 'oi...'
2025-08-09 13:41:20,342 [INFO] [llm_interface.py] Tentando carregar prompt de: ai_llm/gav_prompt.txt
2025-08-09 13:41:20,344 [INFO] [llm_interface.py] Prompt carregado com sucesso. Tamanho: 2326 caracteres
2025-08-09 13:41:20,344 [INFO] [llm_interface.py] System prompt preparado. Tamanho: 2262 caracteres
2025-08-09 13:41:20,344 [INFO] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-09 13:41:20,362 [INFO] [llm_interface.py] Verificando disponibilidade do modelo: llama3.1
2025-08-09 13:41:20,367 [INFO] HTTP Request: GET http://host.docker.internal:11434/api/tags "HTTP/1.1 200 OK"
2025-08-09 13:41:20,368 [WARNING] [llm_interface.py] N√£o foi poss√≠vel verificar modelos dispon√≠veis: 'name'
2025-08-09 13:41:20,368 [INFO] [llm_interface.py] Enviando requisi√ß√£o para o modelo llama3.1
2025-08-09 13:41:22,535 [INFO] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-09 13:41:22,536 [INFO] [llm_interface.py] Resposta recebida do LLM. Tamanho: 277 caracteres
2025-08-09 13:41:22,536 [INFO] [llm_interface.py] JSON parseado com sucesso: {'tool_name': 'handle_chitchat', 'parameters': {'response_text': 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'}}
2025-08-09 13:41:22,536 [INFO] INTEN√á√ÉO PROCESSADA: {'tool_name': 'handle_chitchat', 'parameters': {'response_text': 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'}}
2025-08-09 13:41:22,537 [INFO] Salvando sess√£o: {'customer_context': None, 'shopping_cart': [], 'last_search_type': 'by_name', 'last_search_params': {'product_name': 'coca cola'}, 'current_offset': 5, 'last_shown_products': [{'codprod': 13700, 'descricao': 'REFRIG.COCA-COLA PET 2L', 'pvenda': 8.5}], 'last_bot_action': 'AWAITING_PRODUCT_SELECTION', 'pending_action': None, 'last_kb_search_term': 'Coca Cola'}
2025-08-09 13:41:22,539 [INFO] Enviando mensagem proativa para whatsapp:+5511940726493: 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'
2025-08-09 13:41:22,539 [INFO] -- BEGIN Twilio API Request --
2025-08-09 13:41:22,539 [INFO] POST Request: https://api.twilio.com/2010-04-01/Accounts/ACd2a6cd60871d661c034ecb40ddbd51e7/Messages.json
2025-08-09 13:41:22,539 [INFO] Headers:
2025-08-09 13:41:22,540 [INFO] Content-Type : application/x-www-form-urlencoded
2025-08-09 13:41:22,540 [INFO] Accept : application/json
2025-08-09 13:41:22,540 [INFO] User-Agent : twilio-python/9.7.0 (Linux x86_64) Python/3.9.23
2025-08-09 13:41:22,540 [INFO] X-Twilio-Client : python-9.7.0
2025-08-09 13:41:22,540 [INFO] Accept-Charset : utf-8
2025-08-09 13:41:22,540 [INFO] -- END Twilio API Request --
2025-08-09 13:41:22,695 [INFO] Response Status Code: 429
2025-08-09 13:41:22,696 [INFO] Response Headers: {'Content-Type': 'application/json', 'Content-Length': '173', 'Connection': 'keep-alive', 'Date': 'Sat, 09 Aug 2025 13:41:22 GMT', 'X-Twilio-Error-Code': '63038', 'Twilio-Concurrent-Requests': '1', 'Twilio-Request-Id': 'RQ1e291537bdb212246ec01946bafd3625', 'Twilio-Request-Duration': '0.034', 'X-Home-Region': 'us1', 'X-API-Domain': 'api.twilio.com', 'Strict-Transport-Security': 'max-age=31536000', 'X-Cache': 'Error from cloudfront', 'Via': '1.1 7119806636bd0f14f27aecbecb3f0b02.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'GRU3-P4', 'X-Amz-Cf-Id': '-6g7bcWFxg0-P4O8kq5hol9QFJqlTnQwyh9ePbdoATOA8FV0c-JR_g==', 'X-Powered-By': 'AT-5000', 'X-Shenanigans': 'none', 'Vary': 'Origin'}
2025-08-09 13:41:22,696 [ERROR] Falha ao enviar mensagem via API da Twilio: HTTP 429 error: Unable to create record: Account ACd2a6cd60871d661c034ecb40ddbd51e7 exceeded the 9 daily messages limit
2025-08-09 13:41:22,696 [INFO] THREAD: Processamento finalizado para 'oi'
2025-08-09 13:42:05,416 [INFO] [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8080
 * Running on http://172.18.0.3:8080
2025-08-09 13:42:05,417 [INFO] [33mPress CTRL+C to quit[0m
2025-08-09 13:42:05,418 [INFO]  * Restarting with stat
2025-08-09 13:42:06,069 [WARNING]  * Debugger is active!
2025-08-09 13:42:06,070 [INFO]  * Debugger PIN: 278-656-101
2025-08-09 13:42:37,708 [INFO] 172.18.0.1 - - [09/Aug/2025 13:42:37] "POST /webhook HTTP/1.1" 200 -
2025-08-09 13:42:37,709 [INFO] Arquivo de sess√£o encontrado. Carregando.
2025-08-09 13:42:37,711 [INFO] [llm_interface.py] Iniciando get_intent para mensagem: 'oi...'
2025-08-09 13:42:37,711 [INFO] [llm_interface.py] Tentando carregar prompt de: ai_llm/gav_prompt.txt
2025-08-09 13:42:37,713 [INFO] [llm_interface.py] Prompt carregado com sucesso. Tamanho: 2326 caracteres
2025-08-09 13:42:37,714 [INFO] [llm_interface.py] System prompt preparado. Tamanho: 2262 caracteres
2025-08-09 13:42:37,714 [INFO] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-09 13:42:37,729 [INFO] [llm_interface.py] Verificando disponibilidade do modelo: llama3.1
2025-08-09 13:42:37,736 [INFO] HTTP Request: GET http://host.docker.internal:11434/api/tags "HTTP/1.1 200 OK"
2025-08-09 13:42:37,737 [WARNING] [llm_interface.py] N√£o foi poss√≠vel verificar modelos dispon√≠veis: 'name'
2025-08-09 13:42:37,737 [INFO] [llm_interface.py] Enviando requisi√ß√£o para o modelo llama3.1
2025-08-09 13:42:39,676 [INFO] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-09 13:42:39,677 [INFO] [llm_interface.py] Resposta recebida do LLM. Tamanho: 262 caracteres
2025-08-09 13:42:39,677 [INFO] [llm_interface.py] JSON parseado com sucesso: {'tool_name': 'handle_chitchat', 'parameters': {'response_text': 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'}}
2025-08-09 13:42:39,677 [INFO] INTEN√á√ÉO PROCESSADA: {'tool_name': 'handle_chitchat', 'parameters': {'response_text': 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'}}
2025-08-09 13:42:39,678 [INFO] Salvando sess√£o: {'customer_context': None, 'shopping_cart': [], 'last_search_type': 'by_name', 'last_search_params': {'product_name': 'coca cola'}, 'current_offset': 5, 'last_shown_products': [{'codprod': 13700, 'descricao': 'REFRIG.COCA-COLA PET 2L', 'pvenda': 8.5}], 'last_bot_action': 'AWAITING_PRODUCT_SELECTION', 'pending_action': None, 'last_kb_search_term': 'Coca Cola'}
2025-08-09 13:42:39,680 [INFO] Enviando mensagem proativa para whatsapp:+5511940726493: 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'
2025-08-09 13:42:39,707 [INFO] -- BEGIN Twilio API Request --
2025-08-09 13:42:39,707 [INFO] POST Request: https://api.twilio.com/2010-04-01/Accounts/USe5a35edbfd8e0118b3880312bc9723d2/Messages.json
2025-08-09 13:42:39,707 [INFO] Headers:
2025-08-09 13:42:39,708 [INFO] Content-Type : application/x-www-form-urlencoded
2025-08-09 13:42:39,708 [INFO] Accept : application/json
2025-08-09 13:42:39,708 [INFO] User-Agent : twilio-python/9.7.0 (Linux x86_64) Python/3.9.23
2025-08-09 13:42:39,709 [INFO] X-Twilio-Client : python-9.7.0
2025-08-09 13:42:39,709 [INFO] Accept-Charset : utf-8
2025-08-09 13:42:39,709 [INFO] -- END Twilio API Request --
2025-08-09 13:42:39,985 [INFO] Response Status Code: 401
2025-08-09 13:42:39,986 [INFO] Response Headers: {'Content-Type': 'application/json', 'Content-Length': '134', 'Connection': 'keep-alive', 'Date': 'Sat, 09 Aug 2025 13:42:39 GMT', 'X-Twilio-Error-Code': '20003', 'Twilio-Request-Id': 'RQ6495295d0f6be8ac02ccd808ca99e4d1', 'Twilio-Request-Duration': '0.004', 'X-Home-Region': 'us1', 'X-API-Domain': 'api.twilio.com', 'Strict-Transport-Security': 'max-age=31536000', 'WWW-Authenticate': 'Basic realm="Twilio API"', 'X-Cache': 'Error from cloudfront', 'Via': '1.1 db587cc2c62be193134f9aae98be311a.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'GRU3-P4', 'X-Amz-Cf-Id': 'uhkUsiQtZu5-WrdLJNgJRH5xEAjRuuzv8lwjMAEpdtPuXGFk6PblEw==', 'X-Powered-By': 'AT-5000', 'X-Shenanigans': 'none', 'Vary': 'Origin'}
2025-08-09 13:42:39,986 [ERROR] Falha ao enviar mensagem via API da Twilio: HTTP 401 error: Unable to create record: Authentication Error - invalid username
2025-08-09 13:42:39,986 [INFO] THREAD: Processamento finalizado para 'oi'
2025-08-09 13:42:50,412 [INFO] 172.18.0.1 - - [09/Aug/2025 13:42:50] "POST /webhook HTTP/1.1" 200 -
2025-08-09 13:42:50,413 [INFO] Arquivo de sess√£o encontrado. Carregando.
2025-08-09 13:42:50,414 [INFO] [llm_interface.py] Iniciando get_intent para mensagem: 'OI...'
2025-08-09 13:42:50,415 [INFO] [llm_interface.py] Tentando carregar prompt de: ai_llm/gav_prompt.txt
2025-08-09 13:42:50,416 [INFO] [llm_interface.py] Prompt carregado com sucesso. Tamanho: 2326 caracteres
2025-08-09 13:42:50,416 [INFO] [llm_interface.py] System prompt preparado. Tamanho: 2262 caracteres
2025-08-09 13:42:50,416 [INFO] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-09 13:42:50,429 [INFO] [llm_interface.py] Verificando disponibilidade do modelo: llama3.1
2025-08-09 13:42:50,435 [INFO] HTTP Request: GET http://host.docker.internal:11434/api/tags "HTTP/1.1 200 OK"
2025-08-09 13:42:50,435 [WARNING] [llm_interface.py] N√£o foi poss√≠vel verificar modelos dispon√≠veis: 'name'
2025-08-09 13:42:50,436 [INFO] [llm_interface.py] Enviando requisi√ß√£o para o modelo llama3.1
2025-08-09 13:42:52,209 [INFO] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-09 13:42:52,209 [INFO] [llm_interface.py] Resposta recebida do LLM. Tamanho: 257 caracteres
2025-08-09 13:42:52,210 [INFO] [llm_interface.py] JSON parseado com sucesso: {'tool_name': 'handle_chitchat', 'parameters': {'response_text': 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'}}
2025-08-09 13:42:52,210 [INFO] INTEN√á√ÉO PROCESSADA: {'tool_name': 'handle_chitchat', 'parameters': {'response_text': 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'}}
2025-08-09 13:42:52,210 [INFO] Salvando sess√£o: {'customer_context': None, 'shopping_cart': [], 'last_search_type': 'by_name', 'last_search_params': {'product_name': 'coca cola'}, 'current_offset': 5, 'last_shown_products': [{'codprod': 13700, 'descricao': 'REFRIG.COCA-COLA PET 2L', 'pvenda': 8.5}], 'last_bot_action': 'AWAITING_PRODUCT_SELECTION', 'pending_action': None, 'last_kb_search_term': 'Coca Cola'}
2025-08-09 13:42:52,212 [INFO] Enviando mensagem proativa para whatsapp:+5511940726493: 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'
2025-08-09 13:42:52,212 [INFO] -- BEGIN Twilio API Request --
2025-08-09 13:42:52,212 [INFO] POST Request: https://api.twilio.com/2010-04-01/Accounts/USe5a35edbfd8e0118b3880312bc9723d2/Messages.json
2025-08-09 13:42:52,213 [INFO] Headers:
2025-08-09 13:42:52,213 [INFO] Content-Type : application/x-www-form-urlencoded
2025-08-09 13:42:52,213 [INFO] Accept : application/json
2025-08-09 13:42:52,213 [INFO] User-Agent : twilio-python/9.7.0 (Linux x86_64) Python/3.9.23
2025-08-09 13:42:52,213 [INFO] X-Twilio-Client : python-9.7.0
2025-08-09 13:42:52,213 [INFO] Accept-Charset : utf-8
2025-08-09 13:42:52,214 [INFO] -- END Twilio API Request --
2025-08-09 13:42:52,342 [INFO] Response Status Code: 401
2025-08-09 13:42:52,345 [INFO] Response Headers: {'Content-Type': 'application/json', 'Content-Length': '134', 'Connection': 'keep-alive', 'Date': 'Sat, 09 Aug 2025 13:42:52 GMT', 'X-Twilio-Error-Code': '20003', 'Twilio-Request-Id': 'RQ3db03fea8c4fb44d7986d93d50ef9992', 'Twilio-Request-Duration': '0.006', 'X-Home-Region': 'us1', 'X-API-Domain': 'api.twilio.com', 'Strict-Transport-Security': 'max-age=31536000', 'WWW-Authenticate': 'Basic realm="Twilio API"', 'X-Cache': 'Error from cloudfront', 'Via': '1.1 db587cc2c62be193134f9aae98be311a.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'GRU3-P4', 'X-Amz-Cf-Id': '33Scukm3um3EC30qsP4jrrb_5DtUlU7ECJClutsoRxQJa7-dWYuOkA==', 'X-Powered-By': 'AT-5000', 'X-Shenanigans': 'none', 'Vary': 'Origin'}
2025-08-09 13:42:52,346 [ERROR] Falha ao enviar mensagem via API da Twilio: HTTP 401 error: Unable to create record: Authentication Error - invalid username
2025-08-09 13:42:52,346 [INFO] THREAD: Processamento finalizado para 'OI'
2025-08-09 13:44:18,287 [INFO]  * Detected change in '/app/utils/logger_config.py', reloading
2025-08-09 13:44:18,328 [INFO]  * Restarting with stat
2025-08-09 13:44:18,999 [WARNING]  * Debugger is active!
2025-08-09 13:44:19,001 [INFO]  * Debugger PIN: 278-656-101
2025-08-09 13:44:51,675 [INFO] [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8080
 * Running on http://172.18.0.3:8080
2025-08-09 13:44:51,675 [INFO] [33mPress CTRL+C to quit[0m
2025-08-09 13:44:51,675 [INFO]  * Restarting with stat
2025-08-09 13:44:52,317 [WARNING]  * Debugger is active!
2025-08-09 13:44:52,318 [INFO]  * Debugger PIN: 663-945-452
2025-08-09 13:45:19,028 [INFO] 172.18.0.1 - - [09/Aug/2025 13:45:19] "POST /webhook HTTP/1.1" 200 -
2025-08-09 13:45:19,030 [INFO] Arquivo de sess√£o encontrado. Carregando.
2025-08-09 13:45:19,032 [INFO] [llm_interface.py] Iniciando get_intent para mensagem: 'oi...'
2025-08-09 13:45:19,033 [INFO] [llm_interface.py] Tentando carregar prompt de: ai_llm/gav_prompt.txt
2025-08-09 13:45:19,034 [INFO] [llm_interface.py] Prompt carregado com sucesso. Tamanho: 2326 caracteres
2025-08-09 13:45:19,034 [INFO] [llm_interface.py] System prompt preparado. Tamanho: 2262 caracteres
2025-08-09 13:45:19,034 [INFO] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-09 13:45:19,048 [INFO] [llm_interface.py] Verificando disponibilidade do modelo: llama3.1
2025-08-09 13:45:19,049 [DEBUG] connect_tcp.started host='host.docker.internal' port=11434 local_address=None timeout=None socket_options=None
2025-08-09 13:45:19,051 [DEBUG] connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7f830037c460>
2025-08-09 13:45:19,051 [DEBUG] send_request_headers.started request=<Request [b'GET']>
2025-08-09 13:45:19,052 [DEBUG] send_request_headers.complete
2025-08-09 13:45:19,052 [DEBUG] send_request_body.started request=<Request [b'GET']>
2025-08-09 13:45:19,053 [DEBUG] send_request_body.complete
2025-08-09 13:45:19,053 [DEBUG] receive_response_headers.started request=<Request [b'GET']>
2025-08-09 13:45:19,054 [DEBUG] receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Sat, 09 Aug 2025 13:45:19 GMT'), (b'Content-Length', b'679')])
2025-08-09 13:45:19,054 [INFO] HTTP Request: GET http://host.docker.internal:11434/api/tags "HTTP/1.1 200 OK"
2025-08-09 13:45:19,054 [DEBUG] receive_response_body.started request=<Request [b'GET']>
2025-08-09 13:45:19,054 [DEBUG] receive_response_body.complete
2025-08-09 13:45:19,055 [DEBUG] response_closed.started
2025-08-09 13:45:19,055 [DEBUG] response_closed.complete
2025-08-09 13:45:19,055 [WARNING] [llm_interface.py] N√£o foi poss√≠vel verificar modelos dispon√≠veis: 'name'
2025-08-09 13:45:19,055 [INFO] [llm_interface.py] Enviando requisi√ß√£o para o modelo llama3.1
2025-08-09 13:45:19,056 [DEBUG] send_request_headers.started request=<Request [b'POST']>
2025-08-09 13:45:19,056 [DEBUG] send_request_headers.complete
2025-08-09 13:45:19,056 [DEBUG] send_request_body.started request=<Request [b'POST']>
2025-08-09 13:45:19,056 [DEBUG] send_request_body.complete
2025-08-09 13:45:19,056 [DEBUG] receive_response_headers.started request=<Request [b'POST']>
2025-08-09 13:45:21,251 [DEBUG] receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Sat, 09 Aug 2025 13:45:21 GMT'), (b'Content-Length', b'583')])
2025-08-09 13:45:21,252 [INFO] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-09 13:45:21,252 [DEBUG] receive_response_body.started request=<Request [b'POST']>
2025-08-09 13:45:21,252 [DEBUG] receive_response_body.complete
2025-08-09 13:45:21,252 [DEBUG] response_closed.started
2025-08-09 13:45:21,252 [DEBUG] response_closed.complete
2025-08-09 13:45:21,253 [INFO] [llm_interface.py] Resposta recebida do LLM. Tamanho: 277 caracteres
2025-08-09 13:45:21,253 [DEBUG] [llm_interface.py] Conte√∫do da resposta: {"tool_name": "handle_chitchat", "parameters": {"response_text": "Ol\u00e1! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan\u00e7a. Estou aqui para ajudar voc\u00ea a encontrar produtos e montar seu pedido. O que voc\u00ea gostaria de ver hoje?"}}
2025-08-09 13:45:21,253 [INFO] [llm_interface.py] JSON parseado com sucesso: {'tool_name': 'handle_chitchat', 'parameters': {'response_text': 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'}}
2025-08-09 13:45:21,253 [INFO] INTEN√á√ÉO PROCESSADA: {'tool_name': 'handle_chitchat', 'parameters': {'response_text': 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'}}
2025-08-09 13:45:21,253 [INFO] Salvando sess√£o: {'customer_context': None, 'shopping_cart': [], 'last_search_type': 'by_name', 'last_search_params': {'product_name': 'coca cola'}, 'current_offset': 5, 'last_shown_products': [{'codprod': 13700, 'descricao': 'REFRIG.COCA-COLA PET 2L', 'pvenda': 8.5}], 'last_bot_action': 'AWAITING_PRODUCT_SELECTION', 'pending_action': None, 'last_kb_search_term': 'Coca Cola'}
2025-08-09 13:45:21,255 [INFO] Enviando mensagem proativa para whatsapp:+5511940726493: 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'
2025-08-09 13:45:21,284 [INFO] -- BEGIN Twilio API Request --
2025-08-09 13:45:21,284 [INFO] POST Request: https://api.twilio.com/2010-04-01/Accounts/USe5a35edbfd8e0118b3880312bc9723d2/Messages.json
2025-08-09 13:45:21,284 [INFO] Headers:
2025-08-09 13:45:21,284 [INFO] Content-Type : application/x-www-form-urlencoded
2025-08-09 13:45:21,284 [INFO] Accept : application/json
2025-08-09 13:45:21,284 [INFO] User-Agent : twilio-python/9.7.0 (Linux x86_64) Python/3.9.23
2025-08-09 13:45:21,284 [INFO] X-Twilio-Client : python-9.7.0
2025-08-09 13:45:21,285 [INFO] Accept-Charset : utf-8
2025-08-09 13:45:21,285 [INFO] -- END Twilio API Request --
2025-08-09 13:45:21,285 [DEBUG] Starting new HTTPS connection (1): api.twilio.com:443
2025-08-09 13:45:21,585 [DEBUG] https://api.twilio.com:443 "POST /2010-04-01/Accounts/USe5a35edbfd8e0118b3880312bc9723d2/Messages.json HTTP/1.1" 401 134
2025-08-09 13:45:21,585 [INFO] Response Status Code: 401
2025-08-09 13:45:21,586 [INFO] Response Headers: {'Content-Type': 'application/json', 'Content-Length': '134', 'Connection': 'keep-alive', 'Date': 'Sat, 09 Aug 2025 13:45:21 GMT', 'X-Twilio-Error-Code': '20003', 'Twilio-Request-Id': 'RQ3136c40d9e6f474d74dd5ec496374f3f', 'Twilio-Request-Duration': '0.004', 'X-Home-Region': 'us1', 'X-API-Domain': 'api.twilio.com', 'Strict-Transport-Security': 'max-age=31536000', 'WWW-Authenticate': 'Basic realm="Twilio API"', 'X-Cache': 'Error from cloudfront', 'Via': '1.1 6f2f291762a32a9876c9d69d778cb280.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'GRU3-P4', 'X-Amz-Cf-Id': '2lpbnZeUNTWJKCm5r-sn01if8NOG077rKMmPb3hoSl5CZCUqH-ZC-w==', 'X-Powered-By': 'AT-5000', 'X-Shenanigans': 'none', 'Vary': 'Origin'}
2025-08-09 13:45:21,586 [ERROR] Falha ao enviar mensagem via API da Twilio: HTTP 401 error: Unable to create record: Authentication Error - invalid username
2025-08-09 13:45:21,586 [INFO] THREAD: Processamento finalizado para 'oi'
2025-08-09 13:47:19,089 [INFO]  * Detected change in '/app/communication/twilio_client.py', reloading
2025-08-09 13:47:19,128 [INFO]  * Restarting with stat
2025-08-09 13:47:19,803 [WARNING]  * Debugger is active!
2025-08-09 13:47:19,804 [INFO]  * Debugger PIN: 663-945-452
2025-08-09 13:47:40,888 [INFO]  * Detected change in '/app/communication/twilio_client.py', reloading
2025-08-09 13:47:40,922 [INFO]  * Restarting with stat
2025-08-09 13:47:41,568 [WARNING]  * Debugger is active!
2025-08-09 13:47:41,569 [INFO]  * Debugger PIN: 663-945-452
2025-08-09 13:47:42,688 [INFO]  * Detected change in '/app/communication/twilio_client.py', reloading
2025-08-09 13:47:42,719 [INFO]  * Restarting with stat
2025-08-09 13:47:43,382 [WARNING]  * Debugger is active!
2025-08-09 13:47:43,383 [INFO]  * Debugger PIN: 663-945-452
2025-08-09 13:48:20,287 [INFO] [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8080
 * Running on http://172.18.0.3:8080
2025-08-09 13:48:20,288 [INFO] [33mPress CTRL+C to quit[0m
2025-08-09 13:48:20,289 [INFO]  * Restarting with stat
2025-08-09 13:48:20,930 [WARNING]  * Debugger is active!
2025-08-09 13:48:20,931 [INFO]  * Debugger PIN: 109-050-125
2025-08-09 13:48:22,380 [INFO] 172.18.0.1 - - [09/Aug/2025 13:48:22] "POST /webhook HTTP/1.1" 200 -
2025-08-09 13:48:22,382 [INFO] Arquivo de sess√£o encontrado. Carregando.
2025-08-09 13:48:22,384 [INFO] [llm_interface.py] Iniciando get_intent para mensagem: 'Oi...'
2025-08-09 13:48:22,384 [INFO] [llm_interface.py] Tentando carregar prompt de: ai_llm/gav_prompt.txt
2025-08-09 13:48:22,386 [INFO] [llm_interface.py] Prompt carregado com sucesso. Tamanho: 2326 caracteres
2025-08-09 13:48:22,387 [INFO] [llm_interface.py] System prompt preparado. Tamanho: 2262 caracteres
2025-08-09 13:48:22,387 [INFO] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-09 13:48:22,402 [INFO] [llm_interface.py] Verificando disponibilidade do modelo: llama3.1
2025-08-09 13:48:22,403 [DEBUG] connect_tcp.started host='host.docker.internal' port=11434 local_address=None timeout=None socket_options=None
2025-08-09 13:48:22,407 [DEBUG] connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7fdf8353c460>
2025-08-09 13:48:22,407 [DEBUG] send_request_headers.started request=<Request [b'GET']>
2025-08-09 13:48:22,408 [DEBUG] send_request_headers.complete
2025-08-09 13:48:22,408 [DEBUG] send_request_body.started request=<Request [b'GET']>
2025-08-09 13:48:22,409 [DEBUG] send_request_body.complete
2025-08-09 13:48:22,409 [DEBUG] receive_response_headers.started request=<Request [b'GET']>
2025-08-09 13:48:22,412 [DEBUG] receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Sat, 09 Aug 2025 13:48:22 GMT'), (b'Content-Length', b'679')])
2025-08-09 13:48:22,414 [INFO] HTTP Request: GET http://host.docker.internal:11434/api/tags "HTTP/1.1 200 OK"
2025-08-09 13:48:22,414 [DEBUG] receive_response_body.started request=<Request [b'GET']>
2025-08-09 13:48:22,415 [DEBUG] receive_response_body.complete
2025-08-09 13:48:22,415 [DEBUG] response_closed.started
2025-08-09 13:48:22,415 [DEBUG] response_closed.complete
2025-08-09 13:48:22,416 [WARNING] [llm_interface.py] N√£o foi poss√≠vel verificar modelos dispon√≠veis: 'name'
2025-08-09 13:48:22,416 [INFO] [llm_interface.py] Enviando requisi√ß√£o para o modelo llama3.1
2025-08-09 13:48:22,417 [DEBUG] send_request_headers.started request=<Request [b'POST']>
2025-08-09 13:48:22,418 [DEBUG] send_request_headers.complete
2025-08-09 13:48:22,418 [DEBUG] send_request_body.started request=<Request [b'POST']>
2025-08-09 13:48:22,418 [DEBUG] send_request_body.complete
2025-08-09 13:48:22,418 [DEBUG] receive_response_headers.started request=<Request [b'POST']>
2025-08-09 13:48:24,591 [DEBUG] receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Sat, 09 Aug 2025 13:48:24 GMT'), (b'Content-Length', b'583')])
2025-08-09 13:48:24,592 [INFO] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-09 13:48:24,592 [DEBUG] receive_response_body.started request=<Request [b'POST']>
2025-08-09 13:48:24,592 [DEBUG] receive_response_body.complete
2025-08-09 13:48:24,593 [DEBUG] response_closed.started
2025-08-09 13:48:24,593 [DEBUG] response_closed.complete
2025-08-09 13:48:24,593 [INFO] [llm_interface.py] Resposta recebida do LLM. Tamanho: 277 caracteres
2025-08-09 13:48:24,593 [DEBUG] [llm_interface.py] Conte√∫do da resposta: {"tool_name": "handle_chitchat", "parameters": {"response_text": "Ol\u00e1! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan\u00e7a. Estou aqui para ajudar voc\u00ea a encontrar produtos e montar seu pedido. O que voc\u00ea gostaria de ver hoje?"}}
2025-08-09 13:48:24,593 [INFO] [llm_interface.py] JSON parseado com sucesso: {'tool_name': 'handle_chitchat', 'parameters': {'response_text': 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'}}
2025-08-09 13:48:24,594 [INFO] INTEN√á√ÉO PROCESSADA: {'tool_name': 'handle_chitchat', 'parameters': {'response_text': 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'}}
2025-08-09 13:48:24,594 [INFO] Salvando sess√£o: {'customer_context': None, 'shopping_cart': [], 'last_search_type': 'by_name', 'last_search_params': {'product_name': 'coca cola'}, 'current_offset': 5, 'last_shown_products': [{'codprod': 13700, 'descricao': 'REFRIG.COCA-COLA PET 2L', 'pvenda': 8.5}], 'last_bot_action': 'AWAITING_PRODUCT_SELECTION', 'pending_action': None, 'last_kb_search_term': 'Coca Cola'}
2025-08-09 13:48:24,596 [INFO] Enviando mensagem proativa para whatsapp:+5511940726493: 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'
2025-08-09 13:48:24,623 [INFO] -- BEGIN Twilio API Request --
2025-08-09 13:48:24,624 [INFO] POST Request: https://api.twilio.com/2010-04-01/Accounts/USe5a35edbfd8e0118b3880312bc9723d2/Messages.json
2025-08-09 13:48:24,624 [INFO] Headers:
2025-08-09 13:48:24,624 [INFO] Content-Type : application/x-www-form-urlencoded
2025-08-09 13:48:24,624 [INFO] Accept : application/json
2025-08-09 13:48:24,624 [INFO] User-Agent : twilio-python/9.7.0 (Linux x86_64) Python/3.9.23
2025-08-09 13:48:24,624 [INFO] X-Twilio-Client : python-9.7.0
2025-08-09 13:48:24,624 [INFO] Accept-Charset : utf-8
2025-08-09 13:48:24,624 [INFO] -- END Twilio API Request --
2025-08-09 13:48:24,627 [DEBUG] Starting new HTTPS connection (1): api.twilio.com:443
2025-08-09 13:48:25,165 [DEBUG] https://api.twilio.com:443 "POST /2010-04-01/Accounts/USe5a35edbfd8e0118b3880312bc9723d2/Messages.json HTTP/1.1" 401 134
2025-08-09 13:48:25,166 [INFO] Response Status Code: 401
2025-08-09 13:48:25,166 [INFO] Response Headers: {'Content-Type': 'application/json', 'Content-Length': '134', 'Connection': 'keep-alive', 'Date': 'Sat, 09 Aug 2025 13:48:25 GMT', 'X-Twilio-Error-Code': '20003', 'Twilio-Request-Id': 'RQd16434e2e65d753efc2c151d544555ce', 'Twilio-Request-Duration': '0.006', 'X-Home-Region': 'us1', 'X-API-Domain': 'api.twilio.com', 'Strict-Transport-Security': 'max-age=31536000', 'WWW-Authenticate': 'Basic realm="Twilio API"', 'X-Cache': 'Error from cloudfront', 'Via': '1.1 5c0a259581220ee625646cd2f358183c.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'JFK52-P10', 'X-Amz-Cf-Id': 'cyb7wikZB9OlTvGoZ-gLp6ljxHD42oEiyOZRMrHE70TVlR1Eh86tnA==', 'X-Powered-By': 'AT-5000', 'X-Shenanigans': 'none', 'Vary': 'Origin'}
2025-08-09 13:48:25,167 [ERROR] Falha ao enviar mensagem via API da Twilio: HTTP 401 error: Unable to create record: Authentication Error - invalid username
2025-08-09 13:48:25,167 [INFO] THREAD: Processamento finalizado para 'Oi'
2025-08-09 13:48:54,416 [INFO]  * Detected change in '/app/communication/twilio_client.py', reloading
2025-08-09 13:48:54,455 [INFO]  * Restarting with stat
2025-08-09 13:48:55,114 [WARNING]  * Debugger is active!
2025-08-09 13:48:55,115 [INFO]  * Debugger PIN: 109-050-125
2025-08-09 13:51:23,002 [INFO]  * Detected change in '/app/communication/twilio_client.py', reloading
2025-08-09 13:51:23,036 [INFO]  * Restarting with stat
2025-08-09 13:51:24,086 [WARNING]  * Debugger is active!
2025-08-09 13:51:24,090 [INFO]  * Debugger PIN: 109-050-125
2025-08-09 13:51:27,774 [INFO] 172.18.0.1 - - [09/Aug/2025 13:51:27] "POST /webhook HTTP/1.1" 200 -
2025-08-09 13:51:27,776 [INFO] Arquivo de sess√£o encontrado. Carregando.
2025-08-09 13:51:27,778 [INFO] [llm_interface.py] Iniciando get_intent para mensagem: 'teste...'
2025-08-09 13:51:27,778 [INFO] [llm_interface.py] Tentando carregar prompt de: ai_llm/gav_prompt.txt
2025-08-09 13:51:27,779 [INFO] [llm_interface.py] Prompt carregado com sucesso. Tamanho: 2326 caracteres
2025-08-09 13:51:27,780 [INFO] [llm_interface.py] System prompt preparado. Tamanho: 2262 caracteres
2025-08-09 13:51:27,780 [INFO] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-09 13:51:27,793 [INFO] [llm_interface.py] Verificando disponibilidade do modelo: llama3.1
2025-08-09 13:51:27,793 [DEBUG] connect_tcp.started host='host.docker.internal' port=11434 local_address=None timeout=None socket_options=None
2025-08-09 13:51:27,796 [DEBUG] connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7ff96dabc460>
2025-08-09 13:51:27,797 [DEBUG] send_request_headers.started request=<Request [b'GET']>
2025-08-09 13:51:27,797 [DEBUG] send_request_headers.complete
2025-08-09 13:51:27,797 [DEBUG] send_request_body.started request=<Request [b'GET']>
2025-08-09 13:51:27,798 [DEBUG] send_request_body.complete
2025-08-09 13:51:27,798 [DEBUG] receive_response_headers.started request=<Request [b'GET']>
2025-08-09 13:51:27,800 [DEBUG] receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Sat, 09 Aug 2025 13:51:27 GMT'), (b'Content-Length', b'679')])
2025-08-09 13:51:27,801 [INFO] HTTP Request: GET http://host.docker.internal:11434/api/tags "HTTP/1.1 200 OK"
2025-08-09 13:51:27,801 [DEBUG] receive_response_body.started request=<Request [b'GET']>
2025-08-09 13:51:27,801 [DEBUG] receive_response_body.complete
2025-08-09 13:51:27,801 [DEBUG] response_closed.started
2025-08-09 13:51:27,802 [DEBUG] response_closed.complete
2025-08-09 13:51:27,802 [WARNING] [llm_interface.py] N√£o foi poss√≠vel verificar modelos dispon√≠veis: 'name'
2025-08-09 13:51:27,802 [INFO] [llm_interface.py] Enviando requisi√ß√£o para o modelo llama3.1
2025-08-09 13:51:27,803 [DEBUG] send_request_headers.started request=<Request [b'POST']>
2025-08-09 13:51:27,803 [DEBUG] send_request_headers.complete
2025-08-09 13:51:27,803 [DEBUG] send_request_body.started request=<Request [b'POST']>
2025-08-09 13:51:27,803 [DEBUG] send_request_body.complete
2025-08-09 13:51:27,804 [DEBUG] receive_response_headers.started request=<Request [b'POST']>
2025-08-09 13:51:29,643 [DEBUG] receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Sat, 09 Aug 2025 13:51:29 GMT'), (b'Content-Length', b'561')])
2025-08-09 13:51:29,644 [INFO] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-09 13:51:29,644 [DEBUG] receive_response_body.started request=<Request [b'POST']>
2025-08-09 13:51:29,644 [DEBUG] receive_response_body.complete
2025-08-09 13:51:29,644 [DEBUG] response_closed.started
2025-08-09 13:51:29,645 [DEBUG] response_closed.complete
2025-08-09 13:51:29,645 [INFO] [llm_interface.py] Resposta recebida do LLM. Tamanho: 257 caracteres
2025-08-09 13:51:29,645 [DEBUG] [llm_interface.py] Conte√∫do da resposta: {"tool_name": "handle_chitchat", "parameters": {"response_text": "Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?"}}
2025-08-09 13:51:29,645 [INFO] [llm_interface.py] JSON parseado com sucesso: {'tool_name': 'handle_chitchat', 'parameters': {'response_text': 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'}}
2025-08-09 13:51:29,646 [INFO] INTEN√á√ÉO PROCESSADA: {'tool_name': 'handle_chitchat', 'parameters': {'response_text': 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'}}
2025-08-09 13:51:29,646 [INFO] Salvando sess√£o: {'customer_context': None, 'shopping_cart': [], 'last_search_type': 'by_name', 'last_search_params': {'product_name': 'coca cola'}, 'current_offset': 5, 'last_shown_products': [{'codprod': 13700, 'descricao': 'REFRIG.COCA-COLA PET 2L', 'pvenda': 8.5}], 'last_bot_action': 'AWAITING_PRODUCT_SELECTION', 'pending_action': None, 'last_kb_search_term': 'Coca Cola'}
2025-08-09 13:51:29,653 [INFO] Enviando mensagem proativa para whatsapp:+5511940726493: 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'
2025-08-09 13:51:29,675 [INFO] -- BEGIN Twilio API Request --
2025-08-09 13:51:29,676 [INFO] POST Request: https://api.twilio.com/2010-04-01/Accounts/USe5a35edbfd8e0118b3880312bc9723d2/Messages.json
2025-08-09 13:51:29,676 [INFO] Headers:
2025-08-09 13:51:29,676 [INFO] Content-Type : application/x-www-form-urlencoded
2025-08-09 13:51:29,677 [INFO] Accept : application/json
2025-08-09 13:51:29,677 [INFO] User-Agent : twilio-python/9.7.0 (Linux x86_64) Python/3.9.23
2025-08-09 13:51:29,677 [INFO] X-Twilio-Client : python-9.7.0
2025-08-09 13:51:29,677 [INFO] Accept-Charset : utf-8
2025-08-09 13:51:29,678 [INFO] -- END Twilio API Request --
2025-08-09 13:51:29,679 [DEBUG] Starting new HTTPS connection (1): api.twilio.com:443
2025-08-09 13:51:29,847 [DEBUG] https://api.twilio.com:443 "POST /2010-04-01/Accounts/USe5a35edbfd8e0118b3880312bc9723d2/Messages.json HTTP/1.1" 401 134
2025-08-09 13:51:29,848 [INFO] Response Status Code: 401
2025-08-09 13:51:29,848 [INFO] Response Headers: {'Content-Type': 'application/json', 'Content-Length': '134', 'Connection': 'keep-alive', 'Date': 'Sat, 09 Aug 2025 13:51:29 GMT', 'X-Twilio-Error-Code': '20003', 'Twilio-Request-Id': 'RQe81124fa250d63350a36267ed5966ceb', 'Twilio-Request-Duration': '0.004', 'X-Home-Region': 'us1', 'X-API-Domain': 'api.twilio.com', 'Strict-Transport-Security': 'max-age=31536000', 'WWW-Authenticate': 'Basic realm="Twilio API"', 'X-Cache': 'Error from cloudfront', 'Via': '1.1 1f71c63658c4f74faed3133e50a0708a.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'GRU3-P4', 'X-Amz-Cf-Id': 'BPpGZHVgsuIXfVCEB0YWCMrNKBP7luNKJJXqfokBfXVY0IFH_sTGIw==', 'X-Powered-By': 'AT-5000', 'X-Shenanigans': 'none', 'Vary': 'Origin'}
2025-08-09 13:51:29,849 [ERROR] Falha ao enviar mensagem via API da Twilio: HTTP 401 error: Unable to create record: Authentication Error - invalid username
2025-08-09 13:51:29,849 [INFO] THREAD: Processamento finalizado para 'teste'
2025-08-09 13:55:17,880 [INFO] [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8080
 * Running on http://172.18.0.3:8080
2025-08-09 13:55:17,880 [INFO] [33mPress CTRL+C to quit[0m
2025-08-09 13:55:17,881 [INFO]  * Restarting with stat
2025-08-09 13:55:18,499 [WARNING]  * Debugger is active!
2025-08-09 13:55:18,500 [INFO]  * Debugger PIN: 323-075-203
2025-08-09 13:55:22,334 [INFO] 172.18.0.1 - - [09/Aug/2025 13:55:22] "POST /webhook HTTP/1.1" 200 -
2025-08-09 13:55:22,335 [INFO] Arquivo de sess√£o encontrado. Carregando.
2025-08-09 13:55:22,337 [INFO] [llm_interface.py] Iniciando get_intent para mensagem: 'oi...'
2025-08-09 13:55:22,338 [INFO] [llm_interface.py] Tentando carregar prompt de: ai_llm/gav_prompt.txt
2025-08-09 13:55:22,339 [INFO] [llm_interface.py] Prompt carregado com sucesso. Tamanho: 2326 caracteres
2025-08-09 13:55:22,340 [INFO] [llm_interface.py] System prompt preparado. Tamanho: 2262 caracteres
2025-08-09 13:55:22,340 [INFO] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-09 13:55:22,354 [INFO] [llm_interface.py] Verificando disponibilidade do modelo: llama3.1
2025-08-09 13:55:22,354 [DEBUG] connect_tcp.started host='host.docker.internal' port=11434 local_address=None timeout=None socket_options=None
2025-08-09 13:55:22,358 [DEBUG] connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7f762717c460>
2025-08-09 13:55:22,358 [DEBUG] send_request_headers.started request=<Request [b'GET']>
2025-08-09 13:55:22,359 [DEBUG] send_request_headers.complete
2025-08-09 13:55:22,359 [DEBUG] send_request_body.started request=<Request [b'GET']>
2025-08-09 13:55:22,359 [DEBUG] send_request_body.complete
2025-08-09 13:55:22,359 [DEBUG] receive_response_headers.started request=<Request [b'GET']>
2025-08-09 13:55:22,361 [DEBUG] receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Sat, 09 Aug 2025 13:55:22 GMT'), (b'Content-Length', b'679')])
2025-08-09 13:55:22,361 [INFO] HTTP Request: GET http://host.docker.internal:11434/api/tags "HTTP/1.1 200 OK"
2025-08-09 13:55:22,361 [DEBUG] receive_response_body.started request=<Request [b'GET']>
2025-08-09 13:55:22,361 [DEBUG] receive_response_body.complete
2025-08-09 13:55:22,362 [DEBUG] response_closed.started
2025-08-09 13:55:22,362 [DEBUG] response_closed.complete
2025-08-09 13:55:22,362 [WARNING] [llm_interface.py] N√£o foi poss√≠vel verificar modelos dispon√≠veis: 'name'
2025-08-09 13:55:22,362 [INFO] [llm_interface.py] Enviando requisi√ß√£o para o modelo llama3.1
2025-08-09 13:55:22,363 [DEBUG] send_request_headers.started request=<Request [b'POST']>
2025-08-09 13:55:22,363 [DEBUG] send_request_headers.complete
2025-08-09 13:55:22,363 [DEBUG] send_request_body.started request=<Request [b'POST']>
2025-08-09 13:55:22,363 [DEBUG] send_request_body.complete
2025-08-09 13:55:22,363 [DEBUG] receive_response_headers.started request=<Request [b'POST']>
2025-08-09 13:55:24,461 [DEBUG] receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Sat, 09 Aug 2025 13:55:24 GMT'), (b'Content-Length', b'583')])
2025-08-09 13:55:24,461 [INFO] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-09 13:55:24,461 [DEBUG] receive_response_body.started request=<Request [b'POST']>
2025-08-09 13:55:24,462 [DEBUG] receive_response_body.complete
2025-08-09 13:55:24,462 [DEBUG] response_closed.started
2025-08-09 13:55:24,462 [DEBUG] response_closed.complete
2025-08-09 13:55:24,462 [INFO] [llm_interface.py] Resposta recebida do LLM. Tamanho: 277 caracteres
2025-08-09 13:55:24,462 [DEBUG] [llm_interface.py] Conte√∫do da resposta: {"tool_name": "handle_chitchat", "parameters": {"response_text": "Ol\u00e1! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan\u00e7a. Estou aqui para ajudar voc\u00ea a encontrar produtos e montar seu pedido. O que voc\u00ea gostaria de ver hoje?"}}
2025-08-09 13:55:24,462 [INFO] [llm_interface.py] JSON parseado com sucesso: {'tool_name': 'handle_chitchat', 'parameters': {'response_text': 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'}}
2025-08-09 13:55:24,463 [INFO] INTEN√á√ÉO PROCESSADA: {'tool_name': 'handle_chitchat', 'parameters': {'response_text': 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'}}
2025-08-09 13:55:24,463 [INFO] Salvando sess√£o: {'customer_context': None, 'shopping_cart': [], 'last_search_type': 'by_name', 'last_search_params': {'product_name': 'coca cola'}, 'current_offset': 5, 'last_shown_products': [{'codprod': 13700, 'descricao': 'REFRIG.COCA-COLA PET 2L', 'pvenda': 8.5}], 'last_bot_action': 'AWAITING_PRODUCT_SELECTION', 'pending_action': None, 'last_kb_search_term': 'Coca Cola'}
2025-08-09 13:55:24,465 [INFO] Enviando mensagem proativa para whatsapp:+5511940726493: 'Ol√°! Tudo bem? Sou o G.A.V., seu assistente de vendas virtual do Comercial Esperan√ßa. Estou aqui para ajudar voc√™ a encontrar produtos e montar seu pedido. O que voc√™ gostaria de ver hoje?'
2025-08-09 13:55:24,492 [INFO] -- BEGIN Twilio API Request --
2025-08-09 13:55:24,492 [INFO] POST Request: https://api.twilio.com/2010-04-01/Accounts/ACad7b82d94a6416ade9b1d19a8194499f/Messages.json
2025-08-09 13:55:24,492 [INFO] Headers:
2025-08-09 13:55:24,492 [INFO] Content-Type : application/x-www-form-urlencoded
2025-08-09 13:55:24,493 [INFO] Accept : application/json
2025-08-09 13:55:24,493 [INFO] User-Agent : twilio-python/9.7.0 (Linux x86_64) Python/3.9.23
2025-08-09 13:55:24,493 [INFO] X-Twilio-Client : python-9.7.0
2025-08-09 13:55:24,493 [INFO] Accept-Charset : utf-8
2025-08-09 13:55:24,493 [INFO] -- END Twilio API Request --
2025-08-09 13:55:24,494 [DEBUG] Starting new HTTPS connection (1): api.twilio.com:443
2025-08-09 13:55:24,757 [DEBUG] https://api.twilio.com:443 "POST /2010-04-01/Accounts/ACad7b82d94a6416ade9b1d19a8194499f/Messages.json HTTP/1.1" 201 991
2025-08-09 13:55:24,758 [INFO] Response Status Code: 201
2025-08-09 13:55:24,758 [INFO] Response Headers: {'Content-Type': 'application/json;charset=utf-8', 'Content-Length': '991', 'Connection': 'keep-alive', 'Date': 'Sat, 09 Aug 2025 13:55:24 GMT', 'Twilio-Concurrent-Requests': '1', 'Twilio-Request-Id': 'RQ099ab0715229a3dcae2d265a9d7653f3', 'Twilio-Request-Duration': '0.118', 'X-Home-Region': 'us1', 'X-API-Domain': 'api.twilio.com', 'Strict-Transport-Security': 'max-age=31536000', 'X-Cache': 'Miss from cloudfront', 'Via': '1.1 b32b674425bc91de1120f0cc3dff96dc.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'GRU3-P4', 'X-Amz-Cf-Id': 'OPjFcKNe9076c2WG-C4a6Ju75zQ5yfCIwAe1Vzd_WE7pLt-JGIFjlw==', 'X-Powered-By': 'AT-5000', 'X-Shenanigans': 'none', 'Vary': 'Origin'}
2025-08-09 13:55:24,758 [INFO] THREAD: Processamento finalizado para 'oi'
2025-08-09 13:57:45,024 [INFO] 172.18.0.1 - - [09/Aug/2025 13:57:45] "POST /webhook HTTP/1.1" 200 -
2025-08-09 13:57:45,025 [INFO] Arquivo de sess√£o encontrado. Carregando.
2025-08-09 13:57:45,027 [INFO] [llm_interface.py] Iniciando get_intent para mensagem: 'produtos da coca cola...'
2025-08-09 13:57:45,028 [INFO] [llm_interface.py] Tentando carregar prompt de: ai_llm/gav_prompt.txt
2025-08-09 13:57:45,030 [INFO] [llm_interface.py] Prompt carregado com sucesso. Tamanho: 2326 caracteres
2025-08-09 13:57:45,031 [INFO] [llm_interface.py] System prompt preparado. Tamanho: 2262 caracteres
2025-08-09 13:57:45,031 [INFO] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-09 13:57:45,046 [INFO] [llm_interface.py] Verificando disponibilidade do modelo: llama3.1
2025-08-09 13:57:45,046 [DEBUG] connect_tcp.started host='host.docker.internal' port=11434 local_address=None timeout=None socket_options=None
2025-08-09 13:57:45,051 [DEBUG] connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7f7624b48a90>
2025-08-09 13:57:45,053 [DEBUG] send_request_headers.started request=<Request [b'GET']>
2025-08-09 13:57:45,053 [DEBUG] send_request_headers.complete
2025-08-09 13:57:45,055 [DEBUG] send_request_body.started request=<Request [b'GET']>
2025-08-09 13:57:45,056 [DEBUG] send_request_body.complete
2025-08-09 13:57:45,057 [DEBUG] receive_response_headers.started request=<Request [b'GET']>
2025-08-09 13:57:45,057 [DEBUG] receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Sat, 09 Aug 2025 13:57:45 GMT'), (b'Content-Length', b'679')])
2025-08-09 13:57:45,057 [INFO] HTTP Request: GET http://host.docker.internal:11434/api/tags "HTTP/1.1 200 OK"
2025-08-09 13:57:45,057 [DEBUG] receive_response_body.started request=<Request [b'GET']>
2025-08-09 13:57:45,057 [DEBUG] receive_response_body.complete
2025-08-09 13:57:45,057 [DEBUG] response_closed.started
2025-08-09 13:57:45,057 [DEBUG] response_closed.complete
2025-08-09 13:57:45,058 [WARNING] [llm_interface.py] N√£o foi poss√≠vel verificar modelos dispon√≠veis: 'name'
2025-08-09 13:57:45,058 [INFO] [llm_interface.py] Enviando requisi√ß√£o para o modelo llama3.1
2025-08-09 13:57:45,058 [DEBUG] send_request_headers.started request=<Request [b'POST']>
2025-08-09 13:57:45,058 [DEBUG] send_request_headers.complete
2025-08-09 13:57:45,059 [DEBUG] send_request_body.started request=<Request [b'POST']>
2025-08-09 13:57:45,059 [DEBUG] send_request_body.complete
2025-08-09 13:57:45,059 [DEBUG] receive_response_headers.started request=<Request [b'POST']>
2025-08-09 13:57:45,963 [DEBUG] receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Sat, 09 Aug 2025 13:57:45 GMT'), (b'Content-Length', b'394')])
2025-08-09 13:57:45,963 [INFO] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-09 13:57:45,964 [DEBUG] receive_response_body.started request=<Request [b'POST']>
2025-08-09 13:57:45,964 [DEBUG] receive_response_body.complete
2025-08-09 13:57:45,964 [DEBUG] response_closed.started
2025-08-09 13:57:45,964 [DEBUG] response_closed.complete
2025-08-09 13:57:45,964 [INFO] [llm_interface.py] Resposta recebida do LLM. Tamanho: 94 caracteres
2025-08-09 13:57:45,965 [DEBUG] [llm_interface.py] Conte√∫do da resposta: {"tool_name": "get_top_selling_products_by_name", "parameters": {"product_name": "Coca Cola"}}
2025-08-09 13:57:45,965 [INFO] [llm_interface.py] JSON parseado com sucesso: {'tool_name': 'get_top_selling_products_by_name', 'parameters': {'product_name': 'Coca Cola'}}
2025-08-09 13:57:45,965 [INFO] INTEN√á√ÉO PROCESSADA: {'tool_name': 'get_top_selling_products_by_name', 'parameters': {'product_name': 'Coca Cola'}}
2025-08-09 13:57:45,968 [INFO] Base de conhecimento '/app/knowledge/knowledge_base.json' carregada com 3 produtos e 57 termos.
2025-08-09 13:57:45,973 [INFO] Salvando sess√£o: {'customer_context': None, 'shopping_cart': [], 'last_search_type': 'by_name', 'last_search_params': {'product_name': 'coca cola'}, 'current_offset': 5, 'last_shown_products': [{'codprod': 13700, 'descricao': 'REFRIG.COCA-COLA PET 2L', 'pvenda': 8.5}], 'last_bot_action': 'AWAITING_PRODUCT_SELECTION', 'pending_action': None, 'last_kb_search_term': 'Coca Cola'}
2025-08-09 13:57:45,974 [INFO] Enviando mensagem proativa para whatsapp:+5511940726493: 'ü§ñ Encontrei isto para 'Coca Cola' (busca r√°pida):
1. REFRIG.COCA-COLA PET 2L - R$ 8,50
Me diga o nome ou o n√∫mero do item que deseja adicionar.
'
2025-08-09 13:57:45,974 [INFO] -- BEGIN Twilio API Request --
2025-08-09 13:57:45,974 [INFO] POST Request: https://api.twilio.com/2010-04-01/Accounts/ACad7b82d94a6416ade9b1d19a8194499f/Messages.json
2025-08-09 13:57:45,975 [INFO] Headers:
2025-08-09 13:57:45,975 [INFO] Content-Type : application/x-www-form-urlencoded
2025-08-09 13:57:45,975 [INFO] Accept : application/json
2025-08-09 13:57:45,975 [INFO] User-Agent : twilio-python/9.7.0 (Linux x86_64) Python/3.9.23
2025-08-09 13:57:45,975 [INFO] X-Twilio-Client : python-9.7.0
2025-08-09 13:57:45,975 [INFO] Accept-Charset : utf-8
2025-08-09 13:57:45,975 [INFO] -- END Twilio API Request --
2025-08-09 13:57:46,212 [DEBUG] https://api.twilio.com:443 "POST /2010-04-01/Accounts/ACad7b82d94a6416ade9b1d19a8194499f/Messages.json HTTP/1.1" 201 951
2025-08-09 13:57:46,213 [INFO] Response Status Code: 201
2025-08-09 13:57:46,213 [INFO] Response Headers: {'Content-Type': 'application/json;charset=utf-8', 'Content-Length': '951', 'Connection': 'keep-alive', 'Date': 'Sat, 09 Aug 2025 13:57:46 GMT', 'Twilio-Concurrent-Requests': '1', 'Twilio-Request-Id': 'RQ04f84aea13c6a46179572b9643f12615', 'Twilio-Request-Duration': '0.107', 'X-Home-Region': 'us1', 'X-API-Domain': 'api.twilio.com', 'Strict-Transport-Security': 'max-age=31536000', 'X-Cache': 'Miss from cloudfront', 'Via': '1.1 b32b674425bc91de1120f0cc3dff96dc.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'GRU3-P4', 'X-Amz-Cf-Id': '1uYh-tlkIWCov_FNM-wiF-kE-I7gbYjzjuVYKO18L9vDVBtwcM6qYw==', 'X-Powered-By': 'AT-5000', 'X-Shenanigans': 'none', 'Vary': 'Origin'}
2025-08-09 13:57:46,214 [INFO] THREAD: Processamento finalizado para 'produtos da coca cola'
2025-08-09 13:58:00,069 [INFO] 172.18.0.1 - - [09/Aug/2025 13:58:00] "POST /webhook HTTP/1.1" 200 -
2025-08-09 13:58:00,070 [INFO] Arquivo de sess√£o encontrado. Carregando.
2025-08-09 13:58:00,071 [INFO] [llm_interface.py] Iniciando get_intent para mensagem: 'quero outros produtos da coca-cola...'
2025-08-09 13:58:00,072 [INFO] [llm_interface.py] Tentando carregar prompt de: ai_llm/gav_prompt.txt
2025-08-09 13:58:00,073 [INFO] [llm_interface.py] Prompt carregado com sucesso. Tamanho: 2326 caracteres
2025-08-09 13:58:00,073 [INFO] [llm_interface.py] System prompt preparado. Tamanho: 2262 caracteres
2025-08-09 13:58:00,073 [INFO] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-09 13:58:00,087 [INFO] [llm_interface.py] Verificando disponibilidade do modelo: llama3.1
2025-08-09 13:58:00,087 [DEBUG] connect_tcp.started host='host.docker.internal' port=11434 local_address=None timeout=None socket_options=None
2025-08-09 13:58:00,089 [DEBUG] connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7f7624b5bbb0>
2025-08-09 13:58:00,090 [DEBUG] send_request_headers.started request=<Request [b'GET']>
2025-08-09 13:58:00,090 [DEBUG] send_request_headers.complete
2025-08-09 13:58:00,090 [DEBUG] send_request_body.started request=<Request [b'GET']>
2025-08-09 13:58:00,090 [DEBUG] send_request_body.complete
2025-08-09 13:58:00,091 [DEBUG] receive_response_headers.started request=<Request [b'GET']>
2025-08-09 13:58:00,092 [DEBUG] receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Sat, 09 Aug 2025 13:58:00 GMT'), (b'Content-Length', b'679')])
2025-08-09 13:58:00,092 [INFO] HTTP Request: GET http://host.docker.internal:11434/api/tags "HTTP/1.1 200 OK"
2025-08-09 13:58:00,092 [DEBUG] receive_response_body.started request=<Request [b'GET']>
2025-08-09 13:58:00,092 [DEBUG] receive_response_body.complete
2025-08-09 13:58:00,093 [DEBUG] response_closed.started
2025-08-09 13:58:00,093 [DEBUG] response_closed.complete
2025-08-09 13:58:00,093 [WARNING] [llm_interface.py] N√£o foi poss√≠vel verificar modelos dispon√≠veis: 'name'
2025-08-09 13:58:00,093 [INFO] [llm_interface.py] Enviando requisi√ß√£o para o modelo llama3.1
2025-08-09 13:58:00,094 [DEBUG] send_request_headers.started request=<Request [b'POST']>
2025-08-09 13:58:00,094 [DEBUG] send_request_headers.complete
2025-08-09 13:58:00,094 [DEBUG] send_request_body.started request=<Request [b'POST']>
2025-08-09 13:58:00,094 [DEBUG] send_request_body.complete
2025-08-09 13:58:00,094 [DEBUG] receive_response_headers.started request=<Request [b'POST']>
2025-08-09 13:58:00,938 [DEBUG] receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Sat, 09 Aug 2025 13:58:00 GMT'), (b'Content-Length', b'394')])
2025-08-09 13:58:00,939 [INFO] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-09 13:58:00,939 [DEBUG] receive_response_body.started request=<Request [b'POST']>
2025-08-09 13:58:00,939 [DEBUG] receive_response_body.complete
2025-08-09 13:58:00,939 [DEBUG] response_closed.started
2025-08-09 13:58:00,939 [DEBUG] response_closed.complete
2025-08-09 13:58:00,940 [INFO] [llm_interface.py] Resposta recebida do LLM. Tamanho: 94 caracteres
2025-08-09 13:58:00,940 [DEBUG] [llm_interface.py] Conte√∫do da resposta: {"tool_name": "get_top_selling_products_by_name", "parameters": {"product_name": "Coca-Cola"}}
2025-08-09 13:58:00,940 [INFO] [llm_interface.py] JSON parseado com sucesso: {'tool_name': 'get_top_selling_products_by_name', 'parameters': {'product_name': 'Coca-Cola'}}
2025-08-09 13:58:00,940 [INFO] INTEN√á√ÉO PROCESSADA: {'tool_name': 'get_top_selling_products_by_name', 'parameters': {'product_name': 'Coca-Cola'}}
2025-08-09 13:58:00,944 [INFO] Salvando sess√£o: {'customer_context': None, 'shopping_cart': [], 'last_search_type': 'by_name', 'last_search_params': {'product_name': 'coca cola'}, 'current_offset': 5, 'last_shown_products': [{'codprod': 13700, 'descricao': 'REFRIG.COCA-COLA PET 2L', 'pvenda': 8.5}], 'last_bot_action': 'AWAITING_PRODUCT_SELECTION', 'pending_action': None, 'last_kb_search_term': 'Coca-Cola'}
2025-08-09 13:58:00,946 [INFO] Enviando mensagem proativa para whatsapp:+5511940726493: 'ü§ñ Encontrei isto para 'Coca-Cola' (busca r√°pida):
1. REFRIG.COCA-COLA PET 2L - R$ 8,50
Me diga o nome ou o n√∫mero do item que deseja adicionar.
'
2025-08-09 13:58:00,946 [INFO] -- BEGIN Twilio API Request --
2025-08-09 13:58:00,946 [INFO] POST Request: https://api.twilio.com/2010-04-01/Accounts/ACad7b82d94a6416ade9b1d19a8194499f/Messages.json
2025-08-09 13:58:00,946 [INFO] Headers:
2025-08-09 13:58:00,946 [INFO] Content-Type : application/x-www-form-urlencoded
2025-08-09 13:58:00,946 [INFO] Accept : application/json
2025-08-09 13:58:00,946 [INFO] User-Agent : twilio-python/9.7.0 (Linux x86_64) Python/3.9.23
2025-08-09 13:58:00,947 [INFO] X-Twilio-Client : python-9.7.0
2025-08-09 13:58:00,947 [INFO] Accept-Charset : utf-8
2025-08-09 13:58:00,947 [INFO] -- END Twilio API Request --
2025-08-09 13:58:01,165 [DEBUG] https://api.twilio.com:443 "POST /2010-04-01/Accounts/ACad7b82d94a6416ade9b1d19a8194499f/Messages.json HTTP/1.1" 201 951
2025-08-09 13:58:01,166 [INFO] Response Status Code: 201
2025-08-09 13:58:01,166 [INFO] Response Headers: {'Content-Type': 'application/json;charset=utf-8', 'Content-Length': '951', 'Connection': 'keep-alive', 'Date': 'Sat, 09 Aug 2025 13:58:01 GMT', 'Twilio-Concurrent-Requests': '1', 'Twilio-Request-Id': 'RQ098738ac77df8f6d4fe7284e0a23b801', 'Twilio-Request-Duration': '0.098', 'X-Home-Region': 'us1', 'X-API-Domain': 'api.twilio.com', 'Strict-Transport-Security': 'max-age=31536000', 'X-Cache': 'Miss from cloudfront', 'Via': '1.1 b32b674425bc91de1120f0cc3dff96dc.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'GRU3-P4', 'X-Amz-Cf-Id': '7AKhwejV3DuxLOcIaRRPDeIDdrU790SKzKJgybgBUIk5TGbGKPCgPw==', 'X-Powered-By': 'AT-5000', 'X-Shenanigans': 'none', 'Vary': 'Origin'}
2025-08-09 13:58:01,166 [INFO] THREAD: Processamento finalizado para 'quero outros produtos da coca-cola'
2025-08-09 13:58:22,011 [INFO] 172.18.0.1 - - [09/Aug/2025 13:58:22] "POST /webhook HTTP/1.1" 200 -
2025-08-09 13:58:22,012 [INFO] Arquivo de sess√£o encontrado. Carregando.
2025-08-09 13:58:22,014 [INFO] [llm_interface.py] Iniciando get_intent para mensagem: 'Quais todos os produtos ?...'
2025-08-09 13:58:22,015 [INFO] [llm_interface.py] Tentando carregar prompt de: ai_llm/gav_prompt.txt
2025-08-09 13:58:22,016 [INFO] [llm_interface.py] Prompt carregado com sucesso. Tamanho: 2326 caracteres
2025-08-09 13:58:22,017 [INFO] [llm_interface.py] System prompt preparado. Tamanho: 2262 caracteres
2025-08-09 13:58:22,017 [INFO] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-09 13:58:22,031 [INFO] [llm_interface.py] Verificando disponibilidade do modelo: llama3.1
2025-08-09 13:58:22,032 [DEBUG] connect_tcp.started host='host.docker.internal' port=11434 local_address=None timeout=None socket_options=None
2025-08-09 13:58:22,035 [DEBUG] connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7f7624b5fdf0>
2025-08-09 13:58:22,035 [DEBUG] send_request_headers.started request=<Request [b'GET']>
2025-08-09 13:58:22,036 [DEBUG] send_request_headers.complete
2025-08-09 13:58:22,037 [DEBUG] send_request_body.started request=<Request [b'GET']>
2025-08-09 13:58:22,039 [DEBUG] send_request_body.complete
2025-08-09 13:58:22,039 [DEBUG] receive_response_headers.started request=<Request [b'GET']>
2025-08-09 13:58:22,040 [DEBUG] receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Sat, 09 Aug 2025 13:58:22 GMT'), (b'Content-Length', b'679')])
2025-08-09 13:58:22,047 [INFO] HTTP Request: GET http://host.docker.internal:11434/api/tags "HTTP/1.1 200 OK"
2025-08-09 13:58:22,047 [DEBUG] receive_response_body.started request=<Request [b'GET']>
2025-08-09 13:58:22,049 [DEBUG] receive_response_body.complete
2025-08-09 13:58:22,049 [DEBUG] response_closed.started
2025-08-09 13:58:22,049 [DEBUG] response_closed.complete
2025-08-09 13:58:22,050 [WARNING] [llm_interface.py] N√£o foi poss√≠vel verificar modelos dispon√≠veis: 'name'
2025-08-09 13:58:22,050 [INFO] [llm_interface.py] Enviando requisi√ß√£o para o modelo llama3.1
2025-08-09 13:58:22,050 [DEBUG] send_request_headers.started request=<Request [b'POST']>
2025-08-09 13:58:22,051 [DEBUG] send_request_headers.complete
2025-08-09 13:58:22,051 [DEBUG] send_request_body.started request=<Request [b'POST']>
2025-08-09 13:58:22,051 [DEBUG] send_request_body.complete
2025-08-09 13:58:22,052 [DEBUG] receive_response_headers.started request=<Request [b'POST']>
2025-08-09 13:58:22,737 [DEBUG] receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Sat, 09 Aug 2025 13:58:22 GMT'), (b'Content-Length', b'355')])
2025-08-09 13:58:22,738 [INFO] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-09 13:58:22,738 [DEBUG] receive_response_body.started request=<Request [b'POST']>
2025-08-09 13:58:22,738 [DEBUG] receive_response_body.complete
2025-08-09 13:58:22,738 [DEBUG] response_closed.started
2025-08-09 13:58:22,738 [DEBUG] response_closed.complete
2025-08-09 13:58:22,739 [INFO] [llm_interface.py] Resposta recebida do LLM. Tamanho: 59 caracteres
2025-08-09 13:58:22,739 [DEBUG] [llm_interface.py] Conte√∫do da resposta: {"tool_name": "get_top_selling_products", "parameters": {}}
2025-08-09 13:58:22,739 [INFO] [llm_interface.py] JSON parseado com sucesso: {'tool_name': 'get_top_selling_products', 'parameters': {}}
2025-08-09 13:58:22,739 [INFO] INTEN√á√ÉO PROCESSADA: {'tool_name': 'get_top_selling_products', 'parameters': {}}
2025-08-09 13:58:22,746 [INFO] Salvando sess√£o: {'customer_context': None, 'shopping_cart': [], 'last_search_type': 'top_selling', 'last_search_params': {}, 'current_offset': 5, 'last_shown_products': [], 'last_bot_action': 'AWAITING_PRODUCT_SELECTION', 'pending_action': None, 'last_kb_search_term': None}
2025-08-09 13:58:22,748 [INFO] Enviando mensagem proativa para whatsapp:+5511940726493: 'ü§ñ Estes s√£o nossos produtos mais populares:
Nenhum produto encontrado com esse crit√©rio.'
2025-08-09 13:58:22,748 [INFO] -- BEGIN Twilio API Request --
2025-08-09 13:58:22,749 [INFO] POST Request: https://api.twilio.com/2010-04-01/Accounts/ACad7b82d94a6416ade9b1d19a8194499f/Messages.json
2025-08-09 13:58:22,749 [INFO] Headers:
2025-08-09 13:58:22,749 [INFO] Content-Type : application/x-www-form-urlencoded
2025-08-09 13:58:22,749 [INFO] Accept : application/json
2025-08-09 13:58:22,749 [INFO] User-Agent : twilio-python/9.7.0 (Linux x86_64) Python/3.9.23
2025-08-09 13:58:22,749 [INFO] X-Twilio-Client : python-9.7.0
2025-08-09 13:58:22,749 [INFO] Accept-Charset : utf-8
2025-08-09 13:58:22,750 [INFO] -- END Twilio API Request --
2025-08-09 13:58:22,969 [DEBUG] https://api.twilio.com:443 "POST /2010-04-01/Accounts/ACad7b82d94a6416ade9b1d19a8194499f/Messages.json HTTP/1.1" 201 893
2025-08-09 13:58:22,970 [INFO] Response Status Code: 201
2025-08-09 13:58:22,970 [INFO] Response Headers: {'Content-Type': 'application/json;charset=utf-8', 'Content-Length': '893', 'Connection': 'keep-alive', 'Date': 'Sat, 09 Aug 2025 13:58:22 GMT', 'Twilio-Concurrent-Requests': '1', 'Twilio-Request-Id': 'RQ944004c9fdb87e7d598dd400df690b95', 'Twilio-Request-Duration': '0.100', 'X-Home-Region': 'us1', 'X-API-Domain': 'api.twilio.com', 'Strict-Transport-Security': 'max-age=31536000', 'X-Cache': 'Miss from cloudfront', 'Via': '1.1 b32b674425bc91de1120f0cc3dff96dc.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'GRU3-P4', 'X-Amz-Cf-Id': 'DLticMYFbaPHqkUbIac27xlgMMoqoAX7Hzo41zh0JI_op91aNBEx6g==', 'X-Powered-By': 'AT-5000', 'X-Shenanigans': 'none', 'Vary': 'Origin'}
2025-08-09 13:58:22,970 [INFO] THREAD: Processamento finalizado para 'Quais todos os produtos ?'
2025-08-09 14:00:12,885 [INFO] 172.18.0.1 - - [09/Aug/2025 14:00:12] "POST /webhook HTTP/1.1" 200 -
2025-08-09 14:00:12,887 [INFO] Arquivo de sess√£o encontrado. Carregando.
2025-08-09 14:00:12,889 [INFO] [llm_interface.py] Iniciando get_intent para mensagem: 'quais todos os produtos da coca cola?...'
2025-08-09 14:00:12,889 [INFO] [llm_interface.py] Tentando carregar prompt de: ai_llm/gav_prompt.txt
2025-08-09 14:00:12,890 [INFO] [llm_interface.py] Prompt carregado com sucesso. Tamanho: 2326 caracteres
2025-08-09 14:00:12,891 [INFO] [llm_interface.py] System prompt preparado. Tamanho: 2262 caracteres
2025-08-09 14:00:12,891 [INFO] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-09 14:00:12,904 [INFO] [llm_interface.py] Verificando disponibilidade do modelo: llama3.1
2025-08-09 14:00:12,904 [DEBUG] connect_tcp.started host='host.docker.internal' port=11434 local_address=None timeout=None socket_options=None
2025-08-09 14:00:12,906 [DEBUG] connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7f76271006d0>
2025-08-09 14:00:12,907 [DEBUG] send_request_headers.started request=<Request [b'GET']>
2025-08-09 14:00:12,910 [DEBUG] send_request_headers.complete
2025-08-09 14:00:12,911 [DEBUG] send_request_body.started request=<Request [b'GET']>
2025-08-09 14:00:12,911 [DEBUG] send_request_body.complete
2025-08-09 14:00:12,912 [DEBUG] receive_response_headers.started request=<Request [b'GET']>
2025-08-09 14:00:12,914 [DEBUG] receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Sat, 09 Aug 2025 14:00:12 GMT'), (b'Content-Length', b'679')])
2025-08-09 14:00:12,914 [INFO] HTTP Request: GET http://host.docker.internal:11434/api/tags "HTTP/1.1 200 OK"
2025-08-09 14:00:12,914 [DEBUG] receive_response_body.started request=<Request [b'GET']>
2025-08-09 14:00:12,914 [DEBUG] receive_response_body.complete
2025-08-09 14:00:12,914 [DEBUG] response_closed.started
2025-08-09 14:00:12,915 [DEBUG] response_closed.complete
2025-08-09 14:00:12,915 [WARNING] [llm_interface.py] N√£o foi poss√≠vel verificar modelos dispon√≠veis: 'name'
2025-08-09 14:00:12,915 [INFO] [llm_interface.py] Enviando requisi√ß√£o para o modelo llama3.1
2025-08-09 14:00:12,915 [DEBUG] send_request_headers.started request=<Request [b'POST']>
2025-08-09 14:00:12,916 [DEBUG] send_request_headers.complete
2025-08-09 14:00:12,916 [DEBUG] send_request_body.started request=<Request [b'POST']>
2025-08-09 14:00:12,916 [DEBUG] send_request_body.complete
2025-08-09 14:00:12,917 [DEBUG] receive_response_headers.started request=<Request [b'POST']>
2025-08-09 14:00:13,911 [DEBUG] receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Sat, 09 Aug 2025 14:00:13 GMT'), (b'Content-Length', b'394')])
2025-08-09 14:00:13,911 [INFO] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-09 14:00:13,912 [DEBUG] receive_response_body.started request=<Request [b'POST']>
2025-08-09 14:00:13,912 [DEBUG] receive_response_body.complete
2025-08-09 14:00:13,912 [DEBUG] response_closed.started
2025-08-09 14:00:13,912 [DEBUG] response_closed.complete
2025-08-09 14:00:13,913 [INFO] [llm_interface.py] Resposta recebida do LLM. Tamanho: 94 caracteres
2025-08-09 14:00:13,913 [DEBUG] [llm_interface.py] Conte√∫do da resposta: {"tool_name": "get_top_selling_products_by_name", "parameters": {"product_name": "Coca Cola"}}
2025-08-09 14:00:13,913 [INFO] [llm_interface.py] JSON parseado com sucesso: {'tool_name': 'get_top_selling_products_by_name', 'parameters': {'product_name': 'Coca Cola'}}
2025-08-09 14:00:13,913 [INFO] INTEN√á√ÉO PROCESSADA: {'tool_name': 'get_top_selling_products_by_name', 'parameters': {'product_name': 'Coca Cola'}}
2025-08-09 14:00:13,917 [INFO] Salvando sess√£o: {'customer_context': None, 'shopping_cart': [], 'last_search_type': 'top_selling', 'last_search_params': {}, 'current_offset': 5, 'last_shown_products': [{'codprod': 13700, 'descricao': 'REFRIG.COCA-COLA PET 2L', 'pvenda': 8.5}], 'last_bot_action': 'AWAITING_PRODUCT_SELECTION', 'pending_action': None, 'last_kb_search_term': 'Coca Cola'}
2025-08-09 14:00:13,920 [INFO] Enviando mensagem proativa para whatsapp:+5511940726493: 'ü§ñ Encontrei isto para 'Coca Cola' (busca r√°pida):
1. REFRIG.COCA-COLA PET 2L - R$ 8,50
Me diga o nome ou o n√∫mero do item que deseja adicionar.
'
2025-08-09 14:00:13,920 [INFO] -- BEGIN Twilio API Request --
2025-08-09 14:00:13,921 [INFO] POST Request: https://api.twilio.com/2010-04-01/Accounts/ACad7b82d94a6416ade9b1d19a8194499f/Messages.json
2025-08-09 14:00:13,921 [INFO] Headers:
2025-08-09 14:00:13,921 [INFO] Content-Type : application/x-www-form-urlencoded
2025-08-09 14:00:13,921 [INFO] Accept : application/json
2025-08-09 14:00:13,921 [INFO] User-Agent : twilio-python/9.7.0 (Linux x86_64) Python/3.9.23
2025-08-09 14:00:13,922 [INFO] X-Twilio-Client : python-9.7.0
2025-08-09 14:00:13,922 [INFO] Accept-Charset : utf-8
2025-08-09 14:00:13,922 [INFO] -- END Twilio API Request --
2025-08-09 14:00:14,142 [DEBUG] https://api.twilio.com:443 "POST /2010-04-01/Accounts/ACad7b82d94a6416ade9b1d19a8194499f/Messages.json HTTP/1.1" 201 951
2025-08-09 14:00:14,143 [INFO] Response Status Code: 201
2025-08-09 14:00:14,143 [INFO] Response Headers: {'Content-Type': 'application/json;charset=utf-8', 'Content-Length': '951', 'Connection': 'keep-alive', 'Date': 'Sat, 09 Aug 2025 14:00:14 GMT', 'Twilio-Concurrent-Requests': '1', 'Twilio-Request-Id': 'RQ42c4926d9c97cffc87912c261c664e63', 'Twilio-Request-Duration': '0.098', 'X-Home-Region': 'us1', 'X-API-Domain': 'api.twilio.com', 'Strict-Transport-Security': 'max-age=31536000', 'X-Cache': 'Miss from cloudfront', 'Via': '1.1 b32b674425bc91de1120f0cc3dff96dc.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'GRU3-P4', 'X-Amz-Cf-Id': 'Ubm9HE0vQsG-B9w5G2WDvsGMMLnrTuvw5SoLjgi45521dVeQeFrC1w==', 'X-Powered-By': 'AT-5000', 'X-Shenanigans': 'none', 'Vary': 'Origin'}
2025-08-09 14:00:14,144 [INFO] THREAD: Processamento finalizado para 'quais todos os produtos da coca cola?'
2025-08-09 14:03:47,356 [INFO]  * Detected change in '/app/knowledge/knowledge.py', reloading
2025-08-09 14:03:47,401 [INFO]  * Restarting with stat
2025-08-09 14:03:48,133 [WARNING]  * Debugger is active!
2025-08-09 14:03:48,135 [INFO]  * Debugger PIN: 323-075-203
2025-08-09 14:04:32,341 [INFO] [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8080
 * Running on http://172.18.0.3:8080
2025-08-09 14:04:32,342 [INFO] [33mPress CTRL+C to quit[0m
2025-08-09 14:04:32,342 [INFO]  * Restarting with stat
2025-08-09 14:04:32,979 [WARNING]  * Debugger is active!
2025-08-09 14:04:32,980 [INFO]  * Debugger PIN: 124-228-871
