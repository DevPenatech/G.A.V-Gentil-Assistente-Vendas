2025-08-12 18:10:18,878 [INFO] [root:534] [setup_main_logging] üöÄ Sistema de logging G.A.V. inicializado
2025-08-12 18:10:18,951 [INFO] [root:21] [<module>] Cliente Twilio inicializado com sucesso
2025-08-12 18:10:18,984 [INFO] [werkzeug:97] [_log] [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8080
 * Running on http://172.18.0.4:8080
2025-08-12 18:10:18,985 [INFO] [werkzeug:97] [_log] [33mPress CTRL+C to quit[0m
2025-08-12 18:10:18,986 [INFO] [werkzeug:97] [_log]  * Restarting with stat
2025-08-12 18:10:19,659 [INFO] [root:534] [setup_main_logging] üöÄ Sistema de logging G.A.V. inicializado
2025-08-12 18:10:19,727 [INFO] [root:21] [<module>] Cliente Twilio inicializado com sucesso
2025-08-12 18:10:19,757 [WARNING] [werkzeug:97] [_log]  * Debugger is active!
2025-08-12 18:10:19,759 [INFO] [werkzeug:97] [_log]  * Debugger PIN: 903-193-335
2025-08-12 18:10:23,262 [INFO] [werkzeug:97] [_log] 172.18.0.1 - - [12/Aug/2025 18:10:23] "POST /webhook HTTP/1.1" 200 -
2025-08-12 18:10:23,265 [DEBUG] [root:94] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 18:10:23,272 [DEBUG] [root:133] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 18:10:23,276 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'ü§ñ Ol√°! Como posso ajudar voc√™ hoje?'
2025-08-12 18:10:23,654 [ERROR] [root:61] [send_whatsapp_message] Falha ao enviar mensagem via API da Twilio: HTTP 429 error: Unable to create record: Account ACd2a6cd60871d661c034ecb40ddbd51e7 exceeded the 9 daily messages limit
2025-08-12 18:10:23,656 [ERROR] [root:65] [send_whatsapp_message] Limite de mensagens di√°rio atingido
2025-08-12 18:10:23,657 [INFO] [root:1386] [process_message_async] THREAD: Processamento finalizado para 'Oi'
2025-08-12 18:10:32,825 [INFO] [werkzeug:97] [_log] 172.18.0.1 - - [12/Aug/2025 18:10:32] "POST /webhook HTTP/1.1" 200 -
2025-08-12 18:10:32,828 [DEBUG] [root:94] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 18:10:32,832 [DEBUG] [root:133] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 18:10:32,833 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'üõí *SEU CARRINHO:*
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
*1.* REFRIG.COCA-COLA LT 350ML
   10√ó R$ 4,20 = *R$ 42,00*

*...'
2025-08-12 18:10:33,041 [ERROR] [root:61] [send_whatsapp_message] Falha ao enviar mensagem via API da Twilio: HTTP 429 error: Unable to create record: Account ACd2a6cd60871d661c034ecb40ddbd51e7 exceeded the 9 daily messages limit
2025-08-12 18:10:33,042 [ERROR] [root:65] [send_whatsapp_message] Limite de mensagens di√°rio atingido
2025-08-12 18:10:33,043 [INFO] [root:1386] [process_message_async] THREAD: Processamento finalizado para 'meu carrinho'
2025-08-12 18:10:41,645 [INFO] [werkzeug:97] [_log] 172.18.0.1 - - [12/Aug/2025 18:10:41] "POST /webhook HTTP/1.1" 200 -
2025-08-12 18:10:41,651 [DEBUG] [root:94] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 18:10:41,659 [DEBUG] [root:133] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 18:10:41,660 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'üõí *SEU CARRINHO:*
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
*1.* REFRIG.COCA-COLA LT 350ML
   10√ó R$ 4,20 = *R$ 42,00*

*...'
2025-08-12 18:10:41,833 [ERROR] [root:61] [send_whatsapp_message] Falha ao enviar mensagem via API da Twilio: HTTP 429 error: Unable to create record: Account ACd2a6cd60871d661c034ecb40ddbd51e7 exceeded the 9 daily messages limit
2025-08-12 18:10:41,835 [ERROR] [root:65] [send_whatsapp_message] Limite de mensagens di√°rio atingido
2025-08-12 18:10:41,837 [INFO] [root:1386] [process_message_async] THREAD: Processamento finalizado para 'esvaziar carrinho'
2025-08-12 18:10:56,311 [INFO] [werkzeug:97] [_log] 172.18.0.1 - - [12/Aug/2025 18:10:56] "POST /webhook HTTP/1.1" 200 -
2025-08-12 18:10:56,316 [DEBUG] [root:94] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 18:10:56,331 [DEBUG] [root:133] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 18:10:56,332 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'ü§ñ N√£o encontrei esse item no carrinho.

üõí *SEU CARRINHO:*
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
*1.* REFRIG.COCA-COLA...'
2025-08-12 18:10:56,506 [ERROR] [root:61] [send_whatsapp_message] Falha ao enviar mensagem via API da Twilio: HTTP 429 error: Unable to create record: Account ACd2a6cd60871d661c034ecb40ddbd51e7 exceeded the 9 daily messages limit
2025-08-12 18:10:56,508 [ERROR] [root:65] [send_whatsapp_message] Limite de mensagens di√°rio atingido
2025-08-12 18:10:56,509 [INFO] [root:1386] [process_message_async] THREAD: Processamento finalizado para 'remover item'
2025-08-12 18:11:04,227 [INFO] [werkzeug:97] [_log] 172.18.0.1 - - [12/Aug/2025 18:11:04] "POST /webhook HTTP/1.1" 200 -
2025-08-12 18:11:04,233 [DEBUG] [root:94] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 18:11:04,238 [DEBUG] [root:133] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 18:11:04,239 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'ü§ñ Ol√°! Como posso ajudar voc√™ hoje?'
2025-08-12 18:11:04,415 [ERROR] [root:61] [send_whatsapp_message] Falha ao enviar mensagem via API da Twilio: HTTP 429 error: Unable to create record: Account ACd2a6cd60871d661c034ecb40ddbd51e7 exceeded the 9 daily messages limit
2025-08-12 18:11:04,421 [ERROR] [root:65] [send_whatsapp_message] Limite de mensagens di√°rio atingido
2025-08-12 18:11:04,427 [INFO] [root:1386] [process_message_async] THREAD: Processamento finalizado para 'remover coca cola'
2025-08-12 18:11:17,568 [INFO] [werkzeug:97] [_log] 172.18.0.1 - - [12/Aug/2025 18:11:17] "POST /webhook HTTP/1.1" 200 -
2025-08-12 18:11:17,576 [DEBUG] [root:94] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 18:11:17,583 [DEBUG] [root:133] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 18:11:17,584 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'üõí *SEU CARRINHO:*
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
*1.* REFRIG.COCA-COLA LT 350ML
   10√ó R$ 4,20 = *R$ 42,00*

*...'
2025-08-12 18:11:17,771 [ERROR] [root:61] [send_whatsapp_message] Falha ao enviar mensagem via API da Twilio: HTTP 429 error: Unable to create record: Account ACd2a6cd60871d661c034ecb40ddbd51e7 exceeded the 9 daily messages limit
2025-08-12 18:11:17,773 [ERROR] [root:65] [send_whatsapp_message] Limite de mensagens di√°rio atingido
2025-08-12 18:11:17,774 [INFO] [root:1386] [process_message_async] THREAD: Processamento finalizado para 'remover coca cola do carrinho'
2025-08-12 18:11:28,917 [INFO] [werkzeug:97] [_log] 172.18.0.1 - - [12/Aug/2025 18:11:28] "POST /webhook HTTP/1.1" 200 -
2025-08-12 18:11:28,924 [DEBUG] [root:94] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 18:11:28,928 [DEBUG] [root:133] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 18:11:28,928 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'üõí *SEU CARRINHO:*
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
*1.* REFRIG.COCA-COLA LT 350ML
   10√ó R$ 4,20 = *R$ 42,00*

*...'
2025-08-12 18:11:29,119 [ERROR] [root:61] [send_whatsapp_message] Falha ao enviar mensagem via API da Twilio: HTTP 429 error: Unable to create record: Account ACd2a6cd60871d661c034ecb40ddbd51e7 exceeded the 9 daily messages limit
2025-08-12 18:11:29,121 [ERROR] [root:65] [send_whatsapp_message] Limite de mensagens di√°rio atingido
2025-08-12 18:11:29,123 [INFO] [root:1386] [process_message_async] THREAD: Processamento finalizado para 'limpar carrinho'
2025-08-12 18:15:28,870 [INFO] [werkzeug:97] [_log]  * Detected change in '/app/core/session_manager.py', reloading
2025-08-12 18:15:28,937 [INFO] [werkzeug:97] [_log]  * Restarting with stat
2025-08-12 18:15:29,909 [INFO] [root:534] [setup_main_logging] üöÄ Sistema de logging G.A.V. inicializado
2025-08-12 18:15:29,998 [INFO] [root:21] [<module>] Cliente Twilio inicializado com sucesso
2025-08-12 18:15:30,034 [WARNING] [werkzeug:97] [_log]  * Debugger is active!
2025-08-12 18:15:30,035 [INFO] [werkzeug:97] [_log]  * Debugger PIN: 903-193-335
2025-08-12 18:18:24,680 [INFO] [werkzeug:97] [_log]  * Detected change in '/app/app.py', reloading
2025-08-12 18:18:24,729 [INFO] [werkzeug:97] [_log]  * Restarting with stat
2025-08-12 18:18:25,444 [INFO] [root:534] [setup_main_logging] üöÄ Sistema de logging G.A.V. inicializado
2025-08-12 18:18:25,511 [INFO] [root:21] [<module>] Cliente Twilio inicializado com sucesso
2025-08-12 18:18:25,537 [WARNING] [werkzeug:97] [_log]  * Debugger is active!
2025-08-12 18:18:25,539 [INFO] [werkzeug:97] [_log]  * Debugger PIN: 903-193-335
2025-08-12 18:18:34,567 [INFO] [werkzeug:97] [_log] 172.18.0.1 - - [12/Aug/2025 18:18:34] "POST /webhook HTTP/1.1" 200 -
2025-08-12 18:18:34,572 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 18:18:34,574 [INFO] [root:378] [detect_user_intent_type] [INTENT] Comando de limpeza detectado: 'esvaziar carrinho'
2025-08-12 18:18:34,578 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 18:18:34,578 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'üóëÔ∏è Carrinho esvaziado! 2 itens removidos.

üîç Digite o nome do produto
üì¶ Digite *produtos* para ver o...'
2025-08-12 18:18:35,152 [ERROR] [root:61] [send_whatsapp_message] Falha ao enviar mensagem via API da Twilio: HTTP 429 error: Unable to create record: Account ACd2a6cd60871d661c034ecb40ddbd51e7 exceeded the 9 daily messages limit
2025-08-12 18:18:35,154 [ERROR] [root:65] [send_whatsapp_message] Limite de mensagens di√°rio atingido
2025-08-12 18:18:35,155 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para 'esvaziar carrinho'
2025-08-12 18:18:48,034 [INFO] [werkzeug:97] [_log] 172.18.0.1 - - [12/Aug/2025 18:18:48] "POST /webhook HTTP/1.1" 200 -
2025-08-12 18:18:48,041 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 18:18:48,055 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 18:18:48,056 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'üõí Seu carrinho est√° vazio.

üîç Digite o nome do produto
üì¶ Digite *produtos* para ver os mais vendidos...'
2025-08-12 18:18:48,274 [ERROR] [root:61] [send_whatsapp_message] Falha ao enviar mensagem via API da Twilio: HTTP 429 error: Unable to create record: Account ACd2a6cd60871d661c034ecb40ddbd51e7 exceeded the 9 daily messages limit
2025-08-12 18:18:48,275 [ERROR] [root:65] [send_whatsapp_message] Limite de mensagens di√°rio atingido
2025-08-12 18:18:48,276 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para 'meu carrinho'
2025-08-12 18:18:55,210 [INFO] [werkzeug:97] [_log] 172.18.0.1 - - [12/Aug/2025 18:18:55] "POST /webhook HTTP/1.1" 200 -
2025-08-12 18:18:55,214 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 18:18:55,215 [INFO] [root:436] [get_intent] [llm_interface.py] Iniciando get_intent para mensagem: 'quero coca cola'
2025-08-12 18:18:55,216 [INFO] [root:187] [load_prompt_template] [llm_interface.py] Carregando prompt de: ai_llm/gav_prompt.txt
2025-08-12 18:18:55,218 [INFO] [root:192] [load_prompt_template] [llm_interface.py] Prompt carregado e cacheado. Tamanho: 5500 caracteres
2025-08-12 18:18:55,220 [INFO] [root:482] [get_intent] [llm_interface.py] System prompt preparado. Tamanho: 5500 caracteres
2025-08-12 18:18:55,236 [INFO] [root:573] [get_intent] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-12 18:18:55,239 [DEBUG] [httpcore.connection:47] [trace] connect_tcp.started host='host.docker.internal' port=11434 local_address=None timeout=None socket_options=None
2025-08-12 18:18:55,242 [DEBUG] [httpcore.connection:47] [trace] connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7fa47836e070>
2025-08-12 18:18:55,242 [DEBUG] [httpcore.http11:47] [trace] send_request_headers.started request=<Request [b'POST']>
2025-08-12 18:18:55,243 [DEBUG] [httpcore.http11:47] [trace] send_request_headers.complete
2025-08-12 18:18:55,244 [DEBUG] [httpcore.http11:47] [trace] send_request_body.started request=<Request [b'POST']>
2025-08-12 18:18:55,244 [DEBUG] [httpcore.http11:47] [trace] send_request_body.complete
2025-08-12 18:18:55,245 [DEBUG] [httpcore.http11:47] [trace] receive_response_headers.started request=<Request [b'POST']>
2025-08-12 18:18:59,801 [DEBUG] [httpcore.http11:47] [trace] receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 12 Aug 2025 18:18:59 GMT'), (b'Content-Length', b'334')])
2025-08-12 18:18:59,803 [INFO] [httpx:1025] [_send_single_request] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-12 18:18:59,804 [DEBUG] [httpcore.http11:47] [trace] receive_response_body.started request=<Request [b'POST']>
2025-08-12 18:18:59,805 [DEBUG] [httpcore.http11:47] [trace] receive_response_body.complete
2025-08-12 18:18:59,806 [DEBUG] [httpcore.http11:47] [trace] response_closed.started
2025-08-12 18:18:59,806 [DEBUG] [httpcore.http11:47] [trace] response_closed.complete
2025-08-12 18:18:59,807 [INFO] [root:592] [get_intent] [llm_interface.py] Resposta recebida do LLM em 4.57s
2025-08-12 18:18:59,808 [INFO] [root:604] [get_intent] [llm_interface.py] Resposta do LLM: **AN√ÅLISE DA MENSAGEM DO USU√ÅRIO:**...
2025-08-12 18:18:59,809 [DEBUG] [root:607] [get_intent] [llm_interface.py] Conte√∫do limpo: **AN√ÅLISE DA MENSAGEM DO USU√ÅRIO:**
2025-08-12 18:18:59,810 [ERROR] [root:644] [get_intent] [llm_interface.py] Erro ao parsear JSON: Expecting value: line 1 column 1 (char 0)
2025-08-12 18:18:59,816 [INFO] [root:101] [_load_kb] Base de conhecimento '/app/knowledge/knowledge_base.json' carregada com 3 produtos e 59 termos.
2025-08-12 18:18:59,817 [INFO] [root:156] [find_product_in_kb] [KB] Busca exata encontrou: coca cola
2025-08-12 18:18:59,835 [INFO] [root:352] [fuzzy_search_products] [FUZZY] Busca fuzzy no banco para: 'coca cola'
2025-08-12 18:18:59,840 [INFO] [root:397] [fuzzy_search_products] [FUZZY] Retornando 2 produtos do banco
2025-08-12 18:18:59,844 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 18:18:59,845 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'üì¶ *üì¶ Encontrei estes produtos relacionados a 'coca cola'::*

*1.* REFRIG.COCA-COLA PET 2L
    üí∞ R$ 8...'
2025-08-12 18:19:00,063 [ERROR] [root:61] [send_whatsapp_message] Falha ao enviar mensagem via API da Twilio: HTTP 429 error: Unable to create record: Account ACd2a6cd60871d661c034ecb40ddbd51e7 exceeded the 9 daily messages limit
2025-08-12 18:19:00,075 [ERROR] [root:65] [send_whatsapp_message] Limite de mensagens di√°rio atingido
2025-08-12 18:19:00,084 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para 'quero coca cola'
2025-08-12 18:19:05,959 [INFO] [werkzeug:97] [_log] 172.18.0.1 - - [12/Aug/2025 18:19:05] "POST /webhook HTTP/1.1" 200 -
2025-08-12 18:19:05,963 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 18:19:05,968 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 18:19:05,971 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'Quantas unidades de REFRIG.COCA-COLA LT 350ML voc√™ deseja adicionar?'
2025-08-12 18:19:06,176 [ERROR] [root:61] [send_whatsapp_message] Falha ao enviar mensagem via API da Twilio: HTTP 429 error: Unable to create record: Account ACd2a6cd60871d661c034ecb40ddbd51e7 exceeded the 9 daily messages limit
2025-08-12 18:19:06,177 [ERROR] [root:65] [send_whatsapp_message] Limite de mensagens di√°rio atingido
2025-08-12 18:19:06,178 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para '2'
2025-08-12 18:19:15,051 [INFO] [werkzeug:97] [_log] 172.18.0.1 - - [12/Aug/2025 18:19:15] "POST /webhook HTTP/1.1" 200 -
2025-08-12 18:19:15,058 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 18:19:15,064 [INFO] [root:263] [update_kb] KB atualizado com novo termo relacionado 'coca cola'
2025-08-12 18:19:15,078 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 18:19:15,079 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: '‚úÖ Perfeito! Adicionei 10 REFRIG.COCA-COLA LT 350ML ao seu carrinho.

üõí *SEU CARRINHO:*
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ...'
2025-08-12 18:19:15,367 [ERROR] [root:61] [send_whatsapp_message] Falha ao enviar mensagem via API da Twilio: HTTP 429 error: Unable to create record: Account ACd2a6cd60871d661c034ecb40ddbd51e7 exceeded the 9 daily messages limit
2025-08-12 18:19:15,370 [ERROR] [root:65] [send_whatsapp_message] Limite de mensagens di√°rio atingido
2025-08-12 18:19:15,372 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para '10'
2025-08-12 18:19:22,209 [INFO] [werkzeug:97] [_log] 172.18.0.1 - - [12/Aug/2025 18:19:22] "POST /webhook HTTP/1.1" 200 -
2025-08-12 18:19:22,212 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 18:19:22,215 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 18:19:22,216 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'üõí *SEU CARRINHO:*
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
*1.* REFRIG.COCA-COLA LT 350ML
   10√ó R$ 4,20 = *R$ 42,00*

‚îÅ...'
2025-08-12 18:19:22,468 [ERROR] [root:61] [send_whatsapp_message] Falha ao enviar mensagem via API da Twilio: HTTP 429 error: Unable to create record: Account ACd2a6cd60871d661c034ecb40ddbd51e7 exceeded the 9 daily messages limit
2025-08-12 18:19:22,470 [ERROR] [root:65] [send_whatsapp_message] Limite de mensagens di√°rio atingido
2025-08-12 18:19:22,472 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para 'meu carrinho'
2025-08-12 18:19:33,665 [INFO] [werkzeug:97] [_log] 172.18.0.1 - - [12/Aug/2025 18:19:33] "POST /webhook HTTP/1.1" 200 -
2025-08-12 18:19:33,670 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 18:19:33,673 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 18:19:33,674 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'ü§ñ Ol√°! Como posso ajudar voc√™ hoje?'
2025-08-12 18:19:33,983 [ERROR] [root:61] [send_whatsapp_message] Falha ao enviar mensagem via API da Twilio: HTTP 429 error: Unable to create record: Account ACd2a6cd60871d661c034ecb40ddbd51e7 exceeded the 9 daily messages limit
2025-08-12 18:19:33,987 [ERROR] [root:65] [send_whatsapp_message] Limite de mensagens di√°rio atingido
2025-08-12 18:19:33,989 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para 'Adiciona mais 5 coca cola'
2025-08-12 18:19:53,722 [INFO] [werkzeug:97] [_log] 172.18.0.1 - - [12/Aug/2025 18:19:53] "POST /webhook HTTP/1.1" 200 -
2025-08-12 18:19:53,726 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 18:19:53,730 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 18:19:53,732 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'üõí *SEU CARRINHO:*
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
*1.* REFRIG.COCA-COLA LT 350ML
   10√ó R$ 4,20 = *R$ 42,00*

‚îÅ...'
2025-08-12 18:19:53,959 [ERROR] [root:61] [send_whatsapp_message] Falha ao enviar mensagem via API da Twilio: HTTP 429 error: Unable to create record: Account ACd2a6cd60871d661c034ecb40ddbd51e7 exceeded the 9 daily messages limit
2025-08-12 18:19:53,961 [ERROR] [root:65] [send_whatsapp_message] Limite de mensagens di√°rio atingido
2025-08-12 18:19:53,962 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para 'mudar item do carrinho'
2025-08-12 18:20:18,282 [INFO] [werkzeug:97] [_log] 172.18.0.1 - - [12/Aug/2025 18:20:18] "POST /webhook HTTP/1.1" 200 -
2025-08-12 18:20:18,287 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 18:20:18,291 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 18:20:18,291 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: '‚≠ê Para finalizar a compra, preciso do seu CNPJ.'
2025-08-12 18:20:18,492 [ERROR] [root:61] [send_whatsapp_message] Falha ao enviar mensagem via API da Twilio: HTTP 429 error: Unable to create record: Account ACd2a6cd60871d661c034ecb40ddbd51e7 exceeded the 9 daily messages limit
2025-08-12 18:20:18,495 [ERROR] [root:65] [send_whatsapp_message] Limite de mensagens di√°rio atingido
2025-08-12 18:20:18,496 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para 'finalizar'
2025-08-12 18:20:31,377 [INFO] [werkzeug:97] [_log] 172.18.0.1 - - [12/Aug/2025 18:20:31] "POST /webhook HTTP/1.1" 200 -
2025-08-12 18:20:31,381 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 18:20:31,393 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 18:20:31,393 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'ü§ñ N√£o encontrei um cliente com o CNPJ 12345678910236. Mas posso registrar seu pedido mesmo assim!

‚úÖ...'
2025-08-12 18:20:31,639 [ERROR] [root:61] [send_whatsapp_message] Falha ao enviar mensagem via API da Twilio: HTTP 429 error: Unable to create record: Account ACd2a6cd60871d661c034ecb40ddbd51e7 exceeded the 9 daily messages limit
2025-08-12 18:20:31,641 [ERROR] [root:65] [send_whatsapp_message] Limite de mensagens di√°rio atingido
2025-08-12 18:20:31,642 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para '12345678910236'
2025-08-12 20:32:10,499 [INFO] [root:534] [setup_main_logging] üöÄ Sistema de logging G.A.V. inicializado
2025-08-12 20:32:10,589 [INFO] [root:21] [<module>] Cliente Twilio inicializado com sucesso
2025-08-12 20:32:10,631 [INFO] [werkzeug:97] [_log] [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8080
 * Running on http://172.20.0.4:8080
2025-08-12 20:32:10,632 [INFO] [werkzeug:97] [_log] [33mPress CTRL+C to quit[0m
2025-08-12 20:32:10,635 [INFO] [werkzeug:97] [_log]  * Restarting with stat
2025-08-12 20:32:11,441 [INFO] [root:534] [setup_main_logging] üöÄ Sistema de logging G.A.V. inicializado
2025-08-12 20:32:11,526 [INFO] [root:21] [<module>] Cliente Twilio inicializado com sucesso
2025-08-12 20:32:11,559 [WARNING] [werkzeug:97] [_log]  * Debugger is active!
2025-08-12 20:32:11,561 [INFO] [werkzeug:97] [_log]  * Debugger PIN: 353-219-865
2025-08-12 20:34:37,870 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [12/Aug/2025 20:34:37] "POST /webhook HTTP/1.1" 200 -
2025-08-12 20:34:37,874 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:34:37,880 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:34:37,880 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'ü§ñ Ol√°! Como posso ajudar voc√™ hoje?'
2025-08-12 20:34:38,211 [INFO] [root:57] [send_whatsapp_message] Mensagem enviada com sucesso. SID: SM85303fe36a63c5091bb554d9e4ff3ad1
2025-08-12 20:34:38,213 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para 'Oi'
2025-08-12 20:34:48,355 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [12/Aug/2025 20:34:48] "POST /webhook HTTP/1.1" 200 -
2025-08-12 20:34:48,358 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:34:48,366 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:34:48,367 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'üõí Seu carrinho est√° vazio.

üîç Digite o nome do produto
üì¶ Digite *produtos* para ver os mais vendidos...'
2025-08-12 20:34:48,583 [INFO] [root:57] [send_whatsapp_message] Mensagem enviada com sucesso. SID: SM0df0392f32bc9ba4a628d5326a6e3197
2025-08-12 20:34:48,584 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para 'meu carrinho'
2025-08-12 20:34:55,471 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [12/Aug/2025 20:34:55] "POST /webhook HTTP/1.1" 200 -
2025-08-12 20:34:55,475 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:34:55,479 [INFO] [root:436] [get_intent] [llm_interface.py] Iniciando get_intent para mensagem: 'quero coca cola'
2025-08-12 20:34:55,481 [INFO] [root:187] [load_prompt_template] [llm_interface.py] Carregando prompt de: ai_llm/gav_prompt.txt
2025-08-12 20:34:55,484 [INFO] [root:192] [load_prompt_template] [llm_interface.py] Prompt carregado e cacheado. Tamanho: 5500 caracteres
2025-08-12 20:34:55,485 [INFO] [root:482] [get_intent] [llm_interface.py] System prompt preparado. Tamanho: 5500 caracteres
2025-08-12 20:34:55,499 [INFO] [root:573] [get_intent] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-12 20:34:55,502 [DEBUG] [httpcore.connection:47] [trace] connect_tcp.started host='host.docker.internal' port=11434 local_address=None timeout=None socket_options=None
2025-08-12 20:34:55,506 [DEBUG] [httpcore.connection:47] [trace] connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7f7cd03d0df0>
2025-08-12 20:34:55,507 [DEBUG] [httpcore.http11:47] [trace] send_request_headers.started request=<Request [b'POST']>
2025-08-12 20:34:55,508 [DEBUG] [httpcore.http11:47] [trace] send_request_headers.complete
2025-08-12 20:34:55,508 [DEBUG] [httpcore.http11:47] [trace] send_request_body.started request=<Request [b'POST']>
2025-08-12 20:34:55,509 [DEBUG] [httpcore.http11:47] [trace] send_request_body.complete
2025-08-12 20:34:55,512 [DEBUG] [httpcore.http11:47] [trace] receive_response_headers.started request=<Request [b'POST']>
2025-08-12 20:35:03,155 [DEBUG] [httpcore.http11:47] [trace] receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 12 Aug 2025 20:35:03 GMT'), (b'Content-Length', b'420')])
2025-08-12 20:35:03,157 [INFO] [httpx:1025] [_send_single_request] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-12 20:35:03,158 [DEBUG] [httpcore.http11:47] [trace] receive_response_body.started request=<Request [b'POST']>
2025-08-12 20:35:03,159 [DEBUG] [httpcore.http11:47] [trace] receive_response_body.complete
2025-08-12 20:35:03,160 [DEBUG] [httpcore.http11:47] [trace] response_closed.started
2025-08-12 20:35:03,161 [DEBUG] [httpcore.http11:47] [trace] response_closed.complete
2025-08-12 20:35:03,162 [INFO] [root:592] [get_intent] [llm_interface.py] Resposta recebida do LLM em 7.66s
2025-08-12 20:35:03,163 [WARNING] [root:598] [get_intent] [llm_interface.py] LLM demorou 7.66s (timeout: 5s)
2025-08-12 20:35:03,164 [INFO] [root:604] [get_intent] [llm_interface.py] Resposta do LLM: Com base no contexto fornecido, podemos analisar a mensagem do cliente "quero coca cola" e determina...
2025-08-12 20:35:03,165 [DEBUG] [root:607] [get_intent] [llm_interface.py] Conte√∫do limpo: Com base no contexto fornecido, podemos analisar a mensagem do cliente "quero coca cola" e determinar a melhor resposta.
2025-08-12 20:35:03,165 [ERROR] [root:644] [get_intent] [llm_interface.py] Erro ao parsear JSON: Expecting value: line 1 column 1 (char 0)
2025-08-12 20:35:03,174 [INFO] [root:101] [_load_kb] Base de conhecimento '/app/knowledge/knowledge_base.json' carregada com 3 produtos e 59 termos.
2025-08-12 20:35:03,175 [INFO] [root:156] [find_product_in_kb] [KB] Busca exata encontrou: coca cola
2025-08-12 20:35:03,200 [INFO] [root:352] [fuzzy_search_products] [FUZZY] Busca fuzzy no banco para: 'coca cola'
2025-08-12 20:35:03,206 [INFO] [root:397] [fuzzy_search_products] [FUZZY] Retornando 2 produtos do banco
2025-08-12 20:35:03,212 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:35:03,213 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'üì¶ *üì¶ Encontrei estes produtos relacionados a 'coca cola'::*

*1.* REFRIG.COCA-COLA PET 2L
    üí∞ R$ 8...'
2025-08-12 20:35:03,480 [INFO] [root:57] [send_whatsapp_message] Mensagem enviada com sucesso. SID: SM17f18be763a16ebcb3f4f5df048774b9
2025-08-12 20:35:03,482 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para 'quero coca cola'
2025-08-12 20:35:10,137 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [12/Aug/2025 20:35:10] "POST /webhook HTTP/1.1" 200 -
2025-08-12 20:35:10,142 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:35:10,147 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:35:10,148 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'Quantas unidades de REFRIG.COCA-COLA LT 350ML voc√™ deseja adicionar?'
2025-08-12 20:35:10,375 [INFO] [root:57] [send_whatsapp_message] Mensagem enviada com sucesso. SID: SM724df4fbf9216e8acaa00e93133e054b
2025-08-12 20:35:10,376 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para '2'
2025-08-12 20:35:16,329 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [12/Aug/2025 20:35:16] "POST /webhook HTTP/1.1" 200 -
2025-08-12 20:35:16,333 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:35:16,340 [INFO] [root:263] [update_kb] KB atualizado com novo termo relacionado 'coca cola'
2025-08-12 20:35:16,345 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:35:16,346 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: '‚úÖ Perfeito! Adicionei 10 REFRIG.COCA-COLA LT 350ML ao seu carrinho.

üõí *SEU CARRINHO:*
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ...'
2025-08-12 20:35:16,581 [INFO] [root:57] [send_whatsapp_message] Mensagem enviada com sucesso. SID: SM80c15068ee75e5975f972a1f94fe8902
2025-08-12 20:35:16,582 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para '10'
2025-08-12 20:35:33,768 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [12/Aug/2025 20:35:33] "POST /webhook HTTP/1.1" 200 -
2025-08-12 20:35:33,771 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:35:33,775 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:35:33,776 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'Quantas unidades de REFRIG.COCA-COLA PET 2L voc√™ deseja adicionar?'
2025-08-12 20:35:34,016 [INFO] [root:57] [send_whatsapp_message] Mensagem enviada com sucesso. SID: SMd276961a2f5b4c849d9242758ce8bd3b
2025-08-12 20:35:34,017 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para '1'
2025-08-12 20:35:52,124 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [12/Aug/2025 20:35:52] "POST /webhook HTTP/1.1" 200 -
2025-08-12 20:35:52,131 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:35:52,137 [INFO] [root:263] [update_kb] KB atualizado com novo termo relacionado 'coca cola'
2025-08-12 20:35:52,141 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:35:52,142 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: '‚úÖ Perfeito! Adicionei 5 REFRIG.COCA-COLA PET 2L ao seu carrinho.

üõí *SEU CARRINHO:*
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ...'
2025-08-12 20:35:52,368 [INFO] [root:57] [send_whatsapp_message] Mensagem enviada com sucesso. SID: SMf823c75fd812ec958bff0da921b1aa60
2025-08-12 20:35:52,369 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para '5'
2025-08-12 20:36:01,611 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [12/Aug/2025 20:36:01] "POST /webhook HTTP/1.1" 200 -
2025-08-12 20:36:01,616 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:36:01,617 [INFO] [root:378] [detect_user_intent_type] [INTENT] Comando de limpeza detectado: 'limpar carrinho'
2025-08-12 20:36:01,620 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:36:01,621 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'üóëÔ∏è Carrinho esvaziado! 2 itens removidos.

üîç Digite o nome do produto
üì¶ Digite *produtos* para ver o...'
2025-08-12 20:36:01,830 [INFO] [root:57] [send_whatsapp_message] Mensagem enviada com sucesso. SID: SMbf19b78fa3fc999deaa769cc829560ce
2025-08-12 20:36:01,832 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para 'limpar carrinho'
2025-08-12 20:36:54,319 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [12/Aug/2025 20:36:54] "POST /webhook HTTP/1.1" 200 -
2025-08-12 20:36:54,324 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:36:54,325 [INFO] [root:436] [get_intent] [llm_interface.py] Iniciando get_intent para mensagem: 'quero omo'
2025-08-12 20:36:54,326 [INFO] [root:482] [get_intent] [llm_interface.py] System prompt preparado. Tamanho: 5500 caracteres
2025-08-12 20:36:54,342 [INFO] [root:573] [get_intent] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-12 20:36:54,346 [DEBUG] [httpcore.connection:47] [trace] connect_tcp.started host='host.docker.internal' port=11434 local_address=None timeout=None socket_options=None
2025-08-12 20:36:54,350 [DEBUG] [httpcore.connection:47] [trace] connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7f7cd0397ca0>
2025-08-12 20:36:54,351 [DEBUG] [httpcore.http11:47] [trace] send_request_headers.started request=<Request [b'POST']>
2025-08-12 20:36:54,352 [DEBUG] [httpcore.http11:47] [trace] send_request_headers.complete
2025-08-12 20:36:54,353 [DEBUG] [httpcore.http11:47] [trace] send_request_body.started request=<Request [b'POST']>
2025-08-12 20:36:54,354 [DEBUG] [httpcore.http11:47] [trace] send_request_body.complete
2025-08-12 20:36:54,354 [DEBUG] [httpcore.http11:47] [trace] receive_response_headers.started request=<Request [b'POST']>
2025-08-12 20:36:56,117 [DEBUG] [httpcore.http11:47] [trace] receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 12 Aug 2025 20:36:56 GMT'), (b'Content-Length', b'387')])
2025-08-12 20:36:56,118 [INFO] [httpx:1025] [_send_single_request] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-12 20:36:56,119 [DEBUG] [httpcore.http11:47] [trace] receive_response_body.started request=<Request [b'POST']>
2025-08-12 20:36:56,120 [DEBUG] [httpcore.http11:47] [trace] receive_response_body.complete
2025-08-12 20:36:56,121 [DEBUG] [httpcore.http11:47] [trace] response_closed.started
2025-08-12 20:36:56,122 [DEBUG] [httpcore.http11:47] [trace] response_closed.complete
2025-08-12 20:36:56,123 [INFO] [root:592] [get_intent] [llm_interface.py] Resposta recebida do LLM em 1.78s
2025-08-12 20:36:56,124 [INFO] [root:604] [get_intent] [llm_interface.py] Resposta do LLM: Analisando a mensagem do usu√°rio "quero omo" no contexto da conversa, podemos inferir que:...
2025-08-12 20:36:56,124 [DEBUG] [root:607] [get_intent] [llm_interface.py] Conte√∫do limpo: Analisando a mensagem do usu√°rio "quero omo" no contexto da conversa, podemos inferir que:
2025-08-12 20:36:56,125 [ERROR] [root:644] [get_intent] [llm_interface.py] Erro ao parsear JSON: Expecting value: line 1 column 1 (char 0)
2025-08-12 20:36:56,133 [INFO] [root:101] [_load_kb] Base de conhecimento '/app/knowledge/knowledge_base.json' carregada com 3 produtos e 59 termos.
2025-08-12 20:36:56,134 [INFO] [root:292] [fuzzy_search_kb] [FUZZY] Iniciando busca fuzzy para: 'omo'
2025-08-12 20:36:56,137 [INFO] [root:331] [fuzzy_search_kb] [FUZZY] Encontrados 0 produtos com similaridade >= 0.8
2025-08-12 20:36:56,139 [INFO] [root:292] [fuzzy_search_kb] [FUZZY] Iniciando busca fuzzy para: 'omo'
2025-08-12 20:36:56,140 [INFO] [root:331] [fuzzy_search_kb] [FUZZY] Encontrados 1 produtos com similaridade >= 0.6
2025-08-12 20:36:56,140 [INFO] [root:169] [find_product_in_kb] [KB] Busca fuzzy (m√©dia) encontrou 1 produtos para: omo
2025-08-12 20:36:56,159 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:36:56,160 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'üì¶ *üì¶ Encontrei estes produtos relacionados a 'omo'::*

*1.* DT.PO OMO LAVAGEM PERFEITA 1.6KG
    üí∞ R...'
2025-08-12 20:36:56,414 [INFO] [root:57] [send_whatsapp_message] Mensagem enviada com sucesso. SID: SM485bd02fbc7628a7457984c4ebdd513d
2025-08-12 20:36:56,415 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para 'quero omo'
2025-08-12 20:37:04,586 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [12/Aug/2025 20:37:04] "POST /webhook HTTP/1.1" 200 -
2025-08-12 20:37:04,590 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:37:04,594 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:37:04,594 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'ü§ñ Seu carrinho est√° vazio!

üîç Digite o nome do produto
üì¶ Digite *produtos* para ver os mais vendidos...'
2025-08-12 20:37:04,809 [INFO] [root:57] [send_whatsapp_message] Mensagem enviada com sucesso. SID: SM0a6ae534ba26f9a8e4388829f335ef3f
2025-08-12 20:37:04,810 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para 'finalizar'
2025-08-12 20:37:12,232 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [12/Aug/2025 20:37:12] "POST /webhook HTTP/1.1" 200 -
2025-08-12 20:37:12,236 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:37:12,249 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:37:12,250 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'üì¶ *‚≠ê Estes s√£o nossos produtos mais populares::*

*1.* DT.PO OMO LAVAGEM PERFEITA 1.6KG
    üí∞ R$ 25,...'
2025-08-12 20:37:12,482 [INFO] [root:57] [send_whatsapp_message] Mensagem enviada com sucesso. SID: SM949928acd7a05c7c42c866006c31b3b2
2025-08-12 20:37:12,483 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para '1'
2025-08-12 20:37:20,942 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [12/Aug/2025 20:37:20] "POST /webhook HTTP/1.1" 200 -
2025-08-12 20:37:20,946 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:37:20,950 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:37:20,950 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'Quantas unidades de DT.PO OMO LAVAGEM PERFEITA 1.6KG voc√™ deseja adicionar?'
2025-08-12 20:37:21,169 [INFO] [root:57] [send_whatsapp_message] Mensagem enviada com sucesso. SID: SM2fcd48807e888d76b8ed1389288f93b4
2025-08-12 20:37:21,170 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para '1'
2025-08-12 20:37:26,419 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [12/Aug/2025 20:37:26] "POST /webhook HTTP/1.1" 200 -
2025-08-12 20:37:26,423 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:37:26,429 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:37:26,430 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: '‚úÖ Perfeito! Adicionei 10 DT.PO OMO LAVAGEM PERFEITA 1.6KG ao seu carrinho.

üõí *SEU CARRINHO:*
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ...'
2025-08-12 20:37:26,647 [INFO] [root:57] [send_whatsapp_message] Mensagem enviada com sucesso. SID: SM831f8bb3e41e849e2d45f7ad6112a625
2025-08-12 20:37:26,648 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para '10'
2025-08-12 20:37:34,502 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [12/Aug/2025 20:37:34] "POST /webhook HTTP/1.1" 200 -
2025-08-12 20:37:34,506 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:37:34,516 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:37:34,517 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'Quantas unidades de REFRIG.COCA-COLA PET 2L voc√™ deseja adicionar?'
2025-08-12 20:37:34,758 [INFO] [root:57] [send_whatsapp_message] Mensagem enviada com sucesso. SID: SM93c0f2655180e43a258a93a9e87f07b0
2025-08-12 20:37:34,759 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para '3'
2025-08-12 20:37:40,244 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [12/Aug/2025 20:37:40] "POST /webhook HTTP/1.1" 200 -
2025-08-12 20:37:40,248 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:37:40,252 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:37:40,253 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: '‚úÖ Perfeito! Adicionei 1 REFRIG.COCA-COLA PET 2L ao seu carrinho.

üõí *SEU CARRINHO:*
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ...'
2025-08-12 20:37:40,465 [INFO] [root:57] [send_whatsapp_message] Mensagem enviada com sucesso. SID: SM33142263a8e5cf50cf43445250b0116e
2025-08-12 20:37:40,466 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para 'Finalizar'
2025-08-12 20:37:51,323 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [12/Aug/2025 20:37:51] "POST /webhook HTTP/1.1" 200 -
2025-08-12 20:37:51,327 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:37:51,332 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:37:51,333 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: '‚≠ê Para finalizar a compra, preciso do seu CNPJ.'
2025-08-12 20:37:51,603 [INFO] [root:57] [send_whatsapp_message] Mensagem enviada com sucesso. SID: SM4deff998792e738ab25f4348c6723aa4
2025-08-12 20:37:51,605 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para 'finalizar pedido'
2025-08-12 20:38:00,515 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [12/Aug/2025 20:38:00] "POST /webhook HTTP/1.1" 200 -
2025-08-12 20:38:00,519 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:38:00,528 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:38:00,530 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'ü§ñ N√£o encontrei um cliente com o CNPJ 12345678910223. Mas posso registrar seu pedido mesmo assim!

‚úÖ...'
2025-08-12 20:38:00,760 [INFO] [root:57] [send_whatsapp_message] Mensagem enviada com sucesso. SID: SMdba2748bfd4f179fe5ac825d687edbcd
2025-08-12 20:38:00,761 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para '12345678910223'
2025-08-12 20:38:40,933 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [12/Aug/2025 20:38:40] "POST /webhook HTTP/1.1" 200 -
2025-08-12 20:38:40,938 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:38:40,942 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:38:40,943 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'üõí Seu carrinho est√° vazio.

üîç Digite o nome do produto
üì¶ Digite *produtos* para ver os mais vendidos...'
2025-08-12 20:38:41,152 [INFO] [root:57] [send_whatsapp_message] Mensagem enviada com sucesso. SID: SM85bf9f6d3c476d03f8af2e127ffb18d4
2025-08-12 20:38:41,154 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para 'meu carrinho'
2025-08-12 20:38:51,107 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [12/Aug/2025 20:38:51] "POST /webhook HTTP/1.1" 200 -
2025-08-12 20:38:51,112 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:38:51,113 [INFO] [root:436] [get_intent] [llm_interface.py] Iniciando get_intent para mensagem: 'meus pedidos'
2025-08-12 20:38:51,114 [INFO] [root:482] [get_intent] [llm_interface.py] System prompt preparado. Tamanho: 5500 caracteres
2025-08-12 20:38:51,129 [INFO] [root:573] [get_intent] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-12 20:38:51,130 [DEBUG] [httpcore.connection:47] [trace] connect_tcp.started host='host.docker.internal' port=11434 local_address=None timeout=None socket_options=None
2025-08-12 20:38:51,135 [DEBUG] [httpcore.connection:47] [trace] connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7f7cd03929d0>
2025-08-12 20:38:51,136 [DEBUG] [httpcore.http11:47] [trace] send_request_headers.started request=<Request [b'POST']>
2025-08-12 20:38:51,137 [DEBUG] [httpcore.http11:47] [trace] send_request_headers.complete
2025-08-12 20:38:51,138 [DEBUG] [httpcore.http11:47] [trace] send_request_body.started request=<Request [b'POST']>
2025-08-12 20:38:51,138 [DEBUG] [httpcore.http11:47] [trace] send_request_body.complete
2025-08-12 20:38:51,139 [DEBUG] [httpcore.http11:47] [trace] receive_response_headers.started request=<Request [b'POST']>
2025-08-12 20:38:52,663 [DEBUG] [httpcore.http11:47] [trace] receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 12 Aug 2025 20:38:52 GMT'), (b'Content-Length', b'331')])
2025-08-12 20:38:52,665 [INFO] [httpx:1025] [_send_single_request] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-12 20:38:52,666 [DEBUG] [httpcore.http11:47] [trace] receive_response_body.started request=<Request [b'POST']>
2025-08-12 20:38:52,667 [DEBUG] [httpcore.http11:47] [trace] receive_response_body.complete
2025-08-12 20:38:52,667 [DEBUG] [httpcore.http11:47] [trace] response_closed.started
2025-08-12 20:38:52,668 [DEBUG] [httpcore.http11:47] [trace] response_closed.complete
2025-08-12 20:38:52,669 [INFO] [root:592] [get_intent] [llm_interface.py] Resposta recebida do LLM em 1.54s
2025-08-12 20:38:52,670 [INFO] [root:604] [get_intent] [llm_interface.py] Resposta do LLM: **AN√ÅLISE DA MENSAGEM DO USU√ÅRIO:**...
2025-08-12 20:38:52,670 [DEBUG] [root:607] [get_intent] [llm_interface.py] Conte√∫do limpo: **AN√ÅLISE DA MENSAGEM DO USU√ÅRIO:**
2025-08-12 20:38:52,671 [ERROR] [root:644] [get_intent] [llm_interface.py] Erro ao parsear JSON: Expecting value: line 1 column 1 (char 0)
2025-08-12 20:38:52,672 [INFO] [root:292] [fuzzy_search_kb] [FUZZY] Iniciando busca fuzzy para: 'meus pedidos'
2025-08-12 20:38:52,679 [INFO] [root:331] [fuzzy_search_kb] [FUZZY] Encontrados 0 produtos com similaridade >= 0.8
2025-08-12 20:38:52,680 [INFO] [root:292] [fuzzy_search_kb] [FUZZY] Iniciando busca fuzzy para: 'meus pedidos'
2025-08-12 20:38:52,681 [INFO] [root:331] [fuzzy_search_kb] [FUZZY] Encontrados 0 produtos com similaridade >= 0.6
2025-08-12 20:38:52,682 [INFO] [root:292] [fuzzy_search_kb] [FUZZY] Iniciando busca fuzzy para: 'meus pedidos'
2025-08-12 20:38:52,683 [INFO] [root:331] [fuzzy_search_kb] [FUZZY] Encontrados 0 produtos com similaridade >= 0.4
2025-08-12 20:38:52,684 [INFO] [root:205] [find_product_in_kb] [KB] Nenhum produto encontrado para: meus pedidos
2025-08-12 20:38:52,691 [INFO] [root:352] [fuzzy_search_products] [FUZZY] Busca fuzzy no banco para: 'meus pedidos'
2025-08-12 20:38:52,699 [INFO] [root:397] [fuzzy_search_products] [FUZZY] Retornando 0 produtos do banco
2025-08-12 20:38:52,704 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:38:52,705 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'ü§ñ N√£o encontrei produtos para 'meus pedidos'.

Tente usar termos mais gerais como 'refrigerante', 's...'
2025-08-12 20:38:52,914 [INFO] [root:57] [send_whatsapp_message] Mensagem enviada com sucesso. SID: SM9eabef064a4e1f46cb35914b27d2325a
2025-08-12 20:38:52,915 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para 'meus pedidos'
2025-08-12 20:39:00,899 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [12/Aug/2025 20:39:00] "POST /webhook HTTP/1.1" 200 -
2025-08-12 20:39:00,903 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:39:00,903 [INFO] [root:436] [get_intent] [llm_interface.py] Iniciando get_intent para mensagem: 'sab√£o'
2025-08-12 20:39:00,904 [INFO] [root:482] [get_intent] [llm_interface.py] System prompt preparado. Tamanho: 5500 caracteres
2025-08-12 20:39:00,919 [INFO] [root:573] [get_intent] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-12 20:39:00,921 [DEBUG] [httpcore.connection:47] [trace] connect_tcp.started host='host.docker.internal' port=11434 local_address=None timeout=None socket_options=None
2025-08-12 20:39:00,926 [DEBUG] [httpcore.connection:47] [trace] connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7f7cd03a9970>
2025-08-12 20:39:00,927 [DEBUG] [httpcore.http11:47] [trace] send_request_headers.started request=<Request [b'POST']>
2025-08-12 20:39:00,928 [DEBUG] [httpcore.http11:47] [trace] send_request_headers.complete
2025-08-12 20:39:00,929 [DEBUG] [httpcore.http11:47] [trace] send_request_body.started request=<Request [b'POST']>
2025-08-12 20:39:00,930 [DEBUG] [httpcore.http11:47] [trace] send_request_body.complete
2025-08-12 20:39:00,930 [DEBUG] [httpcore.http11:47] [trace] receive_response_headers.started request=<Request [b'POST']>
2025-08-12 20:39:02,439 [DEBUG] [httpcore.http11:47] [trace] receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 12 Aug 2025 20:39:02 GMT'), (b'Content-Length', b'330')])
2025-08-12 20:39:02,440 [INFO] [httpx:1025] [_send_single_request] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-12 20:39:02,442 [DEBUG] [httpcore.http11:47] [trace] receive_response_body.started request=<Request [b'POST']>
2025-08-12 20:39:02,443 [DEBUG] [httpcore.http11:47] [trace] receive_response_body.complete
2025-08-12 20:39:02,444 [DEBUG] [httpcore.http11:47] [trace] response_closed.started
2025-08-12 20:39:02,445 [DEBUG] [httpcore.http11:47] [trace] response_closed.complete
2025-08-12 20:39:02,445 [INFO] [root:592] [get_intent] [llm_interface.py] Resposta recebida do LLM em 1.52s
2025-08-12 20:39:02,446 [INFO] [root:604] [get_intent] [llm_interface.py] Resposta do LLM: **AN√ÅLISE DA MENSAGEM DO USU√ÅRIO:**...
2025-08-12 20:39:02,447 [DEBUG] [root:607] [get_intent] [llm_interface.py] Conte√∫do limpo: **AN√ÅLISE DA MENSAGEM DO USU√ÅRIO:**
2025-08-12 20:39:02,448 [ERROR] [root:644] [get_intent] [llm_interface.py] Erro ao parsear JSON: Expecting value: line 1 column 1 (char 0)
2025-08-12 20:39:02,449 [INFO] [root:292] [fuzzy_search_kb] [FUZZY] Iniciando busca fuzzy para: 'sab√£o'
2025-08-12 20:39:02,459 [INFO] [root:331] [fuzzy_search_kb] [FUZZY] Encontrados 0 produtos com similaridade >= 0.8
2025-08-12 20:39:02,460 [INFO] [root:292] [fuzzy_search_kb] [FUZZY] Iniciando busca fuzzy para: 'sab√£o'
2025-08-12 20:39:02,461 [INFO] [root:331] [fuzzy_search_kb] [FUZZY] Encontrados 1 produtos com similaridade >= 0.6
2025-08-12 20:39:02,462 [INFO] [root:169] [find_product_in_kb] [KB] Busca fuzzy (m√©dia) encontrou 1 produtos para: sab√£o
2025-08-12 20:39:02,474 [INFO] [root:352] [fuzzy_search_products] [FUZZY] Busca fuzzy no banco para: 'sab√£o'
2025-08-12 20:39:02,481 [INFO] [root:397] [fuzzy_search_products] [FUZZY] Retornando 0 produtos do banco
2025-08-12 20:39:02,488 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:39:02,489 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'ü§ñ N√£o encontrei produtos para 'sab√£o'.

üí° sabao

Ou tente buscar por categoria: 'refrigerantes', 'de...'
2025-08-12 20:39:02,695 [INFO] [root:57] [send_whatsapp_message] Mensagem enviada com sucesso. SID: SM500a3f113b920af04cf3337debcff800
2025-08-12 20:39:02,696 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para 'sab√£o'
2025-08-12 20:39:08,837 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [12/Aug/2025 20:39:08] "POST /webhook HTTP/1.1" 200 -
2025-08-12 20:39:08,841 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:39:08,842 [INFO] [root:436] [get_intent] [llm_interface.py] Iniciando get_intent para mensagem: 'omo'
2025-08-12 20:39:08,843 [INFO] [root:482] [get_intent] [llm_interface.py] System prompt preparado. Tamanho: 5500 caracteres
2025-08-12 20:39:08,857 [INFO] [root:573] [get_intent] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-12 20:39:08,859 [DEBUG] [httpcore.connection:47] [trace] connect_tcp.started host='host.docker.internal' port=11434 local_address=None timeout=None socket_options=None
2025-08-12 20:39:08,865 [DEBUG] [httpcore.connection:47] [trace] connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7f7cd039a250>
2025-08-12 20:39:08,866 [DEBUG] [httpcore.http11:47] [trace] send_request_headers.started request=<Request [b'POST']>
2025-08-12 20:39:08,867 [DEBUG] [httpcore.http11:47] [trace] send_request_headers.complete
2025-08-12 20:39:08,867 [DEBUG] [httpcore.http11:47] [trace] send_request_body.started request=<Request [b'POST']>
2025-08-12 20:39:08,868 [DEBUG] [httpcore.http11:47] [trace] send_request_body.complete
2025-08-12 20:39:08,868 [DEBUG] [httpcore.http11:47] [trace] receive_response_headers.started request=<Request [b'POST']>
2025-08-12 20:39:10,436 [DEBUG] [httpcore.http11:47] [trace] receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 12 Aug 2025 20:39:10 GMT'), (b'Content-Length', b'331')])
2025-08-12 20:39:10,437 [INFO] [httpx:1025] [_send_single_request] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-12 20:39:10,438 [DEBUG] [httpcore.http11:47] [trace] receive_response_body.started request=<Request [b'POST']>
2025-08-12 20:39:10,439 [DEBUG] [httpcore.http11:47] [trace] receive_response_body.complete
2025-08-12 20:39:10,440 [DEBUG] [httpcore.http11:47] [trace] response_closed.started
2025-08-12 20:39:10,441 [DEBUG] [httpcore.http11:47] [trace] response_closed.complete
2025-08-12 20:39:10,442 [INFO] [root:592] [get_intent] [llm_interface.py] Resposta recebida do LLM em 1.58s
2025-08-12 20:39:10,443 [INFO] [root:604] [get_intent] [llm_interface.py] Resposta do LLM: **AN√ÅLISE DA MENSAGEM DO USU√ÅRIO:**...
2025-08-12 20:39:10,444 [DEBUG] [root:607] [get_intent] [llm_interface.py] Conte√∫do limpo: **AN√ÅLISE DA MENSAGEM DO USU√ÅRIO:**
2025-08-12 20:39:10,445 [ERROR] [root:644] [get_intent] [llm_interface.py] Erro ao parsear JSON: Expecting value: line 1 column 1 (char 0)
2025-08-12 20:39:10,446 [INFO] [root:292] [fuzzy_search_kb] [FUZZY] Iniciando busca fuzzy para: 'omo'
2025-08-12 20:39:10,447 [INFO] [root:331] [fuzzy_search_kb] [FUZZY] Encontrados 0 produtos com similaridade >= 0.8
2025-08-12 20:39:10,448 [INFO] [root:292] [fuzzy_search_kb] [FUZZY] Iniciando busca fuzzy para: 'omo'
2025-08-12 20:39:10,449 [INFO] [root:331] [fuzzy_search_kb] [FUZZY] Encontrados 1 produtos com similaridade >= 0.6
2025-08-12 20:39:10,450 [INFO] [root:169] [find_product_in_kb] [KB] Busca fuzzy (m√©dia) encontrou 1 produtos para: omo
2025-08-12 20:39:10,466 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:39:10,467 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'üì¶ *üì¶ Encontrei estes produtos relacionados a 'omo'::*

*1.* DT.PO OMO LAVAGEM PERFEITA 1.6KG
    üí∞ R...'
2025-08-12 20:39:10,673 [INFO] [root:57] [send_whatsapp_message] Mensagem enviada com sucesso. SID: SMef393898474b6eb8ed8eb03cd5cbe2e4
2025-08-12 20:39:10,674 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para 'omo'
2025-08-12 20:40:20,959 [INFO] [werkzeug:97] [_log]  * Detected change in '/app/core/session_manager.py', reloading
2025-08-12 20:40:21,030 [INFO] [werkzeug:97] [_log]  * Restarting with stat
2025-08-12 20:40:21,909 [INFO] [root:534] [setup_main_logging] üöÄ Sistema de logging G.A.V. inicializado
2025-08-12 20:40:21,991 [INFO] [root:21] [<module>] Cliente Twilio inicializado com sucesso
2025-08-12 20:40:22,035 [WARNING] [werkzeug:97] [_log]  * Debugger is active!
2025-08-12 20:40:22,036 [INFO] [werkzeug:97] [_log]  * Debugger PIN: 353-219-865
2025-08-12 20:40:30,042 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [12/Aug/2025 20:40:30] "POST /webhook HTTP/1.1" 200 -
2025-08-12 20:40:30,049 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:40:30,055 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:40:30,056 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'Quantas unidades de DT.PO OMO LAVAGEM PERFEITA 1.6KG voc√™ deseja adicionar?'
2025-08-12 20:40:30,452 [INFO] [root:57] [send_whatsapp_message] Mensagem enviada com sucesso. SID: SM16e9c8cf7a8b78506ab1295fa95d1c78
2025-08-12 20:40:30,453 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para '1'
2025-08-12 20:40:35,197 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [12/Aug/2025 20:40:35] "POST /webhook HTTP/1.1" 200 -
2025-08-12 20:40:35,202 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:40:35,207 [INFO] [root:258] [update_kb] Adicionado termo 'omo' ao produto DT.PO OMO LAVAGEM PERFEITA 1.6KG
2025-08-12 20:40:35,212 [INFO] [root:263] [update_kb] KB atualizado com novo termo relacionado 'omo'
2025-08-12 20:40:35,219 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:40:35,220 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: '‚úÖ Perfeito! Adicionei 10 DT.PO OMO LAVAGEM PERFEITA 1.6KG ao seu carrinho.

üõí *SEU CARRINHO:*
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ...'
2025-08-12 20:40:35,447 [INFO] [root:57] [send_whatsapp_message] Mensagem enviada com sucesso. SID: SMea44fe18b4d279a246911c055eed8cb5
2025-08-12 20:40:35,448 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para '10'
2025-08-12 20:40:46,278 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [12/Aug/2025 20:40:46] "POST /webhook HTTP/1.1" 200 -
2025-08-12 20:40:46,283 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:40:46,286 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:40:46,287 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: '‚≠ê Para finalizar a compra, preciso do seu CNPJ.'
2025-08-12 20:40:46,521 [INFO] [root:57] [send_whatsapp_message] Mensagem enviada com sucesso. SID: SM8905dde86b5f35787883927e3b46da47
2025-08-12 20:40:46,522 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para 'finalizar pedido'
2025-08-12 20:40:54,841 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [12/Aug/2025 20:40:54] "POST /webhook HTTP/1.1" 200 -
2025-08-12 20:40:54,848 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:40:54,858 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:40:54,861 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'ü§ñ N√£o encontrei um cliente com o CNPJ 10203060504011. Mas posso registrar seu pedido mesmo assim!

‚úÖ...'
2025-08-12 20:40:55,077 [INFO] [root:57] [send_whatsapp_message] Mensagem enviada com sucesso. SID: SMc332a299010e1b7395acd439cb7d9b00
2025-08-12 20:40:55,078 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para '10203060504011'
2025-08-12 20:41:43,905 [INFO] [werkzeug:97] [_log]  * Detected change in '/app/core/session_manager.py', reloading
2025-08-12 20:41:43,964 [INFO] [werkzeug:97] [_log]  * Restarting with stat
2025-08-12 20:41:44,736 [INFO] [root:534] [setup_main_logging] üöÄ Sistema de logging G.A.V. inicializado
2025-08-12 20:41:44,825 [INFO] [root:21] [<module>] Cliente Twilio inicializado com sucesso
2025-08-12 20:41:44,858 [WARNING] [werkzeug:97] [_log]  * Debugger is active!
2025-08-12 20:41:44,860 [INFO] [werkzeug:97] [_log]  * Debugger PIN: 353-219-865
2025-08-12 20:43:24,028 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [12/Aug/2025 20:43:24] "POST /webhook HTTP/1.1" 200 -
2025-08-12 20:43:24,033 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:43:24,037 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:43:24,038 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'üõí Seu carrinho est√° vazio.

üîç Digite o nome do produto
üì¶ Digite *produtos* para ver os mais vendidos...'
2025-08-12 20:43:24,485 [INFO] [root:57] [send_whatsapp_message] Mensagem enviada com sucesso. SID: SMf2daeedc3067381513930e78d228580c
2025-08-12 20:43:24,486 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para 'adiciona 5 coca cola no carrinho'
2025-08-12 20:43:33,208 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [12/Aug/2025 20:43:33] "POST /webhook HTTP/1.1" 200 -
2025-08-12 20:43:33,214 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:43:33,215 [INFO] [root:436] [get_intent] [llm_interface.py] Iniciando get_intent para mensagem: 'quero coca cola'
2025-08-12 20:43:33,217 [INFO] [root:187] [load_prompt_template] [llm_interface.py] Carregando prompt de: ai_llm/gav_prompt.txt
2025-08-12 20:43:33,220 [INFO] [root:192] [load_prompt_template] [llm_interface.py] Prompt carregado e cacheado. Tamanho: 5500 caracteres
2025-08-12 20:43:33,221 [INFO] [root:482] [get_intent] [llm_interface.py] System prompt preparado. Tamanho: 5500 caracteres
2025-08-12 20:43:33,236 [INFO] [root:573] [get_intent] [llm_interface.py] Configurando Ollama Host: 'http://host.docker.internal:11434'
2025-08-12 20:43:33,238 [DEBUG] [httpcore.connection:47] [trace] connect_tcp.started host='host.docker.internal' port=11434 local_address=None timeout=None socket_options=None
2025-08-12 20:43:33,243 [DEBUG] [httpcore.connection:47] [trace] connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7f3d1e0d3df0>
2025-08-12 20:43:33,243 [DEBUG] [httpcore.http11:47] [trace] send_request_headers.started request=<Request [b'POST']>
2025-08-12 20:43:33,245 [DEBUG] [httpcore.http11:47] [trace] send_request_headers.complete
2025-08-12 20:43:33,246 [DEBUG] [httpcore.http11:47] [trace] send_request_body.started request=<Request [b'POST']>
2025-08-12 20:43:33,246 [DEBUG] [httpcore.http11:47] [trace] send_request_body.complete
2025-08-12 20:43:33,247 [DEBUG] [httpcore.http11:47] [trace] receive_response_headers.started request=<Request [b'POST']>
2025-08-12 20:43:34,771 [DEBUG] [httpcore.http11:47] [trace] receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 12 Aug 2025 20:43:34 GMT'), (b'Content-Length', b'331')])
2025-08-12 20:43:34,772 [INFO] [httpx:1025] [_send_single_request] HTTP Request: POST http://host.docker.internal:11434/api/chat "HTTP/1.1 200 OK"
2025-08-12 20:43:34,773 [DEBUG] [httpcore.http11:47] [trace] receive_response_body.started request=<Request [b'POST']>
2025-08-12 20:43:34,774 [DEBUG] [httpcore.http11:47] [trace] receive_response_body.complete
2025-08-12 20:43:34,775 [DEBUG] [httpcore.http11:47] [trace] response_closed.started
2025-08-12 20:43:34,776 [DEBUG] [httpcore.http11:47] [trace] response_closed.complete
2025-08-12 20:43:34,777 [INFO] [root:592] [get_intent] [llm_interface.py] Resposta recebida do LLM em 1.54s
2025-08-12 20:43:34,778 [INFO] [root:604] [get_intent] [llm_interface.py] Resposta do LLM: **AN√ÅLISE DA MENSAGEM DO USU√ÅRIO:**...
2025-08-12 20:43:34,779 [DEBUG] [root:607] [get_intent] [llm_interface.py] Conte√∫do limpo: **AN√ÅLISE DA MENSAGEM DO USU√ÅRIO:**
2025-08-12 20:43:34,780 [ERROR] [root:644] [get_intent] [llm_interface.py] Erro ao parsear JSON: Expecting value: line 1 column 1 (char 0)
2025-08-12 20:43:34,787 [INFO] [root:101] [_load_kb] Base de conhecimento '/app/knowledge/knowledge_base.json' carregada com 3 produtos e 60 termos.
2025-08-12 20:43:34,788 [INFO] [root:156] [find_product_in_kb] [KB] Busca exata encontrou: coca cola
2025-08-12 20:43:34,808 [INFO] [root:352] [fuzzy_search_products] [FUZZY] Busca fuzzy no banco para: 'coca cola'
2025-08-12 20:43:34,815 [INFO] [root:397] [fuzzy_search_products] [FUZZY] Retornando 2 produtos do banco
2025-08-12 20:43:34,821 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:43:34,822 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'üì¶ *üì¶ Encontrei estes produtos relacionados a 'coca cola'::*

*1.* REFRIG.COCA-COLA PET 2L
    üí∞ R$ 8...'
2025-08-12 20:43:35,039 [INFO] [root:57] [send_whatsapp_message] Mensagem enviada com sucesso. SID: SMacaf550725db8cae9219429f1246bd8a
2025-08-12 20:43:35,040 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para 'quero coca cola'
2025-08-12 20:43:40,000 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [12/Aug/2025 20:43:40] "POST /webhook HTTP/1.1" 200 -
2025-08-12 20:43:40,005 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:43:40,010 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:43:40,011 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'Quantas unidades de REFRIG.COCA-COLA LT 350ML voc√™ deseja adicionar?'
2025-08-12 20:43:40,224 [INFO] [root:57] [send_whatsapp_message] Mensagem enviada com sucesso. SID: SMfc4459d242cf8a8c722ed42af95b0bc1
2025-08-12 20:43:40,225 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para '2'
2025-08-12 20:43:45,301 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [12/Aug/2025 20:43:45] "POST /webhook HTTP/1.1" 200 -
2025-08-12 20:43:45,305 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:43:45,313 [INFO] [root:263] [update_kb] KB atualizado com novo termo relacionado 'coca cola'
2025-08-12 20:43:45,318 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:43:45,319 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: '‚úÖ Perfeito! Adicionei 5 REFRIG.COCA-COLA LT 350ML ao seu carrinho.

üõí *SEU CARRINHO:*
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ...'
2025-08-12 20:43:45,548 [INFO] [root:57] [send_whatsapp_message] Mensagem enviada com sucesso. SID: SMb7e630e1ad561575348c3405011468ea
2025-08-12 20:43:45,549 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para '5'
2025-08-12 20:43:53,293 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [12/Aug/2025 20:43:53] "POST /webhook HTTP/1.1" 200 -
2025-08-12 20:43:53,297 [DEBUG] [root:95] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:43:53,301 [DEBUG] [root:134] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp_+5511940726493.json
2025-08-12 20:43:53,302 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'ü§ñ Ol√°! Como posso ajudar voc√™ hoje?'
2025-08-12 20:43:53,516 [INFO] [root:57] [send_whatsapp_message] Mensagem enviada com sucesso. SID: SM90461c4f1d69afba31179218051473c7
2025-08-12 20:43:53,518 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para 'Adiciona mais 5 coca cola'
2025-08-13 00:20:53,002 [INFO] [werkzeug:97] [_log]  * Detected change in '/app/ai_llm/llm_interface.py', reloading
2025-08-13 00:20:53,196 [INFO] [werkzeug:97] [_log]  * Restarting with stat
2025-08-13 00:20:53,946 [INFO] [root:534] [setup_main_logging] üöÄ Sistema de logging G.A.V. inicializado
2025-08-13 00:20:54,013 [INFO] [root:21] [<module>] Cliente Twilio inicializado com sucesso
2025-08-13 00:20:54,039 [WARNING] [werkzeug:97] [_log]  * Debugger is active!
2025-08-13 00:20:54,040 [INFO] [werkzeug:97] [_log]  * Debugger PIN: 353-219-865
2025-08-13 00:26:30,826 [INFO] [werkzeug:97] [_log]  * Detected change in '/app/core/session_manager.py', reloading
2025-08-13 00:26:30,876 [INFO] [werkzeug:97] [_log]  * Restarting with stat
2025-08-13 00:26:31,599 [INFO] [root:534] [setup_main_logging] üöÄ Sistema de logging G.A.V. inicializado
2025-08-13 00:26:31,670 [INFO] [root:21] [<module>] Cliente Twilio inicializado com sucesso
2025-08-13 00:26:31,700 [WARNING] [werkzeug:97] [_log]  * Debugger is active!
2025-08-13 00:26:31,701 [INFO] [werkzeug:97] [_log]  * Debugger PIN: 353-219-865
2025-08-13 00:26:42,390 [INFO] [werkzeug:97] [_log]  * Detected change in '/app/core/session_manager.py', reloading
2025-08-13 00:26:42,430 [INFO] [werkzeug:97] [_log]  * Restarting with stat
2025-08-13 00:26:43,061 [INFO] [root:534] [setup_main_logging] üöÄ Sistema de logging G.A.V. inicializado
2025-08-13 00:26:43,123 [INFO] [root:21] [<module>] Cliente Twilio inicializado com sucesso
2025-08-13 00:26:43,151 [WARNING] [werkzeug:97] [_log]  * Debugger is active!
2025-08-13 00:26:43,152 [INFO] [werkzeug:97] [_log]  * Debugger PIN: 353-219-865
2025-08-13 00:29:56,359 [INFO] [werkzeug:97] [_log]  * Detected change in '/app/app.py', reloading
2025-08-13 00:29:56,411 [INFO] [werkzeug:97] [_log]  * Restarting with stat
2025-08-13 00:29:57,053 [INFO] [root:534] [setup_main_logging] üöÄ Sistema de logging G.A.V. inicializado
2025-08-13 00:29:57,127 [INFO] [root:21] [<module>] Cliente Twilio inicializado com sucesso
2025-08-13 00:29:57,153 [WARNING] [werkzeug:97] [_log]  * Debugger is active!
2025-08-13 00:29:57,154 [INFO] [werkzeug:97] [_log]  * Debugger PIN: 353-219-865
2025-08-13 00:30:09,904 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [13/Aug/2025 00:30:09] "POST /webhook HTTP/1.1" 200 -
2025-08-13 00:30:09,905 [INFO] [root:69] [load_session] [SESSION] Nova sess√£o criada para: 5511940726493***
2025-08-13 00:30:09,909 [DEBUG] [root:83] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp5511940726493.json
2025-08-13 00:30:09,909 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'ü§ñ Ol√°! Como posso ajudar voc√™ hoje?'
2025-08-13 00:30:10,236 [INFO] [root:57] [send_whatsapp_message] Mensagem enviada com sucesso. SID: SM2cce098f86115acfad6f43140b142aa1
2025-08-13 00:30:10,237 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para 'Oi'
2025-08-13 00:30:16,708 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [13/Aug/2025 00:30:16] "POST /webhook HTTP/1.1" 200 -
2025-08-13 00:30:16,712 [DEBUG] [root:38] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp5511940726493.json
2025-08-13 00:30:16,714 [DEBUG] [root:83] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp5511940726493.json
2025-08-13 00:30:16,715 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'üõí Seu carrinho est√° vazio.

üîç Digite o nome do produto
üì¶ Digite *produtos* para ver os mais vendidos...'
2025-08-13 00:30:16,883 [ERROR] [root:61] [send_whatsapp_message] Falha ao enviar mensagem via API da Twilio: HTTP 429 error: Unable to create record: Account ACad7b82d94a6416ade9b1d19a8194499f exceeded the 9 daily messages limit
2025-08-13 00:30:16,884 [ERROR] [root:65] [send_whatsapp_message] Limite de mensagens di√°rio atingido
2025-08-13 00:30:16,886 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para 'meu carrinho'
2025-08-13 00:31:05,509 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [13/Aug/2025 00:31:05] "POST /webhook HTTP/1.1" 200 -
2025-08-13 00:31:05,515 [DEBUG] [root:38] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp5511940726493.json
2025-08-13 00:31:05,533 [DEBUG] [root:83] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp5511940726493.json
2025-08-13 00:31:05,534 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'ü§ñ Ol√°! Como posso ajudar voc√™ hoje?'
2025-08-13 00:31:05,777 [INFO] [root:57] [send_whatsapp_message] Mensagem enviada com sucesso. SID: SM0708d4623964fb1e89f8d9bf373743bf
2025-08-13 00:31:05,778 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para 'Adiciona 5 coca cola lata'
2025-08-13 00:31:12,353 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [13/Aug/2025 00:31:12] "POST /webhook HTTP/1.1" 200 -
2025-08-13 00:31:12,360 [DEBUG] [root:38] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp5511940726493.json
2025-08-13 00:31:12,363 [DEBUG] [root:83] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp5511940726493.json
2025-08-13 00:31:12,363 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'ü§ñ Ol√°! Como posso ajudar voc√™ hoje?'
2025-08-13 00:31:12,574 [INFO] [root:57] [send_whatsapp_message] Mensagem enviada com sucesso. SID: SM2496969ad4dd40ce23eecda6581d3569
2025-08-13 00:31:12,577 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para 'coca cola'
2025-08-13 00:31:27,801 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [13/Aug/2025 00:31:27] "POST /webhook HTTP/1.1" 200 -
2025-08-13 00:31:27,809 [DEBUG] [root:38] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp5511940726493.json
2025-08-13 00:31:27,826 [DEBUG] [root:83] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp5511940726493.json
2025-08-13 00:31:27,833 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'ü§ñ Seu carrinho est√° vazio!

üîç Digite o nome do produto
üì¶ Digite *produtos* para ver os mais vendidos...'
2025-08-13 00:31:27,993 [ERROR] [root:61] [send_whatsapp_message] Falha ao enviar mensagem via API da Twilio: HTTP 429 error: Unable to create record: Account ACad7b82d94a6416ade9b1d19a8194499f exceeded the 9 daily messages limit
2025-08-13 00:31:27,995 [ERROR] [root:65] [send_whatsapp_message] Limite de mensagens di√°rio atingido
2025-08-13 00:31:27,996 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para 'Quero comprar coca cola'
2025-08-13 00:32:17,834 [INFO] [werkzeug:97] [_log] 172.20.0.1 - - [13/Aug/2025 00:32:17] "POST /webhook HTTP/1.1" 200 -
2025-08-13 00:32:17,845 [DEBUG] [root:38] [load_session] [SESSION] Sess√£o carregada do arquivo: data/session_whatsapp5511940726493.json
2025-08-13 00:32:17,852 [INFO] [root:389] [get_intent] [llm_interface.py] Processando mensagem: 'quero coca cola'
2025-08-13 00:32:17,854 [INFO] [root:396] [get_intent] [CONTEXT] Hist√≥ria: 11 mensagens
2025-08-13 00:32:17,857 [INFO] [root:397] [get_intent] [CONTEXT] Carrinho: 0 itens
2025-08-13 00:32:17,858 [INFO] [root:398] [get_intent] [CONTEXT] Cliente identificado: False
2025-08-13 00:32:17,860 [INFO] [root:197] [load_prompt_template] [llm_interface.py] Carregando prompt de: ai_llm/gav_prompt.txt
2025-08-13 00:32:17,863 [INFO] [root:202] [load_prompt_template] [llm_interface.py] Prompt carregado. Tamanho: 5376 caracteres
2025-08-13 00:32:17,868 [ERROR] [root:545] [get_intent] [llm_interface.py] Erro geral: Invalid format specifier
Traceback (most recent call last):
  File "/app/ai_llm/llm_interface.py", line 449, in get_intent
    full_context = f"""
ValueError: Invalid format specifier
2025-08-13 00:32:17,898 [DEBUG] [root:83] [save_session] [SESSION] Sess√£o salva no arquivo: data/session_whatsapp5511940726493.json
2025-08-13 00:32:17,899 [INFO] [root:48] [send_whatsapp_message] Enviando mensagem proativa para 5511940726493***: 'Ol√°! Bem-vindo ao Comercial Esperan√ßa. Como posso ajudar?

üîç Digite o nome do produto
üì¶ Digite *prod...'
2025-08-13 00:32:18,063 [ERROR] [root:61] [send_whatsapp_message] Falha ao enviar mensagem via API da Twilio: HTTP 429 error: Unable to create record: Account ACad7b82d94a6416ade9b1d19a8194499f exceeded the 9 daily messages limit
2025-08-13 00:32:18,067 [ERROR] [root:65] [send_whatsapp_message] Limite de mensagens di√°rio atingido
2025-08-13 00:32:18,071 [INFO] [root:1425] [process_message_async] THREAD: Processamento finalizado para 'quero coca cola'
2025-08-13 00:34:04,069 [INFO] [werkzeug:97] [_log]  * Detected change in '/app/app.py', reloading
2025-08-13 00:34:04,123 [INFO] [werkzeug:97] [_log]  * Restarting with stat
2025-08-13 00:34:05,115 [INFO] [root:534] [setup_main_logging] üöÄ Sistema de logging G.A.V. inicializado
2025-08-13 00:34:05,193 [INFO] [root:21] [<module>] Cliente Twilio inicializado com sucesso
2025-08-13 00:34:05,198 [INFO] [root:650] [<module>] üöÄ G.A.V. 2.0 - Sistema iniciado com sucesso!
2025-08-13 00:34:05,199 [INFO] [root:651] [<module>] üìä Contexto: COMPLETO | Hist√≥rico: ATIVO | Valida√ß√µes: ATIVAS
2025-08-13 00:34:05,235 [WARNING] [werkzeug:97] [_log]  * Debugger is active!
2025-08-13 00:34:05,236 [INFO] [werkzeug:97] [_log]  * Debugger PIN: 353-219-865
